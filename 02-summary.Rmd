
```{r setup_chap02, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)

```



# 統計学の基礎の復習


Rで基本統計量を計算する方法について解説する。 

* 変数の区別  
* 基本統計  
  + 代表値（平均，中央値）  
  + 散布度（分散，標準偏差，分位数）  
  + 共分散，相関  

# 変数の区別


### 量的変数

数値として扱う変数。計算することができる。

量的変数は更に，間隔尺度と比率尺度で区別ができる。

#### 間隔尺度（＊）

データの間隔に意味があるもの。ゼロが何もない状態を意味するものでないもの。セ氏温度など（0℃以下も-1℃があるように，ゼロは何もない状態を意味しない）。  
差には意味があるが，比率については意味を持たない。例えば，「10℃と20℃の差は10℃である」とはいえるが，「20℃は10℃の2倍の熱さである」とは言えない。  


#### 比率尺度（＊）

データの間隔に意味があるもの。ゼロがなにもない状態を意味するもの。身長，体重，絶対温度など。  
間隔を比率で表現できる。例えば，「体重100キロの人は体重50キロの人より2倍重い」といえる。  
  
  
また，量的変数は*離散値*か*連続値*かの区別もされる。

#### 離散値

離散値とは，小数の間隔を持たない数値のこと。  

例えば，個数。1個, 2個，3個と数えるが，1.1個, 1.2個などは存在しない。  

#### 連続値

連続値とは，小数の間隔を持つ数値。  
  
例えば，身長。150cmから151cmの間には小数で表現できる数値が連続的に並んでいる。  
  

### カテゴリカル変数（質的変数）

分類や種類を意味するデータ。数量化して計算することはできない。  
カテゴリカル変数も，いくつかの分類が可能。ここでは，名義尺度と順序尺度の区別をあげる。


#### 名義尺度

性別（男，女），血液型，出身地など。  
順序関係がない（男性<女性といった関係はない）。

#### 順序尺度

「優，良，可，不可」といった成績，「1. 賛成，2. どちらでもない，3. 反対」といった尺度など。  
  
順序関係を持つが，間隔は定義されない。



## 基本統計

以下では，サンプルデータとして，Rにもともと入っている`iris`データを使いながら説明する。  


```{r sample_data_chap02}

head(iris) #head()でカッコの中にデータの名前を入れると，データの上数行のみを表示してくれる

dat = iris #irisをdatという名前で保存し直す

```


基本的な要約統計量をRで計算する方法について解説する。


### 代表値

データの代表となる値のこと。平均や中央値などが知られる。

#### 平均

`mean()`関数を使う。カッコの中に，平均値を求めたいベクトルを入れる。 
  
データフレームの場合は，「データ名$変数名」でベクトルを指定すれば良い。よく使う表記なので覚えておこう。

```{r mean_chap02}

mean(dat$Sepal.Length)

```


データに欠損値が含まれている場合は，オプションとして`rm.na = TRUE`を設定する。

```{r mean2_chap02}

a = c(1, 2, 3, NA, 4, 5)

mean(a)
mean(a, na.rm = TRUE)

```



#### 中央値

`median()`関数で出力できる。

```{r median_chap02}

median(dat$Sepal.Length)

```

### 散布度

データの散らばり具合を示す値のこと。分散，標準偏差などが知られる。

#### 分散

`var()`関数を使う。

```{r var_chap02}
var(iris$Sepal.Length)
```

#### 標準偏差

`sd()`関数を使う。

```{r sd_chap02}
sd(iris$Sepal.Length)
```


#### 分位数

データを小さい順から大きい順に並べ替えたときに，データを分割する値。一般的に，四分位数（下位25%，中央値，上位75%の値）が報告通してよく使われる。  

`quantile()`で，データを分割したときの分位数を求められる。

```{r quantile_chap02}

quantile(iris$Sepal.Length)

quantile(iris$Sepal.Length, probs = c(0.1, 0.3, 0.5, 0.8, 1.0)) #オプションのprobsで，分割する点を任意に変えることができる。


```


### 要約統計量

Rには，データの代表値や散布度を一括して求めてくれる関数である`summary()`が用意されている。

最小値，最大値，平均，四分位数をまとめて算出してくれる。

```{r summary_chap02}

summary(iris$Sepal.Length)

```



### 表の作り方

カテゴリカル変数の場合は，データ全体を把握する上でそれぞれの頻度を知りたいことが多い。  

`table()`関数を使うと頻度を集計して表にしてくれる。

```{r table_chap02, message=FALSE}

table(iris$Species) 

```


## 相関

2変数間の相関係数を算出するには，`cor()`を使う。`cor.test()`を使うと，相関係数の検定などより詳細な結果を示してくれる。

```{r cor_chap02, message=FALSE}

cor(iris$Sepal.Length, iris$Sepal.Width) 
cor.test(iris$Sepal.Length, iris$Sepal.Width) 

```


