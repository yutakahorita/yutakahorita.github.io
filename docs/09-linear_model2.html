<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 10 線形モデルの注意点 | 心理データ応用解析法</title>
  <meta name="description" content="Chapter 10 線形モデルの注意点 | 心理データ応用解析法" />
  <meta name="generator" content="bookdown 0.39 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 10 線形モデルの注意点 | 心理データ応用解析法" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 10 線形モデルの注意点 | 心理データ応用解析法" />
  
  
  

<meta name="author" content="帝京大学文学部心理学科　堀田結孝" />


<meta name="date" content="2024-05-31" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="08-linear_model.html"/>
<link rel="next" href="10-glm.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> はじめに</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#このテキストについて"><i class="fa fa-check"></i><b>1.1</b> このテキストについて</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#テキストの構成"><i class="fa fa-check"></i><b>1.2</b> テキストの構成</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#テキストの読み方"><i class="fa fa-check"></i><b>1.2.1</b> テキストの読み方</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="01-intro.html"><a href="01-intro.html"><i class="fa fa-check"></i><b>2</b> Rの使い方</a>
<ul>
<li class="chapter" data-level="2.1" data-path="01-intro.html"><a href="01-intro.html#rのインストール"><i class="fa fa-check"></i><b>2.1</b> Rのインストール</a></li>
<li class="chapter" data-level="2.2" data-path="01-intro.html"><a href="01-intro.html#rstudioのインストール"><i class="fa fa-check"></i><b>2.2</b> RStudioのインストール</a></li>
<li class="chapter" data-level="2.3" data-path="01-intro.html"><a href="01-intro.html#プログラムの書き方"><i class="fa fa-check"></i><b>2.3</b> プログラムの書き方</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="01-intro.html"><a href="01-intro.html#コンソールconsole"><i class="fa fa-check"></i><b>2.3.1</b> コンソール（Console）</a></li>
<li class="chapter" data-level="2.3.2" data-path="01-intro.html"><a href="01-intro.html#スクリプト"><i class="fa fa-check"></i><b>2.3.2</b> スクリプト</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="01-intro.html"><a href="01-intro.html#単純な演算"><i class="fa fa-check"></i><b>2.4</b> 単純な演算</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="01-intro.html"><a href="01-intro.html#コメント文"><i class="fa fa-check"></i><b>2.4.1</b> コメント文</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="01-intro.html"><a href="01-intro.html#変数"><i class="fa fa-check"></i><b>2.5</b> 変数</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="01-intro.html"><a href="01-intro.html#変数の使い方の注意"><i class="fa fa-check"></i><b>2.5.1</b> 変数の使い方の注意</a></li>
<li class="chapter" data-level="2.5.2" data-path="01-intro.html"><a href="01-intro.html#変数の型"><i class="fa fa-check"></i><b>2.5.2</b> 変数の型</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="01-intro.html"><a href="01-intro.html#データ構造"><i class="fa fa-check"></i><b>2.6</b> データ構造</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="01-intro.html"><a href="01-intro.html#ベクトル"><i class="fa fa-check"></i><b>2.6.1</b> ベクトル</a></li>
<li class="chapter" data-level="2.6.2" data-path="01-intro.html"><a href="01-intro.html#データフレーム"><i class="fa fa-check"></i><b>2.6.2</b> データフレーム</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="01-intro.html"><a href="01-intro.html#欠損値"><i class="fa fa-check"></i><b>2.7</b> 欠損値</a></li>
<li class="chapter" data-level="2.8" data-path="01-intro.html"><a href="01-intro.html#パッケージのインストールとロード"><i class="fa fa-check"></i><b>2.8</b> パッケージのインストールとロード</a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="01-intro.html"><a href="01-intro.html#パッケージのインストール"><i class="fa fa-check"></i><b>2.8.1</b> パッケージのインストール</a></li>
<li class="chapter" data-level="2.8.2" data-path="01-intro.html"><a href="01-intro.html#パッケージのロード"><i class="fa fa-check"></i><b>2.8.2</b> パッケージのロード</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="01-intro.html"><a href="01-intro.html#データの読み込み"><i class="fa fa-check"></i><b>2.9</b> データの読み込み</a>
<ul>
<li class="chapter" data-level="" data-path="01-intro.html"><a href="01-intro.html#rstudioの機能を使って読み込む"><i class="fa fa-check"></i>1: RStudioの機能を使って読み込む</a></li>
<li class="chapter" data-level="" data-path="01-intro.html"><a href="01-intro.html#プログラムを書いてデータを読み込む"><i class="fa fa-check"></i>2: プログラムを書いてデータを読み込む。</a></li>
<li class="chapter" data-level="2.9.1" data-path="01-intro.html"><a href="01-intro.html#サンプルデータ"><i class="fa fa-check"></i><b>2.9.1</b> サンプルデータ</a></li>
</ul></li>
<li class="chapter" data-level="2.10" data-path="01-intro.html"><a href="01-intro.html#ヘルプ"><i class="fa fa-check"></i><b>2.10</b> ヘルプ</a></li>
<li class="chapter" data-level="2.11" data-path="01-intro.html"><a href="01-intro.html#rを終わらせる"><i class="fa fa-check"></i><b>2.11</b> Rを終わらせる</a></li>
<li class="chapter" data-level="" data-path="01-intro.html"><a href="01-intro.html#確認問題"><i class="fa fa-check"></i>確認問題</a>
<ul>
<li class="chapter" data-level="" data-path="01-intro.html"><a href="01-intro.html#問１"><i class="fa fa-check"></i>問１</a></li>
<li class="chapter" data-level="" data-path="01-intro.html"><a href="01-intro.html#問２"><i class="fa fa-check"></i>問２</a></li>
<li class="chapter" data-level="" data-path="01-intro.html"><a href="01-intro.html#問３"><i class="fa fa-check"></i>問３</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="02-summary.html"><a href="02-summary.html"><i class="fa fa-check"></i><b>3</b> 統計学の基礎の復習</a>
<ul>
<li class="chapter" data-level="3.1" data-path="02-summary.html"><a href="02-summary.html#尺度水準"><i class="fa fa-check"></i><b>3.1</b> 尺度水準</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="02-summary.html"><a href="02-summary.html#量的変数"><i class="fa fa-check"></i><b>3.1.1</b> 量的変数</a></li>
<li class="chapter" data-level="3.1.2" data-path="02-summary.html"><a href="02-summary.html#カテゴリカル変数質的変数"><i class="fa fa-check"></i><b>3.1.2</b> カテゴリカル変数（質的変数）</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="02-summary.html"><a href="02-summary.html#基本統計量"><i class="fa fa-check"></i><b>3.2</b> 基本統計量</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="02-summary.html"><a href="02-summary.html#代表値"><i class="fa fa-check"></i><b>3.2.1</b> 代表値</a></li>
<li class="chapter" data-level="3.2.2" data-path="02-summary.html"><a href="02-summary.html#散布度"><i class="fa fa-check"></i><b>3.2.2</b> 散布度</a></li>
<li class="chapter" data-level="3.2.3" data-path="02-summary.html"><a href="02-summary.html#要約統計量"><i class="fa fa-check"></i><b>3.2.3</b> 要約統計量</a></li>
<li class="chapter" data-level="3.2.4" data-path="02-summary.html"><a href="02-summary.html#グループごとの集計"><i class="fa fa-check"></i><b>3.2.4</b> グループごとの集計</a></li>
<li class="chapter" data-level="3.2.5" data-path="02-summary.html"><a href="02-summary.html#表の作り方"><i class="fa fa-check"></i><b>3.2.5</b> 表の作り方</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="02-summary.html"><a href="02-summary.html#相関correlation"><i class="fa fa-check"></i><b>3.3</b> 相関(correlation)</a></li>
<li class="chapter" data-level="" data-path="02-summary.html"><a href="02-summary.html#確認問題-1"><i class="fa fa-check"></i>確認問題</a>
<ul>
<li class="chapter" data-level="" data-path="02-summary.html"><a href="02-summary.html#問１-1"><i class="fa fa-check"></i>問１</a></li>
<li class="chapter" data-level="" data-path="02-summary.html"><a href="02-summary.html#問２-1"><i class="fa fa-check"></i>問２</a></li>
<li class="chapter" data-level="" data-path="02-summary.html"><a href="02-summary.html#問３-1"><i class="fa fa-check"></i>問３</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="03-data.html"><a href="03-data.html"><i class="fa fa-check"></i><b>4</b> データ・ハンドリング</a>
<ul>
<li class="chapter" data-level="4.1" data-path="03-data.html"><a href="03-data.html#パッケージのロード-1"><i class="fa fa-check"></i><b>4.1</b> パッケージのロード</a></li>
<li class="chapter" data-level="4.2" data-path="03-data.html"><a href="03-data.html#変数の作成"><i class="fa fa-check"></i><b>4.2</b> 変数の作成</a></li>
<li class="chapter" data-level="4.3" data-path="03-data.html"><a href="03-data.html#データの抽出-1"><i class="fa fa-check"></i><b>4.3</b> データの抽出</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="03-data.html"><a href="03-data.html#必要な列のみを取り出すselect"><i class="fa fa-check"></i><b>4.3.1</b> 必要な列のみを取り出す（select）</a></li>
<li class="chapter" data-level="4.3.2" data-path="03-data.html"><a href="03-data.html#条件に合う行を取り出すfilter"><i class="fa fa-check"></i><b>4.3.2</b> 条件に合う行を取り出す（filter）</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="03-data.html"><a href="03-data.html#パイプ"><i class="fa fa-check"></i><b>4.4</b> パイプ</a></li>
<li class="chapter" data-level="4.5" data-path="03-data.html"><a href="03-data.html#グルーピング"><i class="fa fa-check"></i><b>4.5</b> グルーピング</a></li>
<li class="chapter" data-level="4.6" data-path="03-data.html"><a href="03-data.html#データの変換"><i class="fa fa-check"></i><b>4.6</b> データの変換</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="03-data.html"><a href="03-data.html#wide型とlong型の区別"><i class="fa fa-check"></i><b>4.6.1</b> wide型とlong型の区別</a></li>
<li class="chapter" data-level="4.6.2" data-path="03-data.html"><a href="03-data.html#wide型からlong型に変換"><i class="fa fa-check"></i><b>4.6.2</b> wide型からlong型に変換</a></li>
<li class="chapter" data-level="4.6.3" data-path="03-data.html"><a href="03-data.html#long型からwide型に変換"><i class="fa fa-check"></i><b>4.6.3</b> long型からwide型に変換</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="03-data.html"><a href="03-data.html#データの結合"><i class="fa fa-check"></i><b>4.7</b> データの結合</a></li>
<li class="chapter" data-level="4.8" data-path="03-data.html"><a href="03-data.html#データの読み込み-1"><i class="fa fa-check"></i><b>4.8</b> データの読み込み</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="03-data.html"><a href="03-data.html#readr"><i class="fa fa-check"></i><b>4.8.1</b> readr</a></li>
<li class="chapter" data-level="4.8.2" data-path="03-data.html"><a href="03-data.html#readxl"><i class="fa fa-check"></i><b>4.8.2</b> readxl</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="03-data.html"><a href="03-data.html#確認問題-2"><i class="fa fa-check"></i>確認問題</a>
<ul>
<li class="chapter" data-level="" data-path="03-data.html"><a href="03-data.html#問１-2"><i class="fa fa-check"></i>問１</a></li>
<li class="chapter" data-level="" data-path="03-data.html"><a href="03-data.html#問２-2"><i class="fa fa-check"></i>問２</a></li>
<li class="chapter" data-level="" data-path="03-data.html"><a href="03-data.html#問３-2"><i class="fa fa-check"></i>問３</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="04-graph.html"><a href="04-graph.html"><i class="fa fa-check"></i><b>5</b> グラフ</a>
<ul>
<li class="chapter" data-level="5.1" data-path="04-graph.html"><a href="04-graph.html#なぜ可視化が重要か"><i class="fa fa-check"></i><b>5.1</b> なぜ可視化が重要か？</a></li>
<li class="chapter" data-level="5.2" data-path="04-graph.html"><a href="04-graph.html#rのグラフィック関数"><i class="fa fa-check"></i><b>5.2</b> Rのグラフィック関数</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="04-graph.html"><a href="04-graph.html#plot"><i class="fa fa-check"></i><b>5.2.1</b> plot</a></li>
<li class="chapter" data-level="5.2.2" data-path="04-graph.html"><a href="04-graph.html#その他のグラフ"><i class="fa fa-check"></i><b>5.2.2</b> その他のグラフ</a></li>
<li class="chapter" data-level="5.2.3" data-path="04-graph.html"><a href="04-graph.html#グラフを重ねる"><i class="fa fa-check"></i><b>5.2.3</b> グラフを重ねる</a></li>
<li class="chapter" data-level="5.2.4" data-path="04-graph.html"><a href="04-graph.html#図の保存"><i class="fa fa-check"></i><b>5.2.4</b> 図の保存</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="04-graph.html"><a href="04-graph.html#ggplot2パッケージ"><i class="fa fa-check"></i><b>5.3</b> ggplot2パッケージ</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="04-graph.html"><a href="04-graph.html#散布図-1"><i class="fa fa-check"></i><b>5.3.1</b> 散布図</a></li>
<li class="chapter" data-level="5.3.2" data-path="04-graph.html"><a href="04-graph.html#ヒストグラム-1"><i class="fa fa-check"></i><b>5.3.2</b> ヒストグラム</a></li>
<li class="chapter" data-level="5.3.3" data-path="04-graph.html"><a href="04-graph.html#箱ひげ図-1"><i class="fa fa-check"></i><b>5.3.3</b> 箱ひげ図</a></li>
<li class="chapter" data-level="5.3.4" data-path="04-graph.html"><a href="04-graph.html#バイオリンプロット"><i class="fa fa-check"></i><b>5.3.4</b> バイオリンプロット</a></li>
<li class="chapter" data-level="5.3.5" data-path="04-graph.html"><a href="04-graph.html#折れ線グラフ"><i class="fa fa-check"></i><b>5.3.5</b> 折れ線グラフ</a></li>
<li class="chapter" data-level="5.3.6" data-path="04-graph.html"><a href="04-graph.html#エラーバーつきのグラフ"><i class="fa fa-check"></i><b>5.3.6</b> エラーバーつきのグラフ</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="04-graph.html"><a href="04-graph.html#オプション"><i class="fa fa-check"></i><b>5.4</b> オプション</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="04-graph.html"><a href="04-graph.html#ファセットfacet"><i class="fa fa-check"></i><b>5.4.1</b> ファセット（Facet）</a></li>
<li class="chapter" data-level="5.4.2" data-path="04-graph.html"><a href="04-graph.html#ラベルlabs"><i class="fa fa-check"></i><b>5.4.2</b> ラベル（labs）</a></li>
<li class="chapter" data-level="5.4.3" data-path="04-graph.html"><a href="04-graph.html#テーマtheme"><i class="fa fa-check"></i><b>5.4.3</b> テーマ（Theme）</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="04-graph.html"><a href="04-graph.html#図の保存-1"><i class="fa fa-check"></i><b>5.5</b> 図の保存</a></li>
<li class="chapter" data-level="5.6" data-path="04-graph.html"><a href="04-graph.html#応用的なグラフ"><i class="fa fa-check"></i><b>5.6</b> 応用的なグラフ</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="04-graph.html"><a href="04-graph.html#rain-cloud-plot"><i class="fa fa-check"></i><b>5.6.1</b> Rain-cloud plot</a></li>
<li class="chapter" data-level="5.6.2" data-path="04-graph.html"><a href="04-graph.html#ridge-plot"><i class="fa fa-check"></i><b>5.6.2</b> Ridge plot</a></li>
<li class="chapter" data-level="5.6.3" data-path="04-graph.html"><a href="04-graph.html#alluvial-plot"><i class="fa fa-check"></i><b>5.6.3</b> Alluvial plot</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="04-graph.html"><a href="04-graph.html#その他の機能"><i class="fa fa-check"></i><b>5.7</b> その他の機能</a></li>
<li class="chapter" data-level="" data-path="04-graph.html"><a href="04-graph.html#確認問題-3"><i class="fa fa-check"></i>確認問題</a>
<ul>
<li class="chapter" data-level="" data-path="04-graph.html"><a href="04-graph.html#問１-3"><i class="fa fa-check"></i>問１</a></li>
<li class="chapter" data-level="" data-path="04-graph.html"><a href="04-graph.html#問２-3"><i class="fa fa-check"></i>問２</a></li>
<li class="chapter" data-level="" data-path="04-graph.html"><a href="04-graph.html#問３-3"><i class="fa fa-check"></i>問３</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="05-probability_distribution.html"><a href="05-probability_distribution.html"><i class="fa fa-check"></i><b>6</b> 確率分布</a>
<ul>
<li class="chapter" data-level="6.1" data-path="05-probability_distribution.html"><a href="05-probability_distribution.html#確率変数と確率分布"><i class="fa fa-check"></i><b>6.1</b> 確率変数と確率分布</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="05-probability_distribution.html"><a href="05-probability_distribution.html#離散型分布"><i class="fa fa-check"></i><b>6.1.1</b> 離散型分布</a></li>
<li class="chapter" data-level="6.1.2" data-path="05-probability_distribution.html"><a href="05-probability_distribution.html#連続型分布"><i class="fa fa-check"></i><b>6.1.2</b> 連続型分布</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="05-probability_distribution.html"><a href="05-probability_distribution.html#二項分布"><i class="fa fa-check"></i><b>6.2</b> 二項分布</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="05-probability_distribution.html"><a href="05-probability_distribution.html#二項分布の期待値と分散"><i class="fa fa-check"></i><b>6.2.1</b> 二項分布の期待値と分散</a></li>
<li class="chapter" data-level="6.2.2" data-path="05-probability_distribution.html"><a href="05-probability_distribution.html#ベルヌーイ分布"><i class="fa fa-check"></i><b>6.2.2</b> ベルヌーイ分布</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="05-probability_distribution.html"><a href="05-probability_distribution.html#正規分布"><i class="fa fa-check"></i><b>6.3</b> 正規分布</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="05-probability_distribution.html"><a href="05-probability_distribution.html#正規分布の基礎"><i class="fa fa-check"></i><b>6.3.1</b> 正規分布の基礎</a></li>
<li class="chapter" data-level="6.3.2" data-path="05-probability_distribution.html"><a href="05-probability_distribution.html#確率密度関数"><i class="fa fa-check"></i><b>6.3.2</b> 確率密度関数</a></li>
<li class="chapter" data-level="6.3.3" data-path="05-probability_distribution.html"><a href="05-probability_distribution.html#正規分布の平均値と標準偏差"><i class="fa fa-check"></i><b>6.3.3</b> 正規分布の平均値と標準偏差</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="05-probability_distribution.html"><a href="05-probability_distribution.html#ポアソン分布"><i class="fa fa-check"></i><b>6.4</b> ポアソン分布</a></li>
<li class="chapter" data-level="6.5" data-path="05-probability_distribution.html"><a href="05-probability_distribution.html#rで使える確率分布関数"><i class="fa fa-check"></i><b>6.5</b> Rで使える確率分布関数</a></li>
<li class="chapter" data-level="6.6" data-path="05-probability_distribution.html"><a href="05-probability_distribution.html#正規分布と他の確率変数との関係"><i class="fa fa-check"></i><b>6.6</b> 正規分布と他の確率変数との関係</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="05-probability_distribution.html"><a href="05-probability_distribution.html#中心極限定理"><i class="fa fa-check"></i><b>6.6.1</b> 中心極限定理</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="05-probability_distribution.html"><a href="05-probability_distribution.html#確率分布の表現の仕方"><i class="fa fa-check"></i><b>6.7</b> 確率分布の表現の仕方</a></li>
<li class="chapter" data-level="6.8" data-path="05-probability_distribution.html"><a href="05-probability_distribution.html#その他の確率分布"><i class="fa fa-check"></i><b>6.8</b> その他の確率分布</a>
<ul>
<li class="chapter" data-level="" data-path="05-probability_distribution.html"><a href="05-probability_distribution.html#一様分布"><i class="fa fa-check"></i>一様分布</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="05-probability_distribution.html"><a href="05-probability_distribution.html#確認問題-4"><i class="fa fa-check"></i>確認問題</a>
<ul>
<li class="chapter" data-level="" data-path="05-probability_distribution.html"><a href="05-probability_distribution.html#問１-4"><i class="fa fa-check"></i>問１</a></li>
<li class="chapter" data-level="" data-path="05-probability_distribution.html"><a href="05-probability_distribution.html#問２-4"><i class="fa fa-check"></i>問２</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="06-NHT.html"><a href="06-NHT.html"><i class="fa fa-check"></i><b>7</b> 統計的仮説検定</a>
<ul>
<li class="chapter" data-level="7.1" data-path="06-NHT.html"><a href="06-NHT.html#準備"><i class="fa fa-check"></i><b>7.1</b> 準備</a></li>
<li class="chapter" data-level="7.2" data-path="06-NHT.html"><a href="06-NHT.html#統計的仮説検定の考え方"><i class="fa fa-check"></i><b>7.2</b> 統計的仮説検定の考え方</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="06-NHT.html"><a href="06-NHT.html#二項検定"><i class="fa fa-check"></i><b>7.2.1</b> 二項検定</a></li>
<li class="chapter" data-level="7.2.2" data-path="06-NHT.html"><a href="06-NHT.html#二標本の検定"><i class="fa fa-check"></i><b>7.2.2</b> 二標本の検定</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="06-NHT.html"><a href="06-NHT.html#統計的仮説検定のまとめ"><i class="fa fa-check"></i><b>7.3</b> 統計的仮説検定のまとめ</a></li>
<li class="chapter" data-level="7.4" data-path="06-NHT.html"><a href="06-NHT.html#p値とサンプルサイズの関係"><i class="fa fa-check"></i><b>7.4</b> p値とサンプルサイズの関係</a></li>
<li class="chapter" data-level="7.5" data-path="06-NHT.html"><a href="06-NHT.html#効果量"><i class="fa fa-check"></i><b>7.5</b> 効果量</a></li>
<li class="chapter" data-level="7.6" data-path="06-NHT.html"><a href="06-NHT.html#第1種の過誤と第2種の過誤"><i class="fa fa-check"></i><b>7.6</b> 第1種の過誤と第2種の過誤</a></li>
<li class="chapter" data-level="7.7" data-path="06-NHT.html"><a href="06-NHT.html#検出力"><i class="fa fa-check"></i><b>7.7</b> 検出力</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="06-NHT.html"><a href="06-NHT.html#検出力の高さに影響する要因"><i class="fa fa-check"></i><b>7.7.1</b> 検出力の高さに影響する要因</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="06-NHT.html"><a href="06-NHT.html#検出力分析"><i class="fa fa-check"></i><b>7.8</b> 検出力分析</a></li>
<li class="chapter" data-level="7.9" data-path="06-NHT.html"><a href="06-NHT.html#統計的仮説検定が抱える問題"><i class="fa fa-check"></i><b>7.9</b> 統計的仮説検定が抱える問題</a>
<ul>
<li class="chapter" data-level="7.9.1" data-path="06-NHT.html"><a href="06-NHT.html#第1種の過誤"><i class="fa fa-check"></i><b>7.9.1</b> 第1種の過誤</a></li>
<li class="chapter" data-level="7.9.2" data-path="06-NHT.html"><a href="06-NHT.html#多重比較の問題"><i class="fa fa-check"></i><b>7.9.2</b> 多重比較の問題</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="06-NHT.html"><a href="06-NHT.html#確認問題-5"><i class="fa fa-check"></i>確認問題</a>
<ul>
<li class="chapter" data-level="" data-path="06-NHT.html"><a href="06-NHT.html#問１-5"><i class="fa fa-check"></i>問１</a></li>
<li class="chapter" data-level="" data-path="06-NHT.html"><a href="06-NHT.html#問２-5"><i class="fa fa-check"></i>問２</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="07-analysis.html"><a href="07-analysis.html"><i class="fa fa-check"></i><b>8</b> 様々な解析法</a>
<ul>
<li class="chapter" data-level="8.1" data-path="07-analysis.html"><a href="07-analysis.html#t検定"><i class="fa fa-check"></i><b>8.1</b> t検定</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="07-analysis.html"><a href="07-analysis.html#対応のないt検定"><i class="fa fa-check"></i><b>8.1.1</b> 対応のないt検定</a></li>
<li class="chapter" data-level="8.1.2" data-path="07-analysis.html"><a href="07-analysis.html#対応のあるt検定"><i class="fa fa-check"></i><b>8.1.2</b> 対応のあるt検定</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="07-analysis.html"><a href="07-analysis.html#分散分析"><i class="fa fa-check"></i><b>8.2</b> 分散分析</a></li>
<li class="chapter" data-level="8.3" data-path="07-analysis.html"><a href="07-analysis.html#ノンパラメトリック検定"><i class="fa fa-check"></i><b>8.3</b> ノンパラメトリック検定</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="07-analysis.html"><a href="07-analysis.html#ウィルコクソンの順位和検定"><i class="fa fa-check"></i><b>8.3.1</b> ウィルコクソンの順位和検定</a></li>
<li class="chapter" data-level="8.3.2" data-path="07-analysis.html"><a href="07-analysis.html#クラスカルウォリスの検定"><i class="fa fa-check"></i><b>8.3.2</b> クラスカル・ウォリスの検定</a></li>
<li class="chapter" data-level="8.3.3" data-path="07-analysis.html"><a href="07-analysis.html#カイ二乗検定"><i class="fa fa-check"></i><b>8.3.3</b> カイ二乗検定</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="07-analysis.html"><a href="07-analysis.html#統計モデルとの関係"><i class="fa fa-check"></i><b>8.4</b> 「統計モデル」との関係</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="08-linear_model.html"><a href="08-linear_model.html"><i class="fa fa-check"></i><b>9</b> 線形モデル</a>
<ul>
<li class="chapter" data-level="9.1" data-path="08-linear_model.html"><a href="08-linear_model.html#準備-1"><i class="fa fa-check"></i><b>9.1</b> 準備</a></li>
<li class="chapter" data-level="9.2" data-path="08-linear_model.html"><a href="08-linear_model.html#線形モデルの概要"><i class="fa fa-check"></i><b>9.2</b> 線形モデルの概要</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="08-linear_model.html"><a href="08-linear_model.html#まとめ"><i class="fa fa-check"></i><b>9.2.1</b> まとめ</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="08-linear_model.html"><a href="08-linear_model.html#線形モデルによる解析"><i class="fa fa-check"></i><b>9.3</b> 線形モデルによる解析</a></li>
<li class="chapter" data-level="9.4" data-path="08-linear_model.html"><a href="08-linear_model.html#最尤法"><i class="fa fa-check"></i><b>9.4</b> 最尤法</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="08-linear_model.html"><a href="08-linear_model.html#最尤法によるパラメータ推定"><i class="fa fa-check"></i><b>9.4.1</b> 最尤法によるパラメータ推定</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="08-linear_model.html"><a href="08-linear_model.html#信頼区間と予測区間"><i class="fa fa-check"></i><b>9.5</b> 信頼区間と予測区間</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="08-linear_model.html"><a href="08-linear_model.html#信頼区間"><i class="fa fa-check"></i><b>9.5.1</b> 信頼区間</a></li>
<li class="chapter" data-level="9.5.2" data-path="08-linear_model.html"><a href="08-linear_model.html#予測区間"><i class="fa fa-check"></i><b>9.5.2</b> 予測区間</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="08-linear_model.html"><a href="08-linear_model.html#まとめ-1"><i class="fa fa-check"></i><b>9.6</b> まとめ</a></li>
<li class="chapter" data-level="" data-path="08-linear_model.html"><a href="08-linear_model.html#確認問題-6"><i class="fa fa-check"></i>確認問題</a>
<ul>
<li class="chapter" data-level="" data-path="08-linear_model.html"><a href="08-linear_model.html#問１-6"><i class="fa fa-check"></i>問１</a></li>
<li class="chapter" data-level="" data-path="08-linear_model.html"><a href="08-linear_model.html#問２-6"><i class="fa fa-check"></i>問２</a></li>
<li class="chapter" data-level="" data-path="08-linear_model.html"><a href="08-linear_model.html#問３-4"><i class="fa fa-check"></i>問３</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="09-linear_model2.html"><a href="09-linear_model2.html"><i class="fa fa-check"></i><b>10</b> 線形モデルの注意点</a>
<ul>
<li class="chapter" data-level="10.1" data-path="09-linear_model2.html"><a href="09-linear_model2.html#準備-2"><i class="fa fa-check"></i><b>10.1</b> 準備</a></li>
<li class="chapter" data-level="10.2" data-path="09-linear_model2.html"><a href="09-linear_model2.html#線形モデルに含まれる統計解析"><i class="fa fa-check"></i><b>10.2</b> 線形モデルに含まれる統計解析</a></li>
<li class="chapter" data-level="10.3" data-path="09-linear_model2.html"><a href="09-linear_model2.html#予測変数がカテゴリカル変数の場合"><i class="fa fa-check"></i><b>10.3</b> 予測変数がカテゴリカル変数の場合</a></li>
<li class="chapter" data-level="10.4" data-path="09-linear_model2.html"><a href="09-linear_model2.html#グループが複数ある場合"><i class="fa fa-check"></i><b>10.4</b> グループが複数ある場合</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="09-linear_model2.html"><a href="09-linear_model2.html#基準となるグループと比較する"><i class="fa fa-check"></i><b>10.4.1</b> 基準となるグループと比較する</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="09-linear_model2.html"><a href="09-linear_model2.html#予測変数が複数ある場合"><i class="fa fa-check"></i><b>10.5</b> 予測変数が複数ある場合</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="09-linear_model2.html"><a href="09-linear_model2.html#変数の効果の統制"><i class="fa fa-check"></i><b>10.5.1</b> 変数の効果の統制</a></li>
<li class="chapter" data-level="10.5.2" data-path="09-linear_model2.html"><a href="09-linear_model2.html#交互作用"><i class="fa fa-check"></i><b>10.5.2</b> 交互作用</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="09-linear_model2.html"><a href="09-linear_model2.html#変数の標準化"><i class="fa fa-check"></i><b>10.6</b> 変数の標準化</a></li>
<li class="chapter" data-level="10.7" data-path="09-linear_model2.html"><a href="09-linear_model2.html#線形モデルを扱う上での問題"><i class="fa fa-check"></i><b>10.7</b> 線形モデルを扱う上での問題</a>
<ul>
<li class="chapter" data-level="10.7.1" data-path="09-linear_model2.html"><a href="09-linear_model2.html#多重共線性"><i class="fa fa-check"></i><b>10.7.1</b> 多重共線性</a></li>
<li class="chapter" data-level="10.7.2" data-path="09-linear_model2.html"><a href="09-linear_model2.html#過学習"><i class="fa fa-check"></i><b>10.7.2</b> 過学習</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="09-linear_model2.html"><a href="09-linear_model2.html#モデルの予測力の評価"><i class="fa fa-check"></i><b>10.8</b> モデルの予測力の評価</a>
<ul>
<li class="chapter" data-level="10.8.1" data-path="09-linear_model2.html"><a href="09-linear_model2.html#決定係数"><i class="fa fa-check"></i><b>10.8.1</b> 決定係数</a></li>
<li class="chapter" data-level="10.8.2" data-path="09-linear_model2.html"><a href="09-linear_model2.html#赤池情報量規準aic"><i class="fa fa-check"></i><b>10.8.2</b> 赤池情報量規準（AIC）</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="09-linear_model2.html"><a href="09-linear_model2.html#確認問題-7"><i class="fa fa-check"></i>確認問題</a>
<ul>
<li class="chapter" data-level="" data-path="09-linear_model2.html"><a href="09-linear_model2.html#問1"><i class="fa fa-check"></i>問1</a></li>
<li class="chapter" data-level="" data-path="09-linear_model2.html"><a href="09-linear_model2.html#問2"><i class="fa fa-check"></i>問2</a></li>
<li class="chapter" data-level="" data-path="09-linear_model2.html"><a href="09-linear_model2.html#問3"><i class="fa fa-check"></i>問3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="10-glm.html"><a href="10-glm.html"><i class="fa fa-check"></i><b>11</b> 一般化線形モデル</a>
<ul>
<li class="chapter" data-level="11.1" data-path="10-glm.html"><a href="10-glm.html#準備-3"><i class="fa fa-check"></i><b>11.1</b> 準備</a></li>
<li class="chapter" data-level="11.2" data-path="10-glm.html"><a href="10-glm.html#一般化線形モデル-1"><i class="fa fa-check"></i><b>11.2</b> 一般化線形モデル</a></li>
<li class="chapter" data-level="11.3" data-path="10-glm.html"><a href="10-glm.html#ロジスティック回帰"><i class="fa fa-check"></i><b>11.3</b> ロジスティック回帰</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="10-glm.html"><a href="10-glm.html#応答変数が従う確率分布"><i class="fa fa-check"></i><b>11.3.1</b> 応答変数が従う確率分布</a></li>
<li class="chapter" data-level="11.3.2" data-path="10-glm.html"><a href="10-glm.html#リンク関数"><i class="fa fa-check"></i><b>11.3.2</b> リンク関数</a></li>
<li class="chapter" data-level="11.3.3" data-path="10-glm.html"><a href="10-glm.html#ここまでのまとめ"><i class="fa fa-check"></i><b>11.3.3</b> ここまでのまとめ</a></li>
<li class="chapter" data-level="11.3.4" data-path="10-glm.html"><a href="10-glm.html#rでのロジスティック回帰"><i class="fa fa-check"></i><b>11.3.4</b> Rでのロジスティック回帰</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="10-glm.html"><a href="10-glm.html#ポアソン回帰"><i class="fa fa-check"></i><b>11.4</b> ポアソン回帰</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="10-glm.html"><a href="10-glm.html#応答変数が従う確率分布-1"><i class="fa fa-check"></i><b>11.4.1</b> 応答変数が従う確率分布</a></li>
<li class="chapter" data-level="11.4.2" data-path="10-glm.html"><a href="10-glm.html#リンク関数-1"><i class="fa fa-check"></i><b>11.4.2</b> リンク関数</a></li>
<li class="chapter" data-level="11.4.3" data-path="10-glm.html"><a href="10-glm.html#rでのポアソン回帰"><i class="fa fa-check"></i><b>11.4.3</b> Rでのポアソン回帰</a></li>
<li class="chapter" data-level="11.4.4" data-path="10-glm.html"><a href="10-glm.html#ポアソン回帰の注意点過分散"><i class="fa fa-check"></i><b>11.4.4</b> ポアソン回帰の注意点：過分散</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="10-glm.html"><a href="10-glm.html#一般化線形モデルのまとめ"><i class="fa fa-check"></i><b>11.5</b> 一般化線形モデルのまとめ</a></li>
<li class="chapter" data-level="" data-path="10-glm.html"><a href="10-glm.html#確認問題-8"><i class="fa fa-check"></i>確認問題</a>
<ul>
<li class="chapter" data-level="" data-path="10-glm.html"><a href="10-glm.html#問１-7"><i class="fa fa-check"></i>問１</a></li>
<li class="chapter" data-level="" data-path="10-glm.html"><a href="10-glm.html#問２-7"><i class="fa fa-check"></i>問２</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="11-glm2.html"><a href="11-glm2.html"><i class="fa fa-check"></i><b>12</b> 一般化線形モデルの応用</a>
<ul>
<li class="chapter" data-level="12.1" data-path="11-glm2.html"><a href="11-glm2.html#準備-4"><i class="fa fa-check"></i><b>12.1</b> 準備</a></li>
<li class="chapter" data-level="12.2" data-path="11-glm2.html"><a href="11-glm2.html#負の二項回帰"><i class="fa fa-check"></i><b>12.2</b> 負の二項回帰</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="11-glm2.html"><a href="11-glm2.html#負の二項分布"><i class="fa fa-check"></i><b>12.2.1</b> 負の二項分布</a></li>
<li class="chapter" data-level="12.2.2" data-path="11-glm2.html"><a href="11-glm2.html#rでの負の二項回帰"><i class="fa fa-check"></i><b>12.2.2</b> Rでの負の二項回帰</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="11-glm2.html"><a href="11-glm2.html#順序ロジスティック回帰"><i class="fa fa-check"></i><b>12.3</b> 順序ロジスティック回帰</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="11-glm2.html"><a href="11-glm2.html#例題"><i class="fa fa-check"></i><b>12.3.1</b> 例題</a></li>
<li class="chapter" data-level="12.3.2" data-path="11-glm2.html"><a href="11-glm2.html#順序ロジスティック回帰モデルの詳細"><i class="fa fa-check"></i><b>12.3.2</b> 順序ロジスティック回帰モデルの詳細</a></li>
<li class="chapter" data-level="12.3.3" data-path="11-glm2.html"><a href="11-glm2.html#rでの順序ロジスティック回帰"><i class="fa fa-check"></i><b>12.3.3</b> Rでの順序ロジスティック回帰</a></li>
<li class="chapter" data-level="" data-path="11-glm2.html"><a href="11-glm2.html#準備-5"><i class="fa fa-check"></i>準備</a></li>
<li class="chapter" data-level="" data-path="11-glm2.html"><a href="11-glm2.html#解析"><i class="fa fa-check"></i>解析</a></li>
<li class="chapter" data-level="" data-path="11-glm2.html"><a href="11-glm2.html#解釈"><i class="fa fa-check"></i>解釈</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="11-glm2.html"><a href="11-glm2.html#多項ロジスティック回帰"><i class="fa fa-check"></i><b>12.4</b> 多項ロジスティック回帰</a>
<ul>
<li class="chapter" data-level="" data-path="11-glm2.html"><a href="11-glm2.html#例題-1"><i class="fa fa-check"></i>例題</a></li>
<li class="chapter" data-level="12.4.1" data-path="11-glm2.html"><a href="11-glm2.html#多項ロジスティック回帰モデルの詳細"><i class="fa fa-check"></i><b>12.4.1</b> 多項ロジスティック回帰モデルの詳細</a></li>
<li class="chapter" data-level="12.4.2" data-path="11-glm2.html"><a href="11-glm2.html#rでの多項ロジスティック回帰"><i class="fa fa-check"></i><b>12.4.2</b> Rでの多項ロジスティック回帰</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="11-glm2.html"><a href="11-glm2.html#ゼロ過剰ポアソンモデル"><i class="fa fa-check"></i><b>12.5</b> ゼロ過剰ポアソンモデル</a>
<ul>
<li class="chapter" data-level="" data-path="11-glm2.html"><a href="11-glm2.html#例題-2"><i class="fa fa-check"></i>例題</a></li>
<li class="chapter" data-level="12.5.1" data-path="11-glm2.html"><a href="11-glm2.html#ゼロ過剰ポアソンモデルの詳細"><i class="fa fa-check"></i><b>12.5.1</b> ゼロ過剰ポアソンモデルの詳細</a></li>
<li class="chapter" data-level="12.5.2" data-path="11-glm2.html"><a href="11-glm2.html#rでのゼロ過剰ポアソンモデル"><i class="fa fa-check"></i><b>12.5.2</b> Rでのゼロ過剰ポアソンモデル</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="11-glm2.html"><a href="11-glm2.html#確認問題-9"><i class="fa fa-check"></i>確認問題</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="12-glmm.html"><a href="12-glmm.html"><i class="fa fa-check"></i><b>13</b> マルチレベルモデル</a>
<ul>
<li class="chapter" data-level="13.1" data-path="12-glmm.html"><a href="12-glmm.html#準備-6"><i class="fa fa-check"></i><b>13.1</b> 準備</a></li>
<li class="chapter" data-level="13.2" data-path="12-glmm.html"><a href="12-glmm.html#個人差や集団差の問題"><i class="fa fa-check"></i><b>13.2</b> 個人差や集団差の問題</a></li>
<li class="chapter" data-level="13.3" data-path="12-glmm.html"><a href="12-glmm.html#マルチレベルモデルの概要"><i class="fa fa-check"></i><b>13.3</b> マルチレベルモデルの概要</a></li>
<li class="chapter" data-level="13.4" data-path="12-glmm.html"><a href="12-glmm.html#rでのマルチレベルモデル"><i class="fa fa-check"></i><b>13.4</b> Rでのマルチレベルモデル</a></li>
<li class="chapter" data-level="13.5" data-path="12-glmm.html"><a href="12-glmm.html#正規分布以外を扱う例"><i class="fa fa-check"></i><b>13.5</b> 正規分布以外を扱う例</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="12-glmm.html"><a href="12-glmm.html#ロジスティック回帰-1"><i class="fa fa-check"></i><b>13.5.1</b> ロジスティック回帰</a></li>
<li class="chapter" data-level="13.5.2" data-path="12-glmm.html"><a href="12-glmm.html#ポアソン回帰-1"><i class="fa fa-check"></i><b>13.5.2</b> ポアソン回帰</a></li>
<li class="chapter" data-level="13.5.3" data-path="12-glmm.html"><a href="12-glmm.html#マルチレベルモデルによる過分散への対処"><i class="fa fa-check"></i><b>13.5.3</b> マルチレベルモデルによる過分散への対処</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="12-glmm.html"><a href="12-glmm.html#確認問題-10"><i class="fa fa-check"></i>確認問題</a>
<ul>
<li class="chapter" data-level="" data-path="12-glmm.html"><a href="12-glmm.html#問１-8"><i class="fa fa-check"></i>問１</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="13-Bayese.html"><a href="13-Bayese.html"><i class="fa fa-check"></i><b>14</b> ベイズ統計</a>
<ul>
<li class="chapter" data-level="14.1" data-path="13-Bayese.html"><a href="13-Bayese.html#頻度主義統計学とベイズ統計学の違い"><i class="fa fa-check"></i><b>14.1</b> 頻度主義統計学とベイズ統計学の違い</a></li>
<li class="chapter" data-level="14.2" data-path="13-Bayese.html"><a href="13-Bayese.html#ベイズの定理"><i class="fa fa-check"></i><b>14.2</b> ベイズの定理</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="13-Bayese.html"><a href="13-Bayese.html#例題-3"><i class="fa fa-check"></i><b>14.2.1</b> 例題</a></li>
<li class="chapter" data-level="14.2.2" data-path="13-Bayese.html"><a href="13-Bayese.html#事前確率事後確率"><i class="fa fa-check"></i><b>14.2.2</b> 事前確率、事後確率</a></li>
<li class="chapter" data-level="14.2.3" data-path="13-Bayese.html"><a href="13-Bayese.html#ベイズ統計-1"><i class="fa fa-check"></i><b>14.2.3</b> ベイズ統計</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="13-Bayese.html"><a href="13-Bayese.html#ベイズ推定の例"><i class="fa fa-check"></i><b>14.3</b> ベイズ推定の例</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="13-Bayese.html"><a href="13-Bayese.html#事前分布"><i class="fa fa-check"></i><b>14.3.1</b> 事前分布</a></li>
<li class="chapter" data-level="14.3.2" data-path="13-Bayese.html"><a href="13-Bayese.html#尤度"><i class="fa fa-check"></i><b>14.3.2</b> 尤度</a></li>
<li class="chapter" data-level="14.3.3" data-path="13-Bayese.html"><a href="13-Bayese.html#事後分布"><i class="fa fa-check"></i><b>14.3.3</b> 事後分布</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="13-Bayese.html"><a href="13-Bayese.html#mcmc"><i class="fa fa-check"></i><b>14.4</b> MCMC</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="13-Bayese.html"><a href="13-Bayese.html#mcmcの例"><i class="fa fa-check"></i><b>14.4.1</b> MCMCの例</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="13-Bayese.html"><a href="13-Bayese.html#確認問題-11"><i class="fa fa-check"></i>確認問題</a>
<ul>
<li class="chapter" data-level="" data-path="13-Bayese.html"><a href="13-Bayese.html#問1-1"><i class="fa fa-check"></i>問1</a></li>
<li class="chapter" data-level="" data-path="13-Bayese.html"><a href="13-Bayese.html#section-6"><i class="fa fa-check"></i>1-1</a></li>
<li class="chapter" data-level="" data-path="13-Bayese.html"><a href="13-Bayese.html#section-7"><i class="fa fa-check"></i>1-2</a></li>
<li class="chapter" data-level="" data-path="13-Bayese.html"><a href="13-Bayese.html#section-8"><i class="fa fa-check"></i>1-3</a></li>
<li class="chapter" data-level="" data-path="13-Bayese.html"><a href="13-Bayese.html#問2-1"><i class="fa fa-check"></i>問2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="14-Bayese_model.html"><a href="14-Bayese_model.html"><i class="fa fa-check"></i><b>15</b> ベイズ統計モデリング</a>
<ul>
<li class="chapter" data-level="15.1" data-path="14-Bayese_model.html"><a href="14-Bayese_model.html#準備-7"><i class="fa fa-check"></i><b>15.1</b> 準備</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="14-Bayese_model.html"><a href="14-Bayese_model.html#rtanのインストール"><i class="fa fa-check"></i><b>15.1.1</b> Rtanのインストール</a></li>
<li class="chapter" data-level="15.1.2" data-path="14-Bayese_model.html"><a href="14-Bayese_model.html#brmsパッケージのインストール"><i class="fa fa-check"></i><b>15.1.2</b> brmsパッケージのインストール</a></li>
<li class="chapter" data-level="15.1.3" data-path="14-Bayese_model.html"><a href="14-Bayese_model.html#パッケージのロード-2"><i class="fa fa-check"></i><b>15.1.3</b> パッケージのロード</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="14-Bayese_model.html"><a href="14-Bayese_model.html#rによるベイズ統計モデリング"><i class="fa fa-check"></i><b>15.2</b> Rによるベイズ統計モデリング</a></li>
<li class="chapter" data-level="15.3" data-path="14-Bayese_model.html"><a href="14-Bayese_model.html#ベイズ統計モデリングのプロセス"><i class="fa fa-check"></i><b>15.3</b> ベイズ統計モデリングのプロセス</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="14-Bayese_model.html"><a href="14-Bayese_model.html#事前分布の設定"><i class="fa fa-check"></i><b>15.3.1</b> 事前分布の設定</a></li>
<li class="chapter" data-level="15.3.2" data-path="14-Bayese_model.html"><a href="14-Bayese_model.html#mcmcの設定"><i class="fa fa-check"></i><b>15.3.2</b> MCMCの設定</a></li>
<li class="chapter" data-level="15.3.3" data-path="14-Bayese_model.html"><a href="14-Bayese_model.html#事後分布の評価"><i class="fa fa-check"></i><b>15.3.3</b> 事後分布の評価</a></li>
<li class="chapter" data-level="15.3.4" data-path="14-Bayese_model.html"><a href="14-Bayese_model.html#収束の評価"><i class="fa fa-check"></i><b>15.3.4</b> 収束の評価</a></li>
<li class="chapter" data-level="15.3.5" data-path="14-Bayese_model.html"><a href="14-Bayese_model.html#モデルの予測評価"><i class="fa fa-check"></i><b>15.3.5</b> モデルの予測評価</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="14-Bayese_model.html"><a href="14-Bayese_model.html#brmsパッケージでの一般化線形モデル"><i class="fa fa-check"></i><b>15.4</b> brmsパッケージでの一般化線形モデル</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="14-Bayese_model.html"><a href="14-Bayese_model.html#ロジスティック回帰-2"><i class="fa fa-check"></i><b>15.4.1</b> ロジスティック回帰</a></li>
<li class="chapter" data-level="15.4.2" data-path="14-Bayese_model.html"><a href="14-Bayese_model.html#ポアソン回帰-2"><i class="fa fa-check"></i><b>15.4.2</b> ポアソン回帰</a></li>
<li class="chapter" data-level="15.4.3" data-path="14-Bayese_model.html"><a href="14-Bayese_model.html#負の二項回帰-1"><i class="fa fa-check"></i><b>15.4.3</b> 負の二項回帰</a></li>
<li class="chapter" data-level="15.4.4" data-path="14-Bayese_model.html"><a href="14-Bayese_model.html#順序ロジスティック回帰-1"><i class="fa fa-check"></i><b>15.4.4</b> 順序ロジスティック回帰</a></li>
<li class="chapter" data-level="15.4.5" data-path="14-Bayese_model.html"><a href="14-Bayese_model.html#多項ロジスティック回帰-1"><i class="fa fa-check"></i><b>15.4.5</b> 多項ロジスティック回帰</a></li>
<li class="chapter" data-level="15.4.6" data-path="14-Bayese_model.html"><a href="14-Bayese_model.html#ゼロ過剰ポアソンモデル-1"><i class="fa fa-check"></i><b>15.4.6</b> ゼロ過剰ポアソンモデル</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="14-Bayese_model.html"><a href="14-Bayese_model.html#brmsパッケージでのマルチレベルモデル"><i class="fa fa-check"></i><b>15.5</b> brmsパッケージでのマルチレベルモデル</a>
<ul>
<li class="chapter" data-level="15.5.1" data-path="14-Bayese_model.html"><a href="14-Bayese_model.html#ランダム切片"><i class="fa fa-check"></i><b>15.5.1</b> ランダム切片</a></li>
<li class="chapter" data-level="15.5.2" data-path="14-Bayese_model.html"><a href="14-Bayese_model.html#ランダム傾き"><i class="fa fa-check"></i><b>15.5.2</b> ランダム傾き</a></li>
</ul></li>
<li class="chapter" data-level="15.6" data-path="14-Bayese_model.html"><a href="14-Bayese_model.html#その他"><i class="fa fa-check"></i><b>15.6</b> その他</a>
<ul>
<li class="chapter" data-level="15.6.1" data-path="14-Bayese_model.html"><a href="14-Bayese_model.html#stanコードの出力"><i class="fa fa-check"></i><b>15.6.1</b> Stanコードの出力</a></li>
<li class="chapter" data-level="15.6.2" data-path="14-Bayese_model.html"><a href="14-Bayese_model.html#より深く学ぶには"><i class="fa fa-check"></i><b>15.6.2</b> より深く学ぶには</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>付録</b></span></li>
<li class="chapter" data-level="A" data-path="15-Appendix_References.html"><a href="15-Appendix_References.html"><i class="fa fa-check"></i><b>A</b> 確率分布</a>
<ul>
<li class="chapter" data-level="A.1" data-path="15-Appendix_References.html"><a href="15-Appendix_References.html#連続型確率分布"><i class="fa fa-check"></i><b>A.1</b> 連続型確率分布</a>
<ul>
<li class="chapter" data-level="" data-path="15-Appendix_References.html"><a href="15-Appendix_References.html#正規分布-1"><i class="fa fa-check"></i>正規分布</a></li>
<li class="chapter" data-level="" data-path="15-Appendix_References.html"><a href="15-Appendix_References.html#指数分布"><i class="fa fa-check"></i>指数分布</a></li>
<li class="chapter" data-level="" data-path="15-Appendix_References.html"><a href="15-Appendix_References.html#対数正規分布"><i class="fa fa-check"></i>対数正規分布</a></li>
<li class="chapter" data-level="" data-path="15-Appendix_References.html"><a href="15-Appendix_References.html#t分布"><i class="fa fa-check"></i>t分布</a></li>
<li class="chapter" data-level="" data-path="15-Appendix_References.html"><a href="15-Appendix_References.html#カイ二乗分布"><i class="fa fa-check"></i>カイ二乗分布</a></li>
<li class="chapter" data-level="" data-path="15-Appendix_References.html"><a href="15-Appendix_References.html#f分布"><i class="fa fa-check"></i>F分布</a></li>
<li class="chapter" data-level="" data-path="15-Appendix_References.html"><a href="15-Appendix_References.html#コーシー分布"><i class="fa fa-check"></i>コーシー分布</a></li>
</ul></li>
<li class="chapter" data-level="A.2" data-path="15-Appendix_References.html"><a href="15-Appendix_References.html#離散型確率分布"><i class="fa fa-check"></i><b>A.2</b> 離散型確率分布</a>
<ul>
<li class="chapter" data-level="" data-path="15-Appendix_References.html"><a href="15-Appendix_References.html#二項分布-1"><i class="fa fa-check"></i>二項分布</a></li>
<li class="chapter" data-level="" data-path="15-Appendix_References.html"><a href="15-Appendix_References.html#負の二項分布-1"><i class="fa fa-check"></i>負の二項分布</a></li>
<li class="chapter" data-level="" data-path="15-Appendix_References.html"><a href="15-Appendix_References.html#幾何分布"><i class="fa fa-check"></i>幾何分布</a></li>
<li class="chapter" data-level="" data-path="15-Appendix_References.html"><a href="15-Appendix_References.html#超幾何分布"><i class="fa fa-check"></i>超幾何分布</a></li>
<li class="chapter" data-level="" data-path="15-Appendix_References.html"><a href="15-Appendix_References.html#ポアソン分布-1"><i class="fa fa-check"></i>ポアソン分布</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="B" data-path="15-Appendix_References.html"><a href="15-Appendix_References.html#r-markdownの使い方"><i class="fa fa-check"></i><b>B</b> R Markdownの使い方</a></li>
<li class="chapter" data-level="C" data-path="15-Appendix_References.html"><a href="15-Appendix_References.html#参考資料"><i class="fa fa-check"></i><b>C</b> 参考資料</a>
<ul>
<li class="chapter" data-level="C.1" data-path="15-Appendix_References.html"><a href="15-Appendix_References.html#文献"><i class="fa fa-check"></i><b>C.1</b> 文献</a>
<ul>
<li class="chapter" data-level="C.1.1" data-path="15-Appendix_References.html"><a href="15-Appendix_References.html#統計学の解説書"><i class="fa fa-check"></i><b>C.1.1</b> 統計学の解説書</a></li>
<li class="chapter" data-level="C.1.2" data-path="15-Appendix_References.html"><a href="15-Appendix_References.html#rを用いた統計解析の解説書"><i class="fa fa-check"></i><b>C.1.2</b> Rを用いた統計解析の解説書</a></li>
<li class="chapter" data-level="C.1.3" data-path="15-Appendix_References.html"><a href="15-Appendix_References.html#一般化線形モデルマルチレベルモデルなどの解説書"><i class="fa fa-check"></i><b>C.1.3</b> 一般化線形モデル、マルチレベルモデルなどの解説書</a></li>
<li class="chapter" data-level="C.1.4" data-path="15-Appendix_References.html"><a href="15-Appendix_References.html#ベイズ統計モデリングの解説書"><i class="fa fa-check"></i><b>C.1.4</b> ベイズ統計モデリングの解説書</a></li>
</ul></li>
<li class="chapter" data-level="C.2" data-path="15-Appendix_References.html"><a href="15-Appendix_References.html#webサイト"><i class="fa fa-check"></i><b>C.2</b> Webサイト</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">心理データ応用解析法</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="線形モデルの注意点" class="section level1 hasAnchor" number="10">
<h1><span class="header-section-number">Chapter 10</span> 線形モデルの注意点<a href="09-linear_model2.html#線形モデルの注意点" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>前の章で、線形モデルの全体像を見てきた。ここでは、線形モデルを扱う上で注意すべき点について見ていく。</p>
<div id="準備-2" class="section level2 hasAnchor" number="10.1">
<h2><span class="header-section-number">10.1</span> 準備<a href="09-linear_model2.html#準備-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>データの可視化のために、<code>ggplot2</code>パッケージをロードする。</p>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb350-1"><a href="09-linear_model2.html#cb350-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code></pre></div>
</div>
<div id="線形モデルに含まれる統計解析" class="section level2 hasAnchor" number="10.2">
<h2><span class="header-section-number">10.2</span> 線形モデルに含まれる統計解析<a href="09-linear_model2.html#線形モデルに含まれる統計解析" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>線形モデルとは特定の解析を指すものではなく、正規分布を扱う様々な統計解析を包括的に扱う統計モデルである。例えば、基礎の統計学でも学んできたt検定や分散分析も線形モデルの中に含まれる。予測変数の種類や個数の違いによって、線形モデルは以下のそれぞれの統計解析と一致する。</p>
<table>
<colgroup>
<col width="15%" />
<col width="39%" />
<col width="44%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">分析</th>
<th align="left">予測変数</th>
<th align="left">予測変数の個数</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">t検定</td>
<td align="left">二値(0 or 1)</td>
<td align="left">1個</td>
</tr>
<tr class="even">
<td align="left">分散分析</td>
<td align="left">二値</td>
<td align="left">2個以上</td>
</tr>
<tr class="odd">
<td align="left">共分散分析</td>
<td align="left">二値及び連続量</td>
<td align="left">二値が2個以上、連続量が1個以上</td>
</tr>
<tr class="even">
<td align="left">重回帰分析</td>
<td align="left">連続量（二値を含んでも可）</td>
<td align="left">2個以上</td>
</tr>
</tbody>
</table>
</div>
<div id="予測変数がカテゴリカル変数の場合" class="section level2 hasAnchor" number="10.3">
<h2><span class="header-section-number">10.3</span> 予測変数がカテゴリカル変数の場合<a href="09-linear_model2.html#予測変数がカテゴリカル変数の場合" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>前の章では、予測変数が量的変数の場合を例として扱ったが、予測変数はカテゴリカル変数（質的変数）でも構わない。ただし、予測変数がカテゴリカル変数の場合は、予測変数を0か1のどちらかの値を取る<strong>ダミー変数</strong>(dummy variable)に変換する必要がある。</p>
<p>Rに入っている<code>sleep</code>データを少し変えたもの使って、カテゴリカル変数を予測変数に含む線形モデルの解析をしてみよう。</p>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb351-1"><a href="09-linear_model2.html#cb351-1" tabindex="-1"></a>dat <span class="ot">=</span> sleep <span class="co">#データを別の名前datに保存し直す</span></span>
<span id="cb351-2"><a href="09-linear_model2.html#cb351-2" tabindex="-1"></a></span>
<span id="cb351-3"><a href="09-linear_model2.html#cb351-3" tabindex="-1"></a><span class="co">#変数の名前を変える</span></span>
<span id="cb351-4"><a href="09-linear_model2.html#cb351-4" tabindex="-1"></a>dat<span class="sc">$</span>x <span class="ot">=</span> <span class="fu">ifelse</span>(dat<span class="sc">$</span>group <span class="sc">==</span> <span class="dv">1</span>, <span class="st">&quot;control&quot;</span>, <span class="st">&quot;treatment&quot;</span>) </span>
<span id="cb351-5"><a href="09-linear_model2.html#cb351-5" tabindex="-1"></a>dat<span class="sc">$</span>y <span class="ot">=</span> dat<span class="sc">$</span>extra </span>
<span id="cb351-6"><a href="09-linear_model2.html#cb351-6" tabindex="-1"></a>dat <span class="ot">=</span> dat[,<span class="fu">c</span>(<span class="st">&quot;y&quot;</span>, <span class="st">&quot;x&quot;</span>)]</span>
<span id="cb351-7"><a href="09-linear_model2.html#cb351-7" tabindex="-1"></a><span class="fu">head</span>(dat) <span class="co">#datの中身を確認する</span></span></code></pre></div>
<pre><code>##      y       x
## 1  0.7 control
## 2 -1.6 control
## 3 -0.2 control
## 4 -1.2 control
## 5 -0.1 control
## 6  3.4 control</code></pre>
<p><code>x</code>はグループを意味する変数で、カテゴリカル変数である（統制群<code>control</code>もしくは実験群<code>treatment</code>）。まずこれを、「<code>treatment</code>なら1、<code>control</code>なら0」とする新たな変数<code>x_1</code>を作る。</p>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb353-1"><a href="09-linear_model2.html#cb353-1" tabindex="-1"></a>dat<span class="sc">$</span>x_1 <span class="ot">=</span> <span class="fu">ifelse</span>(dat<span class="sc">$</span>x <span class="sc">==</span> <span class="st">&quot;treatment&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb353-2"><a href="09-linear_model2.html#cb353-2" tabindex="-1"></a><span class="fu">head</span>(dat)</span></code></pre></div>
<pre><code>##      y       x x_1
## 1  0.7 control   0
## 2 -1.6 control   0
## 3 -0.2 control   0
## 4 -1.2 control   0
## 5 -0.1 control   0
## 6  3.4 control   0</code></pre>
<p><code>ifelse()</code>関数は、<code>ifelse(XXX, A, B)</code>と表記することで、「XXXの条件に当てはまればA、当てはまらなければB」という処理をしてくれる。ここでは、予測変数のベクトル<code>x</code>について、<code>treatment</code>ならば1, それ以外なら0に変換し、0か1を取る変数<span class="math inline">\(x_{1}\)</span>を新たに作った。</p>
<p>この<span class="math inline">\(x_{1}\)</span>が<em>ダミー変数</em>である。</p>
<p>解析に用いるモデルを確認すると、以下のようになる。</p>
<p><span class="math display">\[
\begin{equation}
  \mu = \alpha + \beta x_{1} \\ \tag{1}\\
  y \sim \text{Normal}(\mu, \sigma)
\end{equation}
\]</span></p>
<p><span class="math inline">\(x_{1}\)</span>は0か1のどちらかを取る変数で、<span class="math inline">\(x_{1} = 0\)</span>のとき、つまり統制群のとき、応答変数の予測値は<span class="math inline">\(\mu = \alpha\)</span>となる。<span class="math inline">\(x_{1} = 1\)</span>のとき、つまり実験群のとき、応答変数の予測値は<span class="math inline">\(\mu = \alpha + \beta\)</span>となる。すなわち、切片<span class="math inline">\(\alpha\)</span>は統制群のときの効果、傾き<span class="math inline">\(\beta\)</span>は実験群の時に加わる実験群特有の効果を意味する。</p>
<p><code>lm()</code>を使って、上のモデル式のパラメータの推定をしよう。</p>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb355-1"><a href="09-linear_model2.html#cb355-1" tabindex="-1"></a>result <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">data =</span> dat, y <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> x_1)</span>
<span id="cb355-2"><a href="09-linear_model2.html#cb355-2" tabindex="-1"></a><span class="fu">summary</span>(result)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ 1 + x_1, data = dat)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -2.430 -1.305 -0.580  1.455  3.170 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)   0.7500     0.6004   1.249   0.2276  
## x_1           1.5800     0.8491   1.861   0.0792 .
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.899 on 18 degrees of freedom
## Multiple R-squared:  0.1613, Adjusted R-squared:  0.1147 
## F-statistic: 3.463 on 1 and 18 DF,  p-value: 0.07919</code></pre>
<p>2つの群間で平均値を比較するときにはt検定がよく使われる。<code>t.test()</code>関数を使って<span class="math inline">\(x_{1}=0\)</span>と<span class="math inline">\(x_{1}=1\)</span>との間で<span class="math inline">\(y\)</span>の値の平均値を比較したときのt値及びp値の結果が、<code>lm()</code>の傾きのt値及びp値と一致することを確認しよう。</p>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb357-1"><a href="09-linear_model2.html#cb357-1" tabindex="-1"></a><span class="fu">t.test</span>(<span class="at">data =</span> dat, y <span class="sc">~</span> x_1)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  y by x_1
## t = -1.8608, df = 17.776, p-value = 0.07939
## alternative hypothesis: true difference in means between group 0 and group 1 is not equal to 0
## 95 percent confidence interval:
##  -3.3654832  0.2054832
## sample estimates:
## mean in group 0 mean in group 1 
##            0.75            2.33</code></pre>
<p><code>lm()</code>の傾きの検定は、「傾きがゼロである」という帰無仮説を検定している。傾きの係数が意味することは、予測変数<span class="math inline">\(x_{1}\)</span>が1単位増えたときの応答変数<span class="math inline">\(y\)</span>の変化量であった。傾きの検定は、「<span class="math inline">\(x_{1}=0\)</span> から <span class="math inline">\(x_{1}=1\)</span> に変化することによって、 <span class="math inline">\(y\)</span> が上昇（下降）するか（傾きがゼロではないか）」を検定している。要は、「<span class="math inline">\(x_{1}=0\)</span>と<span class="math inline">\(x_{1}=1\)</span>の間で<span class="math inline">\(y\)</span>の値に差があるか」を検定しているのと論理的に同じである。</p>
<p>このように、<em>予測変数が1つで、予測変数が二値（0もしくは1）であるときの線形モデルは、t検定に対応する</em>。</p>
</div>
<div id="グループが複数ある場合" class="section level2 hasAnchor" number="10.4">
<h2><span class="header-section-number">10.4</span> グループが複数ある場合<a href="09-linear_model2.html#グループが複数ある場合" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>先ほどの例は、統制群と実験群の二つのグループの場合であった。例えば実験で統制群、実験群1、実験群2といったように三つ以上のグループを設定した場合は、どうダミー変数を作成すればよいのか？</p>
<p>Rに入っている<code>PlantGrowth</code>を例として見ていこう。例えばやり方としては、以下の方法がある。</p>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb359-1"><a href="09-linear_model2.html#cb359-1" tabindex="-1"></a>dat <span class="ot">=</span> PlantGrowth</span>
<span id="cb359-2"><a href="09-linear_model2.html#cb359-2" tabindex="-1"></a>dat<span class="sc">$</span>y <span class="ot">=</span> dat<span class="sc">$</span>weight <span class="co">#名前をyに変える</span></span>
<span id="cb359-3"><a href="09-linear_model2.html#cb359-3" tabindex="-1"></a></span>
<span id="cb359-4"><a href="09-linear_model2.html#cb359-4" tabindex="-1"></a>dat<span class="sc">$</span>x_c <span class="ot">=</span> <span class="fu">ifelse</span>(dat<span class="sc">$</span>group <span class="sc">==</span> <span class="st">&quot;ctrl&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb359-5"><a href="09-linear_model2.html#cb359-5" tabindex="-1"></a>dat<span class="sc">$</span>x_t1 <span class="ot">=</span> <span class="fu">ifelse</span>(dat<span class="sc">$</span>group <span class="sc">==</span> <span class="st">&quot;trt1&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb359-6"><a href="09-linear_model2.html#cb359-6" tabindex="-1"></a>dat<span class="sc">$</span>x_t2 <span class="ot">=</span> <span class="fu">ifelse</span>(dat<span class="sc">$</span>group <span class="sc">==</span> <span class="st">&quot;trt2&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb359-7"><a href="09-linear_model2.html#cb359-7" tabindex="-1"></a></span>
<span id="cb359-8"><a href="09-linear_model2.html#cb359-8" tabindex="-1"></a>dat</span></code></pre></div>
<pre><code>##    weight group    y x_c x_t1 x_t2
## 1    4.17  ctrl 4.17   1    0    0
## 2    5.58  ctrl 5.58   1    0    0
## 3    5.18  ctrl 5.18   1    0    0
## 4    6.11  ctrl 6.11   1    0    0
## 5    4.50  ctrl 4.50   1    0    0
## 6    4.61  ctrl 4.61   1    0    0
## 7    5.17  ctrl 5.17   1    0    0
## 8    4.53  ctrl 4.53   1    0    0
## 9    5.33  ctrl 5.33   1    0    0
## 10   5.14  ctrl 5.14   1    0    0
## 11   4.81  trt1 4.81   0    1    0
## 12   4.17  trt1 4.17   0    1    0
## 13   4.41  trt1 4.41   0    1    0
## 14   3.59  trt1 3.59   0    1    0
## 15   5.87  trt1 5.87   0    1    0
## 16   3.83  trt1 3.83   0    1    0
## 17   6.03  trt1 6.03   0    1    0
## 18   4.89  trt1 4.89   0    1    0
## 19   4.32  trt1 4.32   0    1    0
## 20   4.69  trt1 4.69   0    1    0
## 21   6.31  trt2 6.31   0    0    1
## 22   5.12  trt2 5.12   0    0    1
## 23   5.54  trt2 5.54   0    0    1
## 24   5.50  trt2 5.50   0    0    1
## 25   5.37  trt2 5.37   0    0    1
## 26   5.29  trt2 5.29   0    0    1
## 27   4.92  trt2 4.92   0    0    1
## 28   6.15  trt2 6.15   0    0    1
## 29   5.80  trt2 5.80   0    0    1
## 30   5.26  trt2 5.26   0    0    1</code></pre>
<p>3種類のダミー変数を作った。それぞれ、<code>x_c</code>は「<code>ctrl</code>ならば1、それ以外なら0」、<code>x_t1</code>は「<code>trt1</code>ならば1、それ以外なら0」、<code>x_t2</code>は「<code>trt2</code>ならば1、それ以外なら0」となっている。これら3つのダミー変数を使ってモデルを作り、パラメータを推定する。</p>
<p><span class="math display">\[
\begin{equation}
  \mu = \beta_{c} x_{c} + \beta_{t1} x_{t1} + \beta_{t2} x_{t2}  \\ \tag{2}
  y \sim \text{Normal}(\mu, \sigma)
\end{equation}
\]</span></p>
<p>ここで注意が必要なのは、今回のモデルでは切片<span class="math inline">\(\alpha\)</span>が省かれていることである。その理由は後ほど説明する。</p>
<p>モデルを<code>lm()</code>で記述して、推定してみよう。以下のプログラムを実行する。<br />
＊<code>lm(data = dat, y ~ x_c + x_t1 + x_t2 - 1)</code>の中に-1が加わっている点に注意。これは「モデルから切片を除け」という命令である。</p>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb361-1"><a href="09-linear_model2.html#cb361-1" tabindex="-1"></a>dat<span class="sc">$</span>y_2 <span class="ot">=</span> (dat<span class="sc">$</span>y <span class="sc">-</span> <span class="fu">mean</span>(dat<span class="sc">$</span>y))<span class="sc">/</span><span class="fu">sd</span>(dat<span class="sc">$</span>y) <span class="co">#yを標準化しておく</span></span>
<span id="cb361-2"><a href="09-linear_model2.html#cb361-2" tabindex="-1"></a></span>
<span id="cb361-3"><a href="09-linear_model2.html#cb361-3" tabindex="-1"></a>result <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">data =</span> dat, y_2 <span class="sc">~</span> x_c <span class="sc">+</span> x_t1 <span class="sc">+</span> x_t2 <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb361-4"><a href="09-linear_model2.html#cb361-4" tabindex="-1"></a><span class="fu">summary</span>(result)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y_2 ~ x_c + x_t1 + x_t2 - 1, data = dat)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.52740 -0.59613 -0.00856  0.37472  1.95239 
## 
## Coefficients:
##      Estimate Std. Error t value Pr(&gt;|t|)  
## x_c  -0.05847    0.28113  -0.208   0.8368  
## x_t1 -0.58757    0.28113  -2.090   0.0462 *
## x_t2  0.64604    0.28113   2.298   0.0295 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.889 on 27 degrees of freedom
## Multiple R-squared:  0.2641, Adjusted R-squared:  0.1824 
## F-statistic: 3.231 on 3 and 27 DF,  p-value: 0.03793</code></pre>
<p>それぞれのダミー変数に係る傾きの係数、すなわち式(2)における<span class="math inline">\(\beta_{c}\)</span>、<span class="math inline">\(\beta_{t1}\)</span>、<span class="math inline">\(\beta_{t2}\)</span>の推定結果が出力される。それぞれ、<code>ctrl</code>、<code>trt1</code>, <code>trt2</code>における応答変数(<code>y</code>)の推定値を意味している。</p>
<p>x_t1の係数は負でp値は<span class="math inline">\(p&lt;.05\)</span>に、x_t2の係数は正でp値は<span class="math inline">\(p&lt;.05\)</span>となった。これらが意味していることは、「<code>x_t1</code> = 1のときに、<code>y_2</code>の値は有意に0.59下がる」と「<code>x_t2</code> = 1のときに、<code>y_2</code>の値は有意にに0.65上がる」ということである。言い換えれば、「実験条件1では全体の平均よりも植物の重量の値が低く」、「実験条件2では全体の平均よりも植物の重量の値が高い」傾向にあることを示している。</p>
<p>図でも条件別に<code>y_2</code>の分布を確認してみよう。分布を見ても同様の傾向があるが、線形モデルの解析の結果その効果が有意であることが確認できた。</p>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb363-1"><a href="09-linear_model2.html#cb363-1" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb363-2"><a href="09-linear_model2.html#cb363-2" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">data =</span> dat, <span class="fu">aes</span>(<span class="at">x =</span> group, <span class="at">y =</span> y_2))</span></code></pre></div>
<p><img src="Data-Analysis-for-Psychology_files/figure-html/unnamed-chunk-201-1.png" width="672" /></p>
<div id="基準となるグループと比較する" class="section level3 hasAnchor" number="10.4.1">
<h3><span class="header-section-number">10.4.1</span> 基準となるグループと比較する<a href="09-linear_model2.html#基準となるグループと比較する" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>もう一つの方法は、グループの数が<span class="math inline">\(K\)</span>個あるのならば、基準となるグループを定めてダミー変数を<span class="math inline">\(K-1\)</span>個作る方法である。</p>
<p>以下のプログラムを実行して、データを作り直そう。</p>
<div class="sourceCode" id="cb364"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb364-1"><a href="09-linear_model2.html#cb364-1" tabindex="-1"></a>dat <span class="ot">=</span> PlantGrowth</span>
<span id="cb364-2"><a href="09-linear_model2.html#cb364-2" tabindex="-1"></a>dat<span class="sc">$</span>y <span class="ot">=</span> dat<span class="sc">$</span>weight <span class="co">#名前をyに変える</span></span>
<span id="cb364-3"><a href="09-linear_model2.html#cb364-3" tabindex="-1"></a></span>
<span id="cb364-4"><a href="09-linear_model2.html#cb364-4" tabindex="-1"></a>dat<span class="sc">$</span>x_t1 <span class="ot">=</span> <span class="fu">ifelse</span>(dat<span class="sc">$</span>group <span class="sc">==</span> <span class="st">&quot;trt1&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb364-5"><a href="09-linear_model2.html#cb364-5" tabindex="-1"></a>dat<span class="sc">$</span>x_t2 <span class="ot">=</span> <span class="fu">ifelse</span>(dat<span class="sc">$</span>group <span class="sc">==</span> <span class="st">&quot;trt2&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb364-6"><a href="09-linear_model2.html#cb364-6" tabindex="-1"></a></span>
<span id="cb364-7"><a href="09-linear_model2.html#cb364-7" tabindex="-1"></a>dat</span></code></pre></div>
<pre><code>##    weight group    y x_t1 x_t2
## 1    4.17  ctrl 4.17    0    0
## 2    5.58  ctrl 5.58    0    0
## 3    5.18  ctrl 5.18    0    0
## 4    6.11  ctrl 6.11    0    0
## 5    4.50  ctrl 4.50    0    0
## 6    4.61  ctrl 4.61    0    0
## 7    5.17  ctrl 5.17    0    0
## 8    4.53  ctrl 4.53    0    0
## 9    5.33  ctrl 5.33    0    0
## 10   5.14  ctrl 5.14    0    0
## 11   4.81  trt1 4.81    1    0
## 12   4.17  trt1 4.17    1    0
## 13   4.41  trt1 4.41    1    0
## 14   3.59  trt1 3.59    1    0
## 15   5.87  trt1 5.87    1    0
## 16   3.83  trt1 3.83    1    0
## 17   6.03  trt1 6.03    1    0
## 18   4.89  trt1 4.89    1    0
## 19   4.32  trt1 4.32    1    0
## 20   4.69  trt1 4.69    1    0
## 21   6.31  trt2 6.31    0    1
## 22   5.12  trt2 5.12    0    1
## 23   5.54  trt2 5.54    0    1
## 24   5.50  trt2 5.50    0    1
## 25   5.37  trt2 5.37    0    1
## 26   5.29  trt2 5.29    0    1
## 27   4.92  trt2 4.92    0    1
## 28   6.15  trt2 6.15    0    1
## 29   5.80  trt2 5.80    0    1
## 30   5.26  trt2 5.26    0    1</code></pre>
<p>今度は、ダミー変数は2つで各条件を表している。<code>ctrl</code>のときは「<code>x_t1</code> = 0, <code>x_t2</code> = 0」,<code>trt1</code>のときは「<code>x_t1</code> = 1, <code>x_t2</code> = 0」,<code>trt2</code>のときは「<code>x_t1</code> = 0, <code>x_t2</code> = 1」となる。</p>
<p>これら2つのダミー変数を予測変数として、<code>lm()</code>で<code>y</code>を推定しよう。ただし、今度は切片<span class="math inline">\(\alpha\)</span>を入れたモデルで推定する。モデルは以下のようになる。</p>
<p><span class="math display">\[
\begin{equation}
  \mu = \alpha + \beta_{t1} x_{t1} + \beta_{t2} x_{t2}  \\ \tag{3}
  y \sim \text{Normal}(\mu, \sigma)
\end{equation}
\]</span></p>
<div class="sourceCode" id="cb366"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb366-1"><a href="09-linear_model2.html#cb366-1" tabindex="-1"></a>dat<span class="sc">$</span>y_2 <span class="ot">=</span> (dat<span class="sc">$</span>y <span class="sc">-</span> <span class="fu">mean</span>(dat<span class="sc">$</span>y))<span class="sc">/</span><span class="fu">sd</span>(dat<span class="sc">$</span>y) <span class="co">#標準化する</span></span>
<span id="cb366-2"><a href="09-linear_model2.html#cb366-2" tabindex="-1"></a>result <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">data =</span> dat, y_2 <span class="sc">~</span> x_t1 <span class="sc">+</span> x_t2 <span class="sc">+</span> <span class="dv">1</span>) </span>
<span id="cb366-3"><a href="09-linear_model2.html#cb366-3" tabindex="-1"></a><span class="fu">summary</span>(result)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y_2 ~ x_t1 + x_t2 + 1, data = dat)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.52740 -0.59613 -0.00856  0.37472  1.95239 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept) -0.05847    0.28113  -0.208   0.8368  
## x_t1        -0.52910    0.39758  -1.331   0.1944  
## x_t2         0.70451    0.39758   1.772   0.0877 .
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.889 on 27 degrees of freedom
## Multiple R-squared:  0.2641, Adjusted R-squared:  0.2096 
## F-statistic: 4.846 on 2 and 27 DF,  p-value: 0.01591</code></pre>
<p>式（3）より、切片の推定値は<span class="math inline">\(x_{t1}=0\)</span>かつ<span class="math inline">\(x_{t2}=0\)</span>のときの<span class="math inline">\(\mu\)</span>、つまり統制群(ctrl)のときの応答変数<span class="math inline">\(y\)</span>の推定値を意味している。各ダミー変数の係数（傾き）は、切片に加わる各条件の効果を意味している。例えば、<code>x_t2</code>の係数は0.7であるが、これは<span class="math inline">\(x_{t2}=1\)</span>のとき（つまりtrt2のとき）の応答変数の予測値は、 0.65(= 切片 + <code>x_t2</code>の傾き)となることを示している。</p>
<p>このように、グループが<span class="math inline">\(K\)</span>個ある場合（<span class="math inline">\(K &gt; 2\)</span>）、<span class="math inline">\(K-1\)</span>個のダミー変数を作って推定する方法もある。係数の意味することは、基準となるグループ（どのダミー変数も0となるグループ）と比べての効果ということになる。</p>
<p>このように、モデルを組み直すことにより、係数が意味することも変化してくる。モデル（式）を確認しながら、係数が何を意味しているのかを常に意識するようにしよう。</p>
</div>
</div>
<div id="予測変数が複数ある場合" class="section level2 hasAnchor" number="10.5">
<h2><span class="header-section-number">10.5</span> 予測変数が複数ある場合<a href="09-linear_model2.html#予測変数が複数ある場合" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>先の例や前の章でも見たように、予測変数は2つ以上入れても良い。予測変数が複数ある場合の注意点を見ていく。</p>
<div id="変数の効果の統制" class="section level3 hasAnchor" number="10.5.1">
<h3><span class="header-section-number">10.5.1</span> 変数の効果の統制<a href="09-linear_model2.html#変数の効果の統制" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>予測変数を複数加えた線形モデルの解析のメリットは、ある予測変数について他の予測変数の効果を<strong>統制(control)</strong>したときの効果を検討できることにある。</p>
<p>Rで標準で入っている<code>attitude</code>データを使って、予測変数が複数ある場合の線形モデルの解析の結果を確認してみよう。</p>
<div class="sourceCode" id="cb368"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb368-1"><a href="09-linear_model2.html#cb368-1" tabindex="-1"></a><span class="fu">head</span>(attitude)</span></code></pre></div>
<pre><code>##   rating complaints privileges learning raises critical advance
## 1     43         51         30       39     61       92      45
## 2     63         64         51       54     63       73      47
## 3     71         70         68       69     76       86      48
## 4     61         63         45       47     54       84      35
## 5     81         78         56       66     71       83      47
## 6     43         55         49       44     54       49      34</code></pre>
<p>以下のように、<code>complaints</code>, <code>privileges</code>, <code>learning</code>, <code>raises</code>の4つを予測変数として、<code>rating</code>の値の推定を行ってみよう。</p>
<div class="sourceCode" id="cb370"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb370-1"><a href="09-linear_model2.html#cb370-1" tabindex="-1"></a>result <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">data =</span> attitude, rating <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> complaints <span class="sc">+</span> privileges <span class="sc">+</span> learning <span class="sc">+</span> raises)</span>
<span id="cb370-2"><a href="09-linear_model2.html#cb370-2" tabindex="-1"></a><span class="fu">summary</span>(result)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = rating ~ 1 + complaints + privileges + learning + 
##     raises, data = attitude)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -11.2663  -5.3960   0.5988   5.8000  11.2370 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 11.83354    8.53511   1.386    0.178    
## complaints   0.69115    0.14565   4.745 7.21e-05 ***
## privileges  -0.10289    0.13189  -0.780    0.443    
## learning     0.24633    0.15435   1.596    0.123    
## raises      -0.02551    0.18388  -0.139    0.891    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 6.996 on 25 degrees of freedom
## Multiple R-squared:  0.7152, Adjusted R-squared:  0.6697 
## F-statistic:  15.7 on 4 and 25 DF,  p-value: 1.509e-06</code></pre>
<p>切片（Intercept）は全ての予測変数の値がゼロのときの応答変数の予測値であり、各予測変数の係数は予測変数が1単位増えた場合の応答変数の変化量を意味している。例えば、complaintsの係数は0.69であるが、これは「<code>complaints</code>が1増えると<code>rating</code>は0.69増える傾向にある」ことを意味している。</p>
<p>各係数の値は「他の変数の値がゼロであるときの効果」を意味している。先程の<code>complaints</code>の係数0.69は、その他の予測変数<code>privileges</code>, <code>learning</code>, <code>raises</code>がゼロのときの、<code>complaints</code>が<code>rating</code>に与えるそのものの効果を示している。</p>
<p>このように複数の予測変数を入れたモデルで推定される係数は、他の予測変数の効果を統制した上での予測変数が応答変数に及ぼす効果を意味する。</p>
</div>
<div id="交互作用" class="section level3 hasAnchor" number="10.5.2">
<h3><span class="header-section-number">10.5.2</span> 交互作用<a href="09-linear_model2.html#交互作用" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>以下のプログラムを実行して、サンプルデータ<code>d</code>を作ろう。</p>
<div class="sourceCode" id="cb372"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb372-1"><a href="09-linear_model2.html#cb372-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb372-2"><a href="09-linear_model2.html#cb372-2" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">runif</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">min =</span> <span class="dv">1</span>, <span class="at">max =</span> <span class="dv">10</span>),<span class="dv">0</span>) </span>
<span id="cb372-3"><a href="09-linear_model2.html#cb372-3" tabindex="-1"></a>mu <span class="ot">=</span> <span class="fl">0.1</span> <span class="sc">+</span> <span class="fl">0.4</span> <span class="sc">*</span> x</span>
<span id="cb372-4"><a href="09-linear_model2.html#cb372-4" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">mean =</span> mu, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb372-5"><a href="09-linear_model2.html#cb372-5" tabindex="-1"></a>d_M <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">gender =</span> <span class="st">&quot;M&quot;</span>)</span>
<span id="cb372-6"><a href="09-linear_model2.html#cb372-6" tabindex="-1"></a></span>
<span id="cb372-7"><a href="09-linear_model2.html#cb372-7" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">runif</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">min =</span> <span class="dv">1</span>, <span class="at">max =</span> <span class="dv">10</span>),<span class="dv">0</span>) </span>
<span id="cb372-8"><a href="09-linear_model2.html#cb372-8" tabindex="-1"></a>mu <span class="ot">=</span> <span class="fl">0.3</span> <span class="sc">+</span> <span class="sc">-</span><span class="fl">0.6</span> <span class="sc">*</span> x</span>
<span id="cb372-9"><a href="09-linear_model2.html#cb372-9" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">mean =</span> mu, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb372-10"><a href="09-linear_model2.html#cb372-10" tabindex="-1"></a>d_F <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">gender =</span> <span class="st">&quot;F&quot;</span>)</span>
<span id="cb372-11"><a href="09-linear_model2.html#cb372-11" tabindex="-1"></a></span>
<span id="cb372-12"><a href="09-linear_model2.html#cb372-12" tabindex="-1"></a>d <span class="ot">=</span> <span class="fu">rbind</span>(d_M, d_F)</span>
<span id="cb372-13"><a href="09-linear_model2.html#cb372-13" tabindex="-1"></a></span>
<span id="cb372-14"><a href="09-linear_model2.html#cb372-14" tabindex="-1"></a><span class="fu">head</span>(d)</span></code></pre></div>
<pre><code>##   x        y gender
## 1 3 2.811781      M
## 2 4 2.089843      M
## 3 6 1.878759      M
## 4 9 1.485300      M
## 5 3 2.424931      M
## 6 9 3.655066      M</code></pre>
<p>このデータ<code>d</code>には、<code>x</code>, <code>y</code>, <code>gender</code>の3つの変数が含まれている。<code>gender</code>は性別を意味する変数とする。M（男性）かF（女性）のいずれかである。男女別に、実験で2つの変数を測定したとしよう。</p>
<p>応答変数を<code>y</code>、予測変数を<code>x</code>として線形モデルで切片及び<code>x</code>の傾きのパラメータを推定する。モデルは以下のようになる。</p>
<p><span class="math display">\[
\begin{equation}
  \mu = \alpha + \beta x  \\ \tag{4}
  y \sim \text{Normal}(\mu, \sigma)
\end{equation}
\]</span></p>
<p><code>lm()</code>関数を使って推定しよう（<span class="math inline">\(x\)</span>と<span class="math inline">\(y\)</span>の散布図及び係数の信頼区間も図示する）。</p>
<div class="sourceCode" id="cb374"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb374-1"><a href="09-linear_model2.html#cb374-1" tabindex="-1"></a>result <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">data =</span> d, y <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> x)</span>
<span id="cb374-2"><a href="09-linear_model2.html#cb374-2" tabindex="-1"></a><span class="fu">summary</span>(result)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ 1 + x, data = d)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.8209 -2.5577 -0.7021  2.4363  5.1560 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)   0.7389     1.3472   0.549    0.587
## x            -0.1811     0.2060  -0.879    0.385
## 
## Residual standard error: 3.231 on 38 degrees of freedom
## Multiple R-squared:  0.01993,    Adjusted R-squared:  -0.005863 
## F-statistic: 0.7727 on 1 and 38 DF,  p-value: 0.3849</code></pre>
<div class="sourceCode" id="cb376"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb376-1"><a href="09-linear_model2.html#cb376-1" tabindex="-1"></a>newdat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">10</span>,<span class="fl">0.1</span>))</span>
<span id="cb376-2"><a href="09-linear_model2.html#cb376-2" tabindex="-1"></a>result_conf <span class="ot">=</span> <span class="fu">predict</span>(result, <span class="at">new =</span> newdat, <span class="at">interval =</span> <span class="st">&quot;confidence&quot;</span>, <span class="at">level =</span> <span class="fl">0.95</span>)</span>
<span id="cb376-3"><a href="09-linear_model2.html#cb376-3" tabindex="-1"></a>plot_conf <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">10</span>,<span class="fl">0.1</span>), result_conf)</span>
<span id="cb376-4"><a href="09-linear_model2.html#cb376-4" tabindex="-1"></a></span>
<span id="cb376-5"><a href="09-linear_model2.html#cb376-5" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb376-6"><a href="09-linear_model2.html#cb376-6" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(<span class="at">data =</span> d, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb376-7"><a href="09-linear_model2.html#cb376-7" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_line</span>(<span class="at">data =</span> plot_conf, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> fit)) <span class="sc">+</span> </span>
<span id="cb376-8"><a href="09-linear_model2.html#cb376-8" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_ribbon</span>(<span class="at">data =</span> plot_conf, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">ymax =</span> upr, <span class="at">ymin =</span> lwr), <span class="at">alpha =</span> <span class="fl">0.4</span>) </span></code></pre></div>
<p><img src="Data-Analysis-for-Psychology_files/figure-html/unnamed-chunk-207-1.png" width="672" /></p>
<p>予測変数<code>x</code>の傾きはほぼフラットで、<code>y</code>に対してあまり効果がないようにみえる。</p>
<p>しかし、このデータ<code>d</code>にはもう一つ性別を意味する<code>gender</code>という変数が含まれていた。<code>gender</code>を区別して、また<code>x</code>と<code>y</code>の散布図を見てみよう。</p>
<div class="sourceCode" id="cb377"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb377-1"><a href="09-linear_model2.html#cb377-1" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb377-2"><a href="09-linear_model2.html#cb377-2" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(<span class="at">data =</span> d, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">shape =</span> gender, <span class="at">color=</span>gender), <span class="at">size =</span> <span class="dv">3</span>) </span></code></pre></div>
<p><img src="Data-Analysis-for-Psychology_files/figure-html/unnamed-chunk-208-1.png" width="672" /></p>
<p>性別が女性（F）か男性（M）かで、<code>x</code>と<code>y</code>の関係が違うようである。<br />
このように、別の変数との組み合わせにより、変数間の関係が変化することを<strong>交互作用(interaction)</strong>という。このデータでも、応答変数<code>y</code>に対して性別<code>gender</code>と<code>x</code>の交互作用がありそうである。</p>
<p>交互作用のあるモデルは、以下のように表現する。</p>
<p><span class="math display">\[
\begin{equation}
  \mu = \alpha + \beta_{1} x + \beta_{2} M + \beta_{3} xM  \\ \tag{5}
  y \sim \text{Normal}(\mu, \sigma)
\end{equation}
\]</span></p>
<p><span class="math inline">\(M\)</span>は性別<code>gender</code>のダミー変数で、<code>M</code>（男性）ならば1、<code>F</code>（女性）ならば0の変数とする。<br />
線形モデルでは、<strong>交互作用は予測変数同士の積</strong>で扱う。男性（M=1）の場合のyの推定値は、<span class="math inline">\(\alpha +(\beta_{1} + \beta_{3}) x +\beta_{2}\)</span>となる。一方、女性（M=0）の場合は、<span class="math inline">\(\alpha +\beta_{1} x\)</span>となる。<span class="math inline">\(\beta_{3}\)</span>は、男性のときの<span class="math inline">\(x\)</span>に係る傾きの変化量を意味することになる。このように、交互作用を考慮する予測変数の積をモデルに加えることで、男性か女性かで切片及び傾きが変化することを表現できる。</p>
<div class="sourceCode" id="cb378"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb378-1"><a href="09-linear_model2.html#cb378-1" tabindex="-1"></a>d<span class="sc">$</span>M <span class="ot">=</span> <span class="fu">ifelse</span>(d<span class="sc">$</span>gender <span class="sc">==</span> <span class="st">&quot;M&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>) <span class="co">#genderがMならば1, Fならば1のダミー変数を作る</span></span>
<span id="cb378-2"><a href="09-linear_model2.html#cb378-2" tabindex="-1"></a>result <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">data =</span> d, y <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> x<span class="sc">*</span>M)</span>
<span id="cb378-3"><a href="09-linear_model2.html#cb378-3" tabindex="-1"></a><span class="fu">summary</span>(result)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ 1 + x * M, data = d)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -2.3555 -0.6534  0.2205  0.5636  1.6618 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  0.05079    0.53625   0.095    0.925    
## x           -0.53691    0.08107  -6.622 1.03e-07 ***
## M            1.04827    0.73745   1.421    0.164    
## x:M          0.77868    0.11274   6.907 4.35e-08 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.8827 on 36 degrees of freedom
## Multiple R-squared:  0.9307, Adjusted R-squared:  0.9249 
## F-statistic: 161.1 on 3 and 36 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>2つの予測変数の積の傾き（<span class="math inline">\(\beta_{3}\)</span>）は、<code>x:M</code>である。p値も小さく、有意な効果を持っているようである。</p>
<p>ここで注意が必要なのは、交互作用を含む線形モデルの係数は解釈が複雑になることである。</p>
<p>男性(M = 1)の予測値は、線形モデルの式に推定された傾きと切片及び<span class="math inline">\(M=1\)</span>を代入して、(0.05 + 1.05) + (-0.54 + 0.78) <span class="math inline">\(x\)</span> となる。女性(M = 0)の場合は、0.05 -0.54 <span class="math inline">\(x\)</span> となる。</p>
<p><code>x</code>と<code>M</code>の傾きの推定値は、<code>x</code>や<code>M</code>の全体としての効果、いわゆる<strong>主効果を必ずしも反映しない</strong>。</p>
<p>交互作用効果が見られた場合は、解釈は慎重に行う必要がある。</p>
<p>サンプルデータについて、推定されたパラメータを元に、男女別に線形モデルの直線の信頼区間を図示したのが以下の図である。</p>
<div class="sourceCode" id="cb380"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb380-1"><a href="09-linear_model2.html#cb380-1" tabindex="-1"></a>new_x <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">10</span>,<span class="fl">0.1</span>)</span>
<span id="cb380-2"><a href="09-linear_model2.html#cb380-2" tabindex="-1"></a>newdat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">rep</span>(new_x,<span class="dv">2</span>), <span class="at">M =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>,<span class="fu">length</span>(new_x)), <span class="fu">rep</span>(<span class="dv">1</span>,<span class="fu">length</span>(new_x))))</span>
<span id="cb380-3"><a href="09-linear_model2.html#cb380-3" tabindex="-1"></a>result_conf <span class="ot">=</span> <span class="fu">predict</span>(result, <span class="at">new =</span> newdat, <span class="at">interval =</span> <span class="st">&quot;confidence&quot;</span>, <span class="at">level =</span> <span class="fl">0.95</span>)</span>
<span id="cb380-4"><a href="09-linear_model2.html#cb380-4" tabindex="-1"></a>plot_conf <span class="ot">=</span> <span class="fu">data.frame</span>(newdat, result_conf)</span>
<span id="cb380-5"><a href="09-linear_model2.html#cb380-5" tabindex="-1"></a>plot_conf<span class="sc">$</span>gender <span class="ot">=</span> <span class="fu">ifelse</span>(plot_conf<span class="sc">$</span>M <span class="sc">==</span> <span class="dv">1</span>, <span class="st">&quot;M&quot;</span>, <span class="st">&quot;F&quot;</span>)</span>
<span id="cb380-6"><a href="09-linear_model2.html#cb380-6" tabindex="-1"></a></span>
<span id="cb380-7"><a href="09-linear_model2.html#cb380-7" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb380-8"><a href="09-linear_model2.html#cb380-8" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(<span class="at">data =</span> d, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">shape =</span> gender, <span class="at">color=</span>gender), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb380-9"><a href="09-linear_model2.html#cb380-9" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_line</span>(<span class="at">data =</span> plot_conf, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> fit, <span class="at">color=</span>gender)) <span class="sc">+</span> </span>
<span id="cb380-10"><a href="09-linear_model2.html#cb380-10" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_ribbon</span>(<span class="at">data =</span> plot_conf, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">ymax =</span> upr, <span class="at">ymin =</span> lwr, <span class="at">color =</span>gender), <span class="at">alpha =</span> <span class="fl">0.4</span>) </span></code></pre></div>
<p><img src="Data-Analysis-for-Psychology_files/figure-html/unnamed-chunk-210-1.png" width="672" /></p>
</div>
</div>
<div id="変数の標準化" class="section level2 hasAnchor" number="10.6">
<h2><span class="header-section-number">10.6</span> 変数の標準化<a href="09-linear_model2.html#変数の標準化" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>先述のように、交互作用を含むモデルの場合は、交互作用以外の項の解釈が複雑になる。</p>
<p>これへの対処として、解析に使う予測変数及び応答変数を事前に<strong>標準化(standardizing)</strong>しておくという手がある。標準化とは、元の値を「ゼロが平均値、1が標準偏差」になるように値を変換する処理のことをいう。</p>
<p>変数を標準化しておくと、回帰分析の係数の解釈が直感的に理解しやすくなる。</p>
<p>例えば、前の章で<code>iris</code>データを使って以下の線形モデルの解析を行った。</p>
<div class="sourceCode" id="cb381"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb381-1"><a href="09-linear_model2.html#cb381-1" tabindex="-1"></a>dat <span class="ot">=</span> iris <span class="co">#irisをdatという別の名前で保存</span></span>
<span id="cb381-2"><a href="09-linear_model2.html#cb381-2" tabindex="-1"></a>result <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">data =</span> dat, Petal.Length <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> Sepal.Length)</span>
<span id="cb381-3"><a href="09-linear_model2.html#cb381-3" tabindex="-1"></a><span class="fu">summary</span>(result)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Petal.Length ~ 1 + Sepal.Length, data = dat)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2.47747 -0.59072 -0.00668  0.60484  2.49512 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  -7.10144    0.50666  -14.02   &lt;2e-16 ***
## Sepal.Length  1.85843    0.08586   21.65   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.8678 on 148 degrees of freedom
## Multiple R-squared:   0.76,  Adjusted R-squared:  0.7583 
## F-statistic: 468.6 on 1 and 148 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>切片の値は<code>Sepal.Length</code>がゼロのときの<code>Petal.Length</code>の予測値である。しかし、アヤメのがくの長さがマイナスやゼロの値を取るというのはありえないので、この結果はどのように解釈すればよいのか困る。</p>
<p>標準化した変数を使って同じ解析をしたときの結果と比較してみる。具体的には、元の得点から<strong>平均値を引いて</strong>差の得点を求め、その差の得点を<strong>標準偏差で割る</strong>。</p>
<div class="sourceCode" id="cb383"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb383-1"><a href="09-linear_model2.html#cb383-1" tabindex="-1"></a>dat<span class="sc">$</span>Petal.Length_std <span class="ot">=</span> (dat<span class="sc">$</span>Petal.Length <span class="sc">-</span> <span class="fu">mean</span>(dat<span class="sc">$</span>Petal.Length, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">/</span> <span class="fu">sd</span>(dat<span class="sc">$</span>Petal.Length, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb383-2"><a href="09-linear_model2.html#cb383-2" tabindex="-1"></a>dat<span class="sc">$</span>Sepal.Length_std <span class="ot">=</span> (dat<span class="sc">$</span>Sepal.Length <span class="sc">-</span> <span class="fu">mean</span>(dat<span class="sc">$</span>Sepal.Length, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">/</span> <span class="fu">sd</span>(dat<span class="sc">$</span>Sepal.Length, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb383-3"><a href="09-linear_model2.html#cb383-3" tabindex="-1"></a></span>
<span id="cb383-4"><a href="09-linear_model2.html#cb383-4" tabindex="-1"></a>result_std <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">data =</span> dat, Petal.Length_std <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> Sepal.Length_std)</span>
<span id="cb383-5"><a href="09-linear_model2.html#cb383-5" tabindex="-1"></a><span class="fu">summary</span>(result_std)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Petal.Length_std ~ 1 + Sepal.Length_std, data = dat)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.40343 -0.33463 -0.00379  0.34263  1.41343 
## 
## Coefficients:
##                   Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)      1.333e-16  4.014e-02    0.00        1    
## Sepal.Length_std 8.718e-01  4.027e-02   21.65   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.4916 on 148 degrees of freedom
## Multiple R-squared:   0.76,  Adjusted R-squared:  0.7583 
## F-statistic: 468.6 on 1 and 148 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>係数の値が、変わっている。切片は0、<code>Sepal.Length</code>の効果は0.87である。切片の値は、<code>Sepal.Length_std</code>がゼロのとき（つまり<code>Sepal.Length</code>が平均値と等しいとき）、<code>Petal.Length_std</code>はほぼゼロの値を取る（つまり<code>Petal.Length</code>の平均値）ことを意味している。また、<code>Sepal.Length_std</code>の傾きは、<code>Sepal.Length_std</code>が1のとき（つまり<code>Sepal.Length</code>が1標準偏差分増加したとき）、<code>Petal.Length_std</code>が0.87増えることを意味する。</p>
<p>交互作用を含むモデルの場合、変数を標準化しておくと結果がどう変化するかを確認する。</p>
<div class="sourceCode" id="cb385"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb385-1"><a href="09-linear_model2.html#cb385-1" tabindex="-1"></a><span class="co">#データを再度作成する。</span></span>
<span id="cb385-2"><a href="09-linear_model2.html#cb385-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb385-3"><a href="09-linear_model2.html#cb385-3" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">runif</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">min =</span> <span class="dv">1</span>, <span class="at">max =</span> <span class="dv">10</span>),<span class="dv">0</span>) </span>
<span id="cb385-4"><a href="09-linear_model2.html#cb385-4" tabindex="-1"></a>mu <span class="ot">=</span> <span class="fl">0.1</span> <span class="sc">+</span> <span class="fl">0.4</span> <span class="sc">*</span> x</span>
<span id="cb385-5"><a href="09-linear_model2.html#cb385-5" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">mean =</span> mu, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb385-6"><a href="09-linear_model2.html#cb385-6" tabindex="-1"></a>d_M <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">gender =</span> <span class="st">&quot;M&quot;</span>)</span>
<span id="cb385-7"><a href="09-linear_model2.html#cb385-7" tabindex="-1"></a></span>
<span id="cb385-8"><a href="09-linear_model2.html#cb385-8" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">runif</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">min =</span> <span class="dv">1</span>, <span class="at">max =</span> <span class="dv">10</span>),<span class="dv">0</span>) </span>
<span id="cb385-9"><a href="09-linear_model2.html#cb385-9" tabindex="-1"></a>mu <span class="ot">=</span> <span class="fl">0.3</span> <span class="sc">+</span> <span class="sc">-</span><span class="fl">0.6</span> <span class="sc">*</span> x</span>
<span id="cb385-10"><a href="09-linear_model2.html#cb385-10" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">mean =</span> mu, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb385-11"><a href="09-linear_model2.html#cb385-11" tabindex="-1"></a>d_F <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">gender =</span> <span class="st">&quot;F&quot;</span>)</span>
<span id="cb385-12"><a href="09-linear_model2.html#cb385-12" tabindex="-1"></a></span>
<span id="cb385-13"><a href="09-linear_model2.html#cb385-13" tabindex="-1"></a>d <span class="ot">=</span> <span class="fu">rbind</span>(d_M, d_F)</span>
<span id="cb385-14"><a href="09-linear_model2.html#cb385-14" tabindex="-1"></a>d<span class="sc">$</span>M <span class="ot">=</span> <span class="fu">ifelse</span>(d<span class="sc">$</span>gender <span class="sc">==</span> <span class="st">&quot;M&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>) <span class="co">#genderがMならば1, Fならば1のダミー変数を作る</span></span>
<span id="cb385-15"><a href="09-linear_model2.html#cb385-15" tabindex="-1"></a></span>
<span id="cb385-16"><a href="09-linear_model2.html#cb385-16" tabindex="-1"></a><span class="fu">head</span>(d)</span></code></pre></div>
<pre><code>##   x        y gender M
## 1 3 2.811781      M 1
## 2 4 2.089843      M 1
## 3 6 1.878759      M 1
## 4 9 1.485300      M 1
## 5 3 2.424931      M 1
## 6 9 3.655066      M 1</code></pre>
<div class="sourceCode" id="cb387"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb387-1"><a href="09-linear_model2.html#cb387-1" tabindex="-1"></a><span class="co">#標準化する前の結果</span></span>
<span id="cb387-2"><a href="09-linear_model2.html#cb387-2" tabindex="-1"></a>result <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">data =</span> d, y <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> x<span class="sc">*</span>M)</span>
<span id="cb387-3"><a href="09-linear_model2.html#cb387-3" tabindex="-1"></a><span class="fu">summary</span>(result)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ 1 + x * M, data = d)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -2.3555 -0.6534  0.2205  0.5636  1.6618 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  0.05079    0.53625   0.095    0.925    
## x           -0.53691    0.08107  -6.622 1.03e-07 ***
## M            1.04827    0.73745   1.421    0.164    
## x:M          0.77868    0.11274   6.907 4.35e-08 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.8827 on 36 degrees of freedom
## Multiple R-squared:  0.9307, Adjusted R-squared:  0.9249 
## F-statistic: 161.1 on 3 and 36 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>応答変数と予測変数を標準化する。ダミー変数も標準化する。</p>
<div class="sourceCode" id="cb389"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb389-1"><a href="09-linear_model2.html#cb389-1" tabindex="-1"></a><span class="co">#変数を標準化</span></span>
<span id="cb389-2"><a href="09-linear_model2.html#cb389-2" tabindex="-1"></a>d<span class="sc">$</span>y_s <span class="ot">=</span> (d<span class="sc">$</span>y <span class="sc">-</span> <span class="fu">mean</span>(d<span class="sc">$</span>y, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))<span class="sc">/</span><span class="fu">sd</span>(d<span class="sc">$</span>y, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb389-3"><a href="09-linear_model2.html#cb389-3" tabindex="-1"></a>d<span class="sc">$</span>x_s <span class="ot">=</span> (d<span class="sc">$</span>x <span class="sc">-</span> <span class="fu">mean</span>(d<span class="sc">$</span>x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))<span class="sc">/</span><span class="fu">sd</span>(d<span class="sc">$</span>x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb389-4"><a href="09-linear_model2.html#cb389-4" tabindex="-1"></a>d<span class="sc">$</span>M_s <span class="ot">=</span> (d<span class="sc">$</span>M <span class="sc">-</span> <span class="fu">mean</span>(d<span class="sc">$</span>M, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))<span class="sc">/</span><span class="fu">sd</span>(d<span class="sc">$</span>M, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb389-5"><a href="09-linear_model2.html#cb389-5" tabindex="-1"></a>result <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">data =</span> d, y_s <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> x_s<span class="sc">*</span>M_s)</span>
<span id="cb389-6"><a href="09-linear_model2.html#cb389-6" tabindex="-1"></a><span class="fu">summary</span>(result)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y_s ~ 1 + x_s * M_s, data = d)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.73117 -0.20282  0.06843  0.17496  0.51584 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  0.01209    0.04336   0.279   0.7821    
## x_s         -0.11502    0.04394  -2.618   0.0129 *  
## M_s          0.90526    0.04391  20.615  &lt; 2e-16 ***
## x_s:M_s      0.30734    0.04450   6.907 4.35e-08 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.274 on 36 degrees of freedom
## Multiple R-squared:  0.9307, Adjusted R-squared:  0.9249 
## F-statistic: 161.1 on 3 and 36 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>それぞれの係数とp値が変わった。それぞれの係数の値は、他の変数がゼロのときの応答変数の増減分を意味する、すなわち全ての他変数が平均（=0）であるときのその変数そのものの効果を意味することになる。</p>
<p>変数を標準化する前のモデルでは、男性の場合（M=1）のyの予測値は、「Mの係数+ xとMの交互作用項の係数」であり、Mの係数そのものは性別そのものの効果を意味するものではなかった。<br />
これに対し、標準化した後のモデルでは、Mの係数そのものを「性別の平均的効果=主効果」として捉えることができる。Mの係数が意味することは、「他の変数がゼロのとき、つまり平均であるときに、Mがプラスに変化したとき（男性であるとき）の応答変数の変化量」を意味しており、性別そのものの平均的効果として直感的に解釈することができる。<br />
交互作用項の係数も、他の変数の効果が一定の場合、Mまたはxが1単位変化したときの応答変数の増分として理解できる。</p>
</div>
<div id="線形モデルを扱う上での問題" class="section level2 hasAnchor" number="10.7">
<h2><span class="header-section-number">10.7</span> 線形モデルを扱う上での問題<a href="09-linear_model2.html#線形モデルを扱う上での問題" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>予測変数を増やせば、他の予測変数を統制することによって、その予測変数が応答変数に及ぼすそのものの効果を検討することができる。ただし、予測変数を加えることで生じる問題もある。以降では、<strong>多重共線性</strong>と<strong>過学習</strong>の問題について触れる。</p>
<div id="多重共線性" class="section level3 hasAnchor" number="10.7.1">
<h3><span class="header-section-number">10.7.1</span> 多重共線性<a href="09-linear_model2.html#多重共線性" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>予測変数同士が非常に強く相関しあっている場合、予測変数の係数の推定結果が信頼できなくなる恐れがある。この問題は、<strong>多重共線性(multicollinearity)</strong>と呼ばれる。</p>
<p>サンプルデータを使って確認してみよう。Rには多重共線性の例として<code>longley</code>というサンプルデータがある。</p>
<div class="sourceCode" id="cb391"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb391-1"><a href="09-linear_model2.html#cb391-1" tabindex="-1"></a><span class="fu">head</span>(longley)</span></code></pre></div>
<pre><code>##      GNP.deflator     GNP Unemployed Armed.Forces Population Year Employed
## 1947         83.0 234.289      235.6        159.0    107.608 1947   60.323
## 1948         88.5 259.426      232.5        145.6    108.632 1948   61.122
## 1949         88.2 258.054      368.2        161.6    109.773 1949   60.171
## 1950         89.5 284.599      335.1        165.0    110.929 1950   61.187
## 1951         96.2 328.975      209.9        309.9    112.075 1951   63.221
## 1952         98.1 346.999      193.2        359.4    113.270 1952   63.639</code></pre>
<p>まず、このデータに入っている変数間の相関を確認してみよう。</p>
<div class="sourceCode" id="cb393"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb393-1"><a href="09-linear_model2.html#cb393-1" tabindex="-1"></a><span class="fu">cor</span>(longley)</span></code></pre></div>
<pre><code>##              GNP.deflator       GNP Unemployed Armed.Forces Population
## GNP.deflator    1.0000000 0.9915892  0.6206334    0.4647442  0.9791634
## GNP             0.9915892 1.0000000  0.6042609    0.4464368  0.9910901
## Unemployed      0.6206334 0.6042609  1.0000000   -0.1774206  0.6865515
## Armed.Forces    0.4647442 0.4464368 -0.1774206    1.0000000  0.3644163
## Population      0.9791634 0.9910901  0.6865515    0.3644163  1.0000000
## Year            0.9911492 0.9952735  0.6682566    0.4172451  0.9939528
## Employed        0.9708985 0.9835516  0.5024981    0.4573074  0.9603906
##                   Year  Employed
## GNP.deflator 0.9911492 0.9708985
## GNP          0.9952735 0.9835516
## Unemployed   0.6682566 0.5024981
## Armed.Forces 0.4172451 0.4573074
## Population   0.9939528 0.9603906
## Year         1.0000000 0.9713295
## Employed     0.9713295 1.0000000</code></pre>
<p><code>Employed</code>を応答変数、<code>GNP.deflator</code>を予測変数としたモデル（model01）と、<code>Employed</code>を応答変数、<code>GNP</code>を予測変数としたモデル（model02）でそれぞれ解析してみよう。</p>
<div class="sourceCode" id="cb395"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb395-1"><a href="09-linear_model2.html#cb395-1" tabindex="-1"></a>model01 <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">data =</span> longley, Employed <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> GNP.deflator)</span>
<span id="cb395-2"><a href="09-linear_model2.html#cb395-2" tabindex="-1"></a><span class="fu">summary</span>(model01)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Employed ~ 1 + GNP.deflator, data = longley)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.68522 -0.44820 -0.07106  0.57166  1.61777 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  33.18917    2.12919   15.59 3.06e-10 ***
## GNP.deflator  0.31597    0.02083   15.17 4.39e-10 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.8706 on 14 degrees of freedom
## Multiple R-squared:  0.9426, Adjusted R-squared:  0.9385 
## F-statistic: 230.1 on 1 and 14 DF,  p-value: 4.389e-10</code></pre>
<div class="sourceCode" id="cb397"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb397-1"><a href="09-linear_model2.html#cb397-1" tabindex="-1"></a>model02 <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">data =</span> longley, Employed <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> GNP)</span>
<span id="cb397-2"><a href="09-linear_model2.html#cb397-2" tabindex="-1"></a><span class="fu">summary</span>(model02)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Employed ~ 1 + GNP, data = longley)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.77958 -0.55440 -0.00944  0.34361  1.44594 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 51.843590   0.681372   76.09  &lt; 2e-16 ***
## GNP          0.034752   0.001706   20.37 8.36e-12 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.6566 on 14 degrees of freedom
## Multiple R-squared:  0.9674, Adjusted R-squared:  0.965 
## F-statistic: 415.1 on 1 and 14 DF,  p-value: 8.363e-12</code></pre>
<p>次に、<code>Employed</code>を応答変数、<code>GNP</code>と<code>GNP.deflator</code>の両方を予測変数として入れて解析をしてみよう。</p>
<div class="sourceCode" id="cb399"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb399-1"><a href="09-linear_model2.html#cb399-1" tabindex="-1"></a>model03 <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">data =</span> longley, Employed <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> GNP.deflator <span class="sc">+</span> GNP)</span>
<span id="cb399-2"><a href="09-linear_model2.html#cb399-2" tabindex="-1"></a><span class="fu">summary</span>(model03)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Employed ~ 1 + GNP.deflator + GNP, data = longley)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.81315 -0.54330  0.05572  0.27894  1.40590 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  56.94504    7.44945   7.644 3.67e-06 ***
## GNP.deflator -0.08511    0.12374  -0.688   0.5037    
## GNP           0.04391    0.01343   3.269   0.0061 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.6693 on 13 degrees of freedom
## Multiple R-squared:  0.9685, Adjusted R-squared:  0.9637 
## F-statistic:   200 on 2 and 13 DF,  p-value: 1.727e-10</code></pre>
<p>それぞれの予測変数の係数を見てみると、一つずつ予測変数として入れたときと比べて値が変わっており、p値も低くなっている。</p>
<p><code>GNP</code>と<code>GNP.deflator</code>同士は相関係数0.99とかなり強く相関している。このように、強く相関し合う変数を入れると係数の効果について信頼できる結果が得られなくなってしまう。</p>
<p>なぜ強く相関しあっている変数を入れるとまずいのか？モデルから考えてみよう。</p>
<p><span class="math display">\[
\begin{equation}
  \mu = \alpha + \beta_{1} x_{1} + \beta_{2} x_{2} \\ \tag{6}
\end{equation}
\]</span></p>
<p>2つの予測変数<span class="math inline">\(x_{1}\)</span>と<span class="math inline">\(x_{2}\)</span>が強く相関している場合、つまり<span class="math inline">\(x_{1}=x_{2}\)</span>だとすると、式(6)は以下のように置き換えることができる。</p>
<p><span class="math display">\[
\begin{equation}
  \mu = \alpha + (\beta_{1} + \beta_{2}) x_{1} \\ \tag{7}
\end{equation}
\]</span></p>
<p><span class="math inline">\((\beta_{1} + \beta_{2})\)</span>について、パラメータ<span class="math inline">\(\beta_{1}\)</span>と<span class="math inline">\(\beta_{2}\)</span>の組み合わせは無限に考えられる。このように、強く相関する予測変数を入れると２つの予測変数のパラメータについて推定することが難しくなってしまう（パラメータの信頼区間が大きくなってしまう）。</p>
<div id="多重共線性への対処" class="section level4 unnumbered hasAnchor">
<h4>多重共線性への対処<a href="09-linear_model2.html#多重共線性への対処" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>多重共線性の対策として、<strong>VIF(variance inflation factor)</strong>という指標がよく用いられる。一般的に、<span class="math inline">\(VIF &gt; 10\)</span>の場合は、多重共線性を疑った方が良いといわれている。VIFの高い変数同士のうちどちらか一方を予測変数から除くといった対処をして、解析し直してみるのが良い。</p>
<p><code>performance</code>パッケージの<code>check_collinearity()</code>関数を使えば、VIFを確認することができる。</p>
<div class="sourceCode" id="cb401"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb401-1"><a href="09-linear_model2.html#cb401-1" tabindex="-1"></a><span class="fu">library</span>(performance)</span>
<span id="cb401-2"><a href="09-linear_model2.html#cb401-2" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">check_collinearity</span>(model03)</span></code></pre></div>
<pre><code>## # Check for Multicollinearity
## 
## High Correlation
## 
##          Term   VIF      VIF 95% CI Increased SE Tolerance Tolerance 95% CI
##  GNP.deflator 59.70 [30.69, 117.04]         7.73      0.02     [0.01, 0.03]
##           GNP 59.70 [30.69, 117.04]         7.73      0.02     [0.01, 0.03]</code></pre>
</div>
</div>
<div id="過学習" class="section level3 hasAnchor" number="10.7.2">
<h3><span class="header-section-number">10.7.2</span> 過学習<a href="09-linear_model2.html#過学習" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>以下のプログラムを実行して、サンプルデータ<code>d</code>を作成しよう。</p>
<div class="sourceCode" id="cb403"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb403-1"><a href="09-linear_model2.html#cb403-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10</span>)</span>
<span id="cb403-2"><a href="09-linear_model2.html#cb403-2" tabindex="-1"></a></span>
<span id="cb403-3"><a href="09-linear_model2.html#cb403-3" tabindex="-1"></a>N <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb403-4"><a href="09-linear_model2.html#cb403-4" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">1</span>,N,<span class="dv">1</span>)</span>
<span id="cb403-5"><a href="09-linear_model2.html#cb403-5" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">runif</span>(N, <span class="at">min =</span> <span class="dv">1</span>, <span class="at">max =</span> <span class="dv">5</span>)</span>
<span id="cb403-6"><a href="09-linear_model2.html#cb403-6" tabindex="-1"></a>d <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)</span>
<span id="cb403-7"><a href="09-linear_model2.html#cb403-7" tabindex="-1"></a><span class="fu">str</span>(d)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    10 obs. of  2 variables:
##  $ x: num  1 2 3 4 5 6 7 8 9 10
##  $ y: num  3.03 2.23 2.71 3.77 1.34 ...</code></pre>
<div class="sourceCode" id="cb405"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb405-1"><a href="09-linear_model2.html#cb405-1" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb405-2"><a href="09-linear_model2.html#cb405-2" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(<span class="at">data =</span>d, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y =</span> y))</span></code></pre></div>
<p><img src="Data-Analysis-for-Psychology_files/figure-html/unnamed-chunk-221-1.png" width="672" /></p>
<p>このデータについて、以下の線形モデルを当てはめ、パラメータを推定しよう。図に線形モデルの直線及び信頼区間を図示するところまでやってみる。</p>
<p><span class="math display">\[
\begin{equation}
  \mu = \alpha + \beta_{1} x\\ \tag{8}
\end{equation}
\]</span></p>
<div class="sourceCode" id="cb406"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb406-1"><a href="09-linear_model2.html#cb406-1" tabindex="-1"></a>result_1 <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">data =</span> d, y <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> x)</span>
<span id="cb406-2"><a href="09-linear_model2.html#cb406-2" tabindex="-1"></a></span>
<span id="cb406-3"><a href="09-linear_model2.html#cb406-3" tabindex="-1"></a>newdat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x)</span>
<span id="cb406-4"><a href="09-linear_model2.html#cb406-4" tabindex="-1"></a>conf.int_1 <span class="ot">=</span> <span class="fu">predict</span>(result_1, <span class="at">newdata =</span> newdat, <span class="at">interval =</span> <span class="st">&quot;confidence&quot;</span>, <span class="at">level =</span> <span class="fl">0.95</span>)</span>
<span id="cb406-5"><a href="09-linear_model2.html#cb406-5" tabindex="-1"></a>conf_dat <span class="ot">=</span> <span class="fu">data.frame</span>(d, newdat, conf.int_1)</span>
<span id="cb406-6"><a href="09-linear_model2.html#cb406-6" tabindex="-1"></a></span>
<span id="cb406-7"><a href="09-linear_model2.html#cb406-7" tabindex="-1"></a></span>
<span id="cb406-8"><a href="09-linear_model2.html#cb406-8" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb406-9"><a href="09-linear_model2.html#cb406-9" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(<span class="at">data =</span> conf_dat, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y))<span class="sc">+</span></span>
<span id="cb406-10"><a href="09-linear_model2.html#cb406-10" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_line</span>(<span class="at">data =</span> conf_dat, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> fit)) <span class="sc">+</span></span>
<span id="cb406-11"><a href="09-linear_model2.html#cb406-11" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_ribbon</span>(<span class="at">data =</span> conf_dat, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">ymin =</span> lwr, <span class="at">ymax =</span> upr), <span class="at">alpha =</span><span class="fl">0.2</span>)</span></code></pre></div>
<p><img src="Data-Analysis-for-Psychology_files/figure-html/unnamed-chunk-222-1.png" width="672" /></p>
<p>直線はほとんど観測値から外れており、当てはまりが悪いようである。</p>
<p>そこで、予測変数を増やして検討してみる。<code>lm()</code>では、予測変数<span class="math inline">\(x\)</span>のn乗を含む多項式のモデルを考慮することも可能である。例えば、以下は3次の多項式の例である。</p>
<p><span class="math display">\[
\begin{equation}
  \mu = \alpha + \beta_{1} x  + \beta_{2} x^{2}  + \beta_{3} x^{3}\\ \tag{9}
\end{equation}
\]</span></p>
<p>n次式のモデルは<strong>多項式回帰</strong>(polynomial regression)と呼ばれる。</p>
<p><code>lm()</code>では、<code>I()</code>の中に書くかたちでn次の予測変数を入れることができる。</p>
<div class="sourceCode" id="cb407"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb407-1"><a href="09-linear_model2.html#cb407-1" tabindex="-1"></a>result_3 <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">data =</span> d, y <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">3</span>))</span></code></pre></div>
<p>同じく、3次の多項式による予測の結果を図で確認しよう。</p>
<div class="sourceCode" id="cb408"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb408-1"><a href="09-linear_model2.html#cb408-1" tabindex="-1"></a>newdat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x)</span>
<span id="cb408-2"><a href="09-linear_model2.html#cb408-2" tabindex="-1"></a>conf.int_3 <span class="ot">=</span> <span class="fu">predict</span>(result_3, <span class="at">newdata =</span> newdat, <span class="at">interval =</span> <span class="st">&quot;confidence&quot;</span>, <span class="at">level =</span> <span class="fl">0.95</span>)</span>
<span id="cb408-3"><a href="09-linear_model2.html#cb408-3" tabindex="-1"></a>conf_dat <span class="ot">=</span> <span class="fu">data.frame</span>(d, newdat, conf.int_3)</span>
<span id="cb408-4"><a href="09-linear_model2.html#cb408-4" tabindex="-1"></a></span>
<span id="cb408-5"><a href="09-linear_model2.html#cb408-5" tabindex="-1"></a></span>
<span id="cb408-6"><a href="09-linear_model2.html#cb408-6" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb408-7"><a href="09-linear_model2.html#cb408-7" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(<span class="at">data =</span> conf_dat, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y))<span class="sc">+</span></span>
<span id="cb408-8"><a href="09-linear_model2.html#cb408-8" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_line</span>(<span class="at">data =</span> conf_dat, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> fit)) <span class="sc">+</span> </span>
<span id="cb408-9"><a href="09-linear_model2.html#cb408-9" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_ribbon</span>(<span class="at">data =</span> conf_dat, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">ymin =</span> lwr, <span class="at">ymax =</span> upr), <span class="at">alpha =</span><span class="fl">0.2</span>)</span></code></pre></div>
<p><img src="Data-Analysis-for-Psychology_files/figure-html/unnamed-chunk-224-1.png" width="672" /></p>
<p>9次の式でも推定してみよう。</p>
<div class="sourceCode" id="cb409"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb409-1"><a href="09-linear_model2.html#cb409-1" tabindex="-1"></a>result_9 <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">data =</span> d, y <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">3</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">4</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">5</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">6</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">7</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">8</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">9</span>))</span>
<span id="cb409-2"><a href="09-linear_model2.html#cb409-2" tabindex="-1"></a></span>
<span id="cb409-3"><a href="09-linear_model2.html#cb409-3" tabindex="-1"></a></span>
<span id="cb409-4"><a href="09-linear_model2.html#cb409-4" tabindex="-1"></a>newdat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x)</span>
<span id="cb409-5"><a href="09-linear_model2.html#cb409-5" tabindex="-1"></a>conf.int_9 <span class="ot">=</span> <span class="fu">predict</span>(result_9, <span class="at">newdata =</span> newdat, <span class="at">interval =</span> <span class="st">&quot;confidence&quot;</span>, <span class="at">level =</span> <span class="fl">0.95</span>)</span>
<span id="cb409-6"><a href="09-linear_model2.html#cb409-6" tabindex="-1"></a>conf_dat <span class="ot">=</span> <span class="fu">data.frame</span>(d, newdat, conf.int_9)</span>
<span id="cb409-7"><a href="09-linear_model2.html#cb409-7" tabindex="-1"></a></span>
<span id="cb409-8"><a href="09-linear_model2.html#cb409-8" tabindex="-1"></a></span>
<span id="cb409-9"><a href="09-linear_model2.html#cb409-9" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb409-10"><a href="09-linear_model2.html#cb409-10" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(<span class="at">data =</span> conf_dat, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y))<span class="sc">+</span></span>
<span id="cb409-11"><a href="09-linear_model2.html#cb409-11" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_line</span>(<span class="at">data =</span> conf_dat, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> fit)) <span class="sc">+</span> </span>
<span id="cb409-12"><a href="09-linear_model2.html#cb409-12" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_ribbon</span>(<span class="at">data =</span> conf_dat, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">ymin =</span> lwr, <span class="at">ymax =</span> upr), <span class="at">alpha =</span><span class="fl">0.2</span>)</span></code></pre></div>
<p><img src="Data-Analysis-for-Psychology_files/figure-html/unnamed-chunk-225-1.png" width="672" /></p>
<p>線は全てのデータ点を通っている。当然ながら、データの観測値の分だけパラメータがあれば、そのモデルはデータ点を全て通る線を引くことができる。現在のデータ点全てを予測することができる。</p>
<p>しかし、そのモデルは現在のデータを全て当てられても、<em>将来得られる未知のデータを当てられるとは限らない</em>。予測変数を多くすると現在のデータには当てはまるが、当てはまりすぎて未知のデータの予測力が低下してしまうことを、<strong>過学習(overfitting)</strong>という。</p>
<p>複雑なモデルが現在のデータによく当てはまるのは、ある意味当然である（単なる偶然で生じた誤差も無駄に説明してしまっている）。しかし、複雑なモデルは現在のデータに当てはまっても、未知のデータにもうまく当てはまるとは限らない。</p>
<p>理想的なモデルは、「<strong>予測力が高く、かつ予測変数ができるだけ少なくてシンプルなモデル</strong>」となる。</p>
</div>
</div>
<div id="モデルの予測力の評価" class="section level2 hasAnchor" number="10.8">
<h2><span class="header-section-number">10.8</span> モデルの予測力の評価<a href="09-linear_model2.html#モデルの予測力の評価" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>モデルの予測力を評価するために使われる指標について説明する。</p>
<div id="決定係数" class="section level3 hasAnchor" number="10.8.1">
<h3><span class="header-section-number">10.8.1</span> 決定係数<a href="09-linear_model2.html#決定係数" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>線形モデルでは、データに対する回帰分析のモデルの予測力を表す指標として、<strong>決定係数</strong>（R-squared）がある。</p>
<p>サンプルデータ<code>attitude</code>を例に見てみよう。</p>
<div class="sourceCode" id="cb410"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb410-1"><a href="09-linear_model2.html#cb410-1" tabindex="-1"></a>model_01 <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">data=</span>attitude, rating <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> complaints <span class="sc">+</span> learning)</span>
<span id="cb410-2"><a href="09-linear_model2.html#cb410-2" tabindex="-1"></a><span class="fu">summary</span>(model_01)<span class="sc">$</span>r.squared <span class="co">#r.squaredで決定係数のみを取り出すことができる。</span></span></code></pre></div>
<pre><code>## [1] 0.7080152</code></pre>
<p>これは、モデルから求めた予測値と実測値の分散が、実際のデータの分散に占める割合を意味する指標である。つまり、そのモデルでどれだけ全データの分散を説明できているかを意味する。</p>
<p><span class="math display">\[
R^2 = \sum_{i=1}^{n} \frac {(y_{i}-\mu_{i})^2}{(y_{i}-\bar{y})^2} \tag{10}
\]</span></p>
<p>ただし、決定係数は単純に、予測変数が増えるほど大きくなる（説明できる分散の量が増える）。</p>
<p>例えば<code>attitude</code>データ内の全ての変数を予測変数に使ってみる。</p>
<div class="sourceCode" id="cb412"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb412-1"><a href="09-linear_model2.html#cb412-1" tabindex="-1"></a>model_full <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">data=</span>attitude, rating <span class="sc">~</span> .) <span class="co">#線形予測子を入力するところにドットを入力すると、そのデータに含まれる全ての変数を予測変数として扱う</span></span>
<span id="cb412-2"><a href="09-linear_model2.html#cb412-2" tabindex="-1"></a><span class="fu">summary</span>(model_full)<span class="sc">$</span>r.squared </span></code></pre></div>
<pre><code>## [1] 0.732602</code></pre>
<p>応答変数に影響を及ぼさない変数を含めても、決定係数は上昇してしまう。</p>
<p>決定係数は、「予測力が高く、シンプルなモデル」を探すには常に適切な指標であるとは言えない。</p>
</div>
<div id="赤池情報量規準aic" class="section level3 hasAnchor" number="10.8.2">
<h3><span class="header-section-number">10.8.2</span> 赤池情報量規準（AIC）<a href="09-linear_model2.html#赤池情報量規準aic" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>モデルのシンプルさ（予測変数の少なさ）とモデルの予測力とのバランスを取った指標の一つとして、<strong>赤池情報量規準(Akaike inoformation criteria: AIC)</strong>がよく知られている。AICは以下の式で計算される。</p>
<p><span class="math display">\[
AIC = -2 \log L + 2k \tag{11}\\
\]</span></p>
<p><span class="math inline">\(\log L\)</span>は最大対数尤度、<span class="math inline">\(k\)</span>はモデルのパラメータ数である。</p>
<p>第9章で、モデルのパラメータを推定する方法として「最尤法」を紹介した。最尤法は、モデルのもっともらしさ（データが生じる確率）を意味する「対数尤度」が最大となるときのパラメータを求める方法であった。最大対数尤度は、現在のモデルに対する当てはまりの良さを反映している。その最大対数尤度に対し、パラメータ数<span class="math inline">\(k\)</span>に応じてペナルティ(penalty term)を加える。</p>
<p><strong>AICの値が低いほど</strong>、モデルの予測力が高いと評価する。AICは余計なパラメータが多くなる（<span class="math inline">\(k\)</span>が大きくなる）ほど大きい値を取る。つまり、データをうまく予測しつつ、かつパラメータ数を抑えてシンプルなモデルを探る目的にかなっている。</p>
<p><code>AIC()</code>関数でモデルをカッコ内に入れると、AICを算出してくれる。さきほどの<code>attitude</code>に当てはめた2つのモデルのAICを見てみよう。</p>
<div class="sourceCode" id="cb414"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb414-1"><a href="09-linear_model2.html#cb414-1" tabindex="-1"></a><span class="fu">AIC</span>(model_full)</span></code></pre></div>
<pre><code>## [1] 210.4998</code></pre>
<div class="sourceCode" id="cb416"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb416-1"><a href="09-linear_model2.html#cb416-1" tabindex="-1"></a><span class="fu">AIC</span>(model_01)</span></code></pre></div>
<pre><code>## [1] 205.1387</code></pre>
<p><code>model_full</code>よりも<code>model_01</code>のAICが低く、<code>model_01</code>の予想力の方が高いことを示している。</p>
</div>
</div>
<div id="確認問題-7" class="section level2 unnumbered hasAnchor">
<h2>確認問題<a href="09-linear_model2.html#確認問題-7" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="問1" class="section level3 unnumbered hasAnchor">
<h3>問1<a href="09-linear_model2.html#問1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Rで標準で入っているデータ<code>warpbreaks</code>を使って練習をする。</p>
<div class="sourceCode" id="cb418"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb418-1"><a href="09-linear_model2.html#cb418-1" tabindex="-1"></a>prac_dat_1 <span class="ot">=</span> warpbreaks <span class="co">#別の名前で保存する</span></span>
<span id="cb418-2"><a href="09-linear_model2.html#cb418-2" tabindex="-1"></a></span>
<span id="cb418-3"><a href="09-linear_model2.html#cb418-3" tabindex="-1"></a><span class="fu">head</span>(prac_dat_1)</span></code></pre></div>
<pre><code>##   breaks wool tension
## 1     26    A       L
## 2     30    A       L
## 3     54    A       L
## 4     25    A       L
## 5     70    A       L
## 6     52    A       L</code></pre>
<div class="sourceCode" id="cb420"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb420-1"><a href="09-linear_model2.html#cb420-1" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb420-2"><a href="09-linear_model2.html#cb420-2" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_boxplot</span>(<span class="at">data =</span> prac_dat_1, <span class="fu">aes</span>(<span class="at">x =</span> wool, <span class="at">y =</span> breaks))</span></code></pre></div>
<p><img src="Data-Analysis-for-Psychology_files/figure-html/unnamed-chunk-229-1.png" width="672" /></p>
<div class="sourceCode" id="cb421"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb421-1"><a href="09-linear_model2.html#cb421-1" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb421-2"><a href="09-linear_model2.html#cb421-2" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_boxplot</span>(<span class="at">data =</span> prac_dat_1, <span class="fu">aes</span>(<span class="at">x =</span> tension, <span class="at">y =</span> breaks))</span></code></pre></div>
<p><img src="Data-Analysis-for-Psychology_files/figure-html/unnamed-chunk-229-2.png" width="672" /></p>
<div id="section" class="section level4 unnumbered hasAnchor">
<h4>1-1<a href="09-linear_model2.html#section" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>変数<code>wool</code>について, 「<code>A</code>を1, それ以外を0」としたダミー変数を作成し、そのダミー変数を予測変数、<code>breaks</code>を応答変数として線形モデルを行い、切片及びダミー変数に係る傾きの推定値を報告せよ。</p>
<p>また、ダミー変数の傾きの推定値からどのような結論が導かれるかを述べよ。</p>
</div>
<div id="section-1" class="section level4 unnumbered hasAnchor">
<h4>1-2<a href="09-linear_model2.html#section-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>変数<code>tension</code>について, 「<code>L</code>を1, それ以外を0」、「<code>M</code>を1, それ以外を0」とした2種類のダミー変数を作成し、それら2つのダミー変数を予測変数、<code>breaks</code>を応答変数として線形モデルを行い、切片及び各ダミー変数に係る傾きの推定値を報告せよ。<br />
更に、そのときの切片及び各ダミー変数の係数が意味することを説明せよ。</p>
</div>
<div id="section-2" class="section level4 unnumbered hasAnchor">
<h4>1-3<a href="09-linear_model2.html#section-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>1-2で作ったダミー変数に加え、更に「<code>H</code>を1, それ以外を0」としたダミー変数を追加で作成する。<br />
更に、<code>breaks</code>から全体の<code>breaks</code>の平均を引いた変数<code>breaks_2</code>を作成する。</p>
<p>それら3つのダミー変数を予測変数、<code>breaks_2</code>を応答変数として線形モデルを行い、各ダミー変数に係る傾きの推定値を報告せよ。ただし、モデルには切片の項は加えないものとする。</p>
<p>更に、そのときの各ダミー変数の係数が意味することを説明せよ。</p>
</div>
</div>
<div id="問2" class="section level3 unnumbered hasAnchor">
<h3>問2<a href="09-linear_model2.html#問2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>問1に引き続き、Rで標準で入っているデータ<code>warpbreaks</code>を使って練習をする。ただし、<code>tension</code>が<code>H</code>の部分を除いたデータを用いる。</p>
<div class="sourceCode" id="cb422"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb422-1"><a href="09-linear_model2.html#cb422-1" tabindex="-1"></a>prac_dat_2 <span class="ot">=</span> <span class="fu">subset</span>(warpbreaks, tension <span class="sc">!=</span> <span class="st">&quot;H&quot;</span>) <span class="co">#tension == Hは除き、別の名前で保存する</span></span>
<span id="cb422-2"><a href="09-linear_model2.html#cb422-2" tabindex="-1"></a></span>
<span id="cb422-3"><a href="09-linear_model2.html#cb422-3" tabindex="-1"></a><span class="fu">head</span>(prac_dat_2)</span></code></pre></div>
<pre><code>##   breaks wool tension
## 1     26    A       L
## 2     30    A       L
## 3     54    A       L
## 4     25    A       L
## 5     70    A       L
## 6     52    A       L</code></pre>
<div class="sourceCode" id="cb424"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb424-1"><a href="09-linear_model2.html#cb424-1" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb424-2"><a href="09-linear_model2.html#cb424-2" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_boxplot</span>(<span class="at">data =</span> prac_dat_2, <span class="fu">aes</span>(<span class="at">x =</span> wool, <span class="at">y =</span> breaks, <span class="at">fill =</span> tension))</span></code></pre></div>
<p><img src="Data-Analysis-for-Psychology_files/figure-html/unnamed-chunk-234-1.png" width="672" /></p>
<p>breaksを応答変数、wool, tension, wool及びtensionの交互作用項を予測変数とした線形モデルを行い、切片、woolの傾き、tensionの傾き、交互作用項の推定値を報告せよ。</p>
</div>
<div id="問3" class="section level3 unnumbered hasAnchor">
<h3>問3<a href="09-linear_model2.html#問3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Rで標準で入っている<code>airquality</code>を使う。</p>
<div class="sourceCode" id="cb425"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb425-1"><a href="09-linear_model2.html#cb425-1" tabindex="-1"></a>prac_dat_3 <span class="ot">=</span>  <span class="fu">na.omit</span>(airquality) <span class="co">#欠損値を除き、別の名前で保存する</span></span>
<span id="cb425-2"><a href="09-linear_model2.html#cb425-2" tabindex="-1"></a></span>
<span id="cb425-3"><a href="09-linear_model2.html#cb425-3" tabindex="-1"></a><span class="fu">head</span>(prac_dat_3)</span></code></pre></div>
<pre><code>##   Ozone Solar.R Wind Temp Month Day
## 1    41     190  7.4   67     5   1
## 2    36     118  8.0   72     5   2
## 3    12     149 12.6   74     5   3
## 4    18     313 11.5   62     5   4
## 7    23     299  8.6   65     5   7
## 8    19      99 13.8   59     5   8</code></pre>
<div id="section-3" class="section level4 unnumbered hasAnchor">
<h4>3-1<a href="09-linear_model2.html#section-3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><code>Ozone</code>を応答変数、<code>Solar.R</code>, <code>Wind</code>, <code>Temp</code>の3つを予測変数とした線形モデルを行う。そして、切片及び傾きの推定値を報告せよ。</p>
</div>
<div id="section-4" class="section level4 unnumbered hasAnchor">
<h4>3-2<a href="09-linear_model2.html#section-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>3-1で行った線形モデルについて、決定係数を報告せよ（Multiple R-squared）。</p>
</div>
<div id="section-5" class="section level4 unnumbered hasAnchor">
<h4>3-3<a href="09-linear_model2.html#section-5" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>以下の3種類の線形モデルの解析を行い、<br />
モデル1: <code>Ozone</code>を応答変数、<code>Solar.R</code>, <code>Wind</code>, <code>Temp</code>の3つを予測変数とした線形モデル<br />
モデル2: <code>Ozone</code>を応答変数、<code>Solar.R</code>, <code>Temp</code>の2つを予測変数とした線形モデル<br />
モデル3: <code>Ozone</code>を応答変数、<code>Temp</code>を予測変数とした線形モデル</p>
<p>それぞれのモデルのAICを報告するとともに、3つのモデルのうち予測力が高いと考えられるものはどれかを報告せよ。</p>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="08-linear_model.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="10-glm.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Data-Analysis-for-Psychology.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
},
"toolbar": {
"position": "fixed",
"download": null,
"search": true,
"fontsettings": {
"size": 1
},
"sharing": null
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
