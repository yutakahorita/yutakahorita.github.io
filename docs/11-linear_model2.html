<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 12 線形モデル（t検定, 分散分析, 共分散分析） | 心理データ応用解析法</title>
  <meta name="description" content="Chapter 12 線形モデル（t検定, 分散分析, 共分散分析） | 心理データ応用解析法" />
  <meta name="generator" content="bookdown 0.44 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 12 線形モデル（t検定, 分散分析, 共分散分析） | 心理データ応用解析法" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 12 線形モデル（t検定, 分散分析, 共分散分析） | 心理データ応用解析法" />
  
  
  

<meta name="author" content="帝京大学文学部心理学科　堀田結孝" />


<meta name="date" content="2025-09-28" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="10-linear_model.html"/>
<link rel="next" href="12-glm_logistic.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> はじめに</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#intro_01"><i class="fa fa-check"></i><b>1.1</b> テキストの構成</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="index.html"><a href="index.html#intro_02"><i class="fa fa-check"></i><b>1.1.1</b> テキストの読み方</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="01-intro.html"><a href="01-intro.html"><i class="fa fa-check"></i><b>2</b> Rの使い方</a>
<ul>
<li class="chapter" data-level="2.1" data-path="01-intro.html"><a href="01-intro.html#chap01_R"><i class="fa fa-check"></i><b>2.1</b> Rのインストール</a></li>
<li class="chapter" data-level="2.2" data-path="01-intro.html"><a href="01-intro.html#chap01_RStudio"><i class="fa fa-check"></i><b>2.2</b> RStudioのインストール</a></li>
<li class="chapter" data-level="2.3" data-path="01-intro.html"><a href="01-intro.html#chap01_Programing"><i class="fa fa-check"></i><b>2.3</b> プログラムの書き方</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="01-intro.html"><a href="01-intro.html#chap01_Console"><i class="fa fa-check"></i><b>2.3.1</b> コンソール</a></li>
<li class="chapter" data-level="2.3.2" data-path="01-intro.html"><a href="01-intro.html#chap01_Script"><i class="fa fa-check"></i><b>2.3.2</b> スクリプト</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="01-intro.html"><a href="01-intro.html#chap01_Package"><i class="fa fa-check"></i><b>2.4</b> パッケージ</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="01-intro.html"><a href="01-intro.html#chap01_InstallPackage"><i class="fa fa-check"></i><b>2.4.1</b> パッケージのインストール</a></li>
<li class="chapter" data-level="2.4.2" data-path="01-intro.html"><a href="01-intro.html#chap01_LoadPackage"><i class="fa fa-check"></i><b>2.4.2</b> パッケージのロード</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="01-intro.html"><a href="01-intro.html#chap01_Help"><i class="fa fa-check"></i><b>2.5</b> ヘルプ</a></li>
<li class="chapter" data-level="2.6" data-path="01-intro.html"><a href="01-intro.html#chap01_End"><i class="fa fa-check"></i><b>2.6</b> Rを終わらせる</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="02-data.html"><a href="02-data.html"><i class="fa fa-check"></i><b>3</b> データ</a>
<ul>
<li class="chapter" data-level="3.1" data-path="02-data.html"><a href="02-data.html#chap02_Loading"><i class="fa fa-check"></i><b>3.1</b> はじめに（パッケージのロード）</a></li>
<li class="chapter" data-level="3.2" data-path="02-data.html"><a href="02-data.html#chap02_Programing"><i class="fa fa-check"></i><b>3.2</b> プログラミングの練習</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="02-data.html"><a href="02-data.html#chap02_Comments"><i class="fa fa-check"></i><b>3.2.1</b> コメント文</a></li>
<li class="chapter" data-level="3.2.2" data-path="02-data.html"><a href="02-data.html#chap02_MathIdentifer"><i class="fa fa-check"></i><b>3.2.2</b> 算術識別子</a></li>
<li class="chapter" data-level="3.2.3" data-path="02-data.html"><a href="02-data.html#chap02_LogicalIdentifer"><i class="fa fa-check"></i><b>3.2.3</b> 比較識別子</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="02-data.html"><a href="02-data.html#chap02_Variable"><i class="fa fa-check"></i><b>3.3</b> 変数</a>
<ul>
<li class="chapter" data-level="" data-path=""><a href="#%E5%A4%89%E6%95%B0%E3%81%AE%E4%BD%BF%E3%81%84%E6%96%B9%E3%81%AE%E6%B3%A8%E6%84%8F"><i class="fa fa-check"></i>変数の使い方の注意</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="02-data.html"><a href="02-data.html#chap02_VariableType"><i class="fa fa-check"></i><b>3.4</b> 変数の型</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="02-data.html"><a href="02-data.html#chap02_numeric"><i class="fa fa-check"></i><b>3.4.1</b> 数値型(numeric)</a></li>
<li class="chapter" data-level="3.4.2" data-path="02-data.html"><a href="02-data.html#chap02_character"><i class="fa fa-check"></i><b>3.4.2</b> 文字列(character)</a></li>
<li class="chapter" data-level="3.4.3" data-path="02-data.html"><a href="02-data.html#chap02_date"><i class="fa fa-check"></i><b>3.4.3</b> 日付(date)</a></li>
<li class="chapter" data-level="3.4.4" data-path="02-data.html"><a href="02-data.html#chap02_logical"><i class="fa fa-check"></i><b>3.4.4</b> 論理型(logical)</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="02-data.html"><a href="02-data.html#chap02_Data"><i class="fa fa-check"></i><b>3.5</b> データ構造</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="02-data.html"><a href="02-data.html#chap02_vector"><i class="fa fa-check"></i><b>3.5.1</b> ベクトル</a></li>
<li class="chapter" data-level="3.5.2" data-path="02-data.html"><a href="02-data.html#chap02_dataframe"><i class="fa fa-check"></i><b>3.5.2</b> データフレーム</a></li>
<li class="chapter" data-level="3.5.3" data-path="02-data.html"><a href="02-data.html#chap02_tibble"><i class="fa fa-check"></i><b>3.5.3</b> tibble</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="02-data.html"><a href="02-data.html#chap02_Missing"><i class="fa fa-check"></i><b>3.6</b> 欠損値</a></li>
<li class="chapter" data-level="3.7" data-path="02-data.html"><a href="02-data.html#chap02_ReadingData"><i class="fa fa-check"></i><b>3.7</b> データの読み込み</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="02-data.html"><a href="02-data.html#chap02_WorkingDirectory"><i class="fa fa-check"></i><b>3.7.1</b> ワーキングディレクトリの設定</a></li>
<li class="chapter" data-level="3.7.2" data-path="02-data.html"><a href="02-data.html#chap02_redingfiles"><i class="fa fa-check"></i><b>3.7.2</b> 外部ファイルの読み込み</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="02-data.html"><a href="02-data.html#chap02_WritingData"><i class="fa fa-check"></i><b>3.8</b> データの書き出し</a></li>
<li class="chapter" data-level="3.9" data-path="02-data.html"><a href="02-data.html#chap02_SampleData"><i class="fa fa-check"></i><b>3.9</b> サンプルデータ</a></li>
<li class="chapter" data-level="3.10" data-path="02-data.html"><a href="02-data.html#chap02_Other"><i class="fa fa-check"></i><b>3.10</b> 補足</a>
<ul>
<li class="chapter" data-level="3.10.1" data-path="02-data.html"><a href="02-data.html#chap02_Other1"><i class="fa fa-check"></i><b>3.10.1</b> RStudioの機能でファイルを読み込む</a></li>
<li class="chapter" data-level="3.10.2" data-path="02-data.html"><a href="02-data.html#chap02_Other2"><i class="fa fa-check"></i><b>3.10.2</b> RStudioの機能でワーキングディレクトリを指定する</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="03-summary.html"><a href="03-summary.html"><i class="fa fa-check"></i><b>4</b> 統計学の基礎の復習</a>
<ul>
<li class="chapter" data-level="4.1" data-path="03-summary.html"><a href="03-summary.html#chap03_Scales"><i class="fa fa-check"></i><b>4.1</b> 尺度水準</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="03-summary.html"><a href="03-summary.html#chap03_Continuous"><i class="fa fa-check"></i><b>4.1.1</b> 量的変数</a></li>
<li class="chapter" data-level="4.1.2" data-path="03-summary.html"><a href="03-summary.html#chap03_Category"><i class="fa fa-check"></i><b>4.1.2</b> カテゴリカル変数（質的変数）</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="03-summary.html"><a href="03-summary.html#chap03_Statistics"><i class="fa fa-check"></i><b>4.2</b> 基本統計量</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="03-summary.html"><a href="03-summary.html#chap03_Mean"><i class="fa fa-check"></i><b>4.2.1</b> 代表値</a></li>
<li class="chapter" data-level="4.2.2" data-path="03-summary.html"><a href="03-summary.html#chap03_Variance"><i class="fa fa-check"></i><b>4.2.2</b> 散布度</a></li>
<li class="chapter" data-level="4.2.3" data-path="03-summary.html"><a href="03-summary.html#chap03_Summary"><i class="fa fa-check"></i><b>4.2.3</b> 要約統計量</a></li>
<li class="chapter" data-level="4.2.4" data-path="03-summary.html"><a href="03-summary.html#chap03_Grouping"><i class="fa fa-check"></i><b>4.2.4</b> グループごとの集計</a></li>
<li class="chapter" data-level="4.2.5" data-path="03-summary.html"><a href="03-summary.html#chap03_Table"><i class="fa fa-check"></i><b>4.2.5</b> 表の作り方</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="03-summary.html"><a href="03-summary.html#chap03_Correlations"><i class="fa fa-check"></i><b>4.3</b> 相関(correlation)</a></li>
<li class="chapter" data-level="4.4" data-path="03-summary.html"><a href="03-summary.html#chap03_Practice"><i class="fa fa-check"></i><b>4.4</b> 確認問題</a>
<ul>
<li class="chapter" data-level="" data-path=""><a href="#%E5%95%8F%EF%BC%91"><i class="fa fa-check"></i>問１</a></li>
<li class="chapter" data-level="" data-path=""><a href="#%E5%95%8F%EF%BC%92"><i class="fa fa-check"></i>問２</a></li>
<li class="chapter" data-level="" data-path=""><a href="#%E5%95%8F%EF%BC%93"><i class="fa fa-check"></i>問３</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="04-data.html"><a href="04-data.html"><i class="fa fa-check"></i><b>5</b> データ・ハンドリング</a>
<ul>
<li class="chapter" data-level="5.1" data-path="04-data.html"><a href="04-data.html#chap04_Load"><i class="fa fa-check"></i><b>5.1</b> パッケージのロード</a></li>
<li class="chapter" data-level="5.2" data-path="04-data.html"><a href="04-data.html#chap04_mutate"><i class="fa fa-check"></i><b>5.2</b> 変数の作成</a></li>
<li class="chapter" data-level="5.3" data-path="04-data.html"><a href="04-data.html#chap04_Extract"><i class="fa fa-check"></i><b>5.3</b> データの抽出</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="04-data.html"><a href="04-data.html#chap04_select"><i class="fa fa-check"></i><b>5.3.1</b> 必要な列のみを取り出す（select）</a></li>
<li class="chapter" data-level="5.3.2" data-path="04-data.html"><a href="04-data.html#chap04_filter"><i class="fa fa-check"></i><b>5.3.2</b> 条件に合う行を取り出す（filter）</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="04-data.html"><a href="04-data.html#chap04_pipe"><i class="fa fa-check"></i><b>5.4</b> パイプ</a></li>
<li class="chapter" data-level="5.5" data-path="04-data.html"><a href="04-data.html#chap04_groupby"><i class="fa fa-check"></i><b>5.5</b> グルーピング</a></li>
<li class="chapter" data-level="5.6" data-path="04-data.html"><a href="04-data.html#chap04_pivot"><i class="fa fa-check"></i><b>5.6</b> データの変換</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="04-data.html"><a href="04-data.html#chap04_datatype"><i class="fa fa-check"></i><b>5.6.1</b> wide型とlong型の区別</a></li>
<li class="chapter" data-level="5.6.2" data-path="04-data.html"><a href="04-data.html#chap04_longer"><i class="fa fa-check"></i><b>5.6.2</b> wide型からlong型に変換</a></li>
<li class="chapter" data-level="5.6.3" data-path="04-data.html"><a href="04-data.html#chap04_wider"><i class="fa fa-check"></i><b>5.6.3</b> long型からwide型に変換</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="04-data.html"><a href="04-data.html#chap04_join"><i class="fa fa-check"></i><b>5.7</b> データの結合</a></li>
<li class="chapter" data-level="5.8" data-path="04-data.html"><a href="04-data.html#chap04_Practice"><i class="fa fa-check"></i><b>5.8</b> 確認問題</a>
<ul>
<li class="chapter" data-level="" data-path=""><a href="#%E5%95%8F%EF%BC%91-1"><i class="fa fa-check"></i>問１</a></li>
<li class="chapter" data-level="" data-path=""><a href="#%E5%95%8F%EF%BC%92-1"><i class="fa fa-check"></i>問２</a></li>
<li class="chapter" data-level="" data-path=""><a href="#%E5%95%8F%EF%BC%93-1"><i class="fa fa-check"></i>問３</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="05-graph.html"><a href="05-graph.html"><i class="fa fa-check"></i><b>6</b> データ・ビジュアライゼーション</a>
<ul>
<li class="chapter" data-level="6.1" data-path="05-graph.html"><a href="05-graph.html#chap05_Graphic"><i class="fa fa-check"></i><b>6.1</b> Rのグラフィック関数</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="05-graph.html"><a href="05-graph.html#chap05_plot"><i class="fa fa-check"></i><b>6.1.1</b> plot</a></li>
<li class="chapter" data-level="6.1.2" data-path="05-graph.html"><a href="05-graph.html#chap05_otherplot"><i class="fa fa-check"></i><b>6.1.2</b> その他のグラフ</a></li>
<li class="chapter" data-level="6.1.3" data-path="05-graph.html"><a href="05-graph.html#chap05_saveplots"><i class="fa fa-check"></i><b>6.1.3</b> 図の保存</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="05-graph.html"><a href="05-graph.html#chap05_ggplot2"><i class="fa fa-check"></i><b>6.2</b> ggplot2パッケージ</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="05-graph.html"><a href="05-graph.html#chap05_geompoint"><i class="fa fa-check"></i><b>6.2.1</b> 散布図</a></li>
<li class="chapter" data-level="6.2.2" data-path="05-graph.html"><a href="05-graph.html#chap05_geomhistogram"><i class="fa fa-check"></i><b>6.2.2</b> ヒストグラム</a></li>
<li class="chapter" data-level="6.2.3" data-path="05-graph.html"><a href="05-graph.html#chap05_geomboxplot"><i class="fa fa-check"></i><b>6.2.3</b> 箱ひげ図</a></li>
<li class="chapter" data-level="6.2.4" data-path="05-graph.html"><a href="05-graph.html#chap05_geomviolin"><i class="fa fa-check"></i><b>6.2.4</b> バイオリンプロット</a></li>
<li class="chapter" data-level="6.2.5" data-path="05-graph.html"><a href="05-graph.html#chap05_geomline"><i class="fa fa-check"></i><b>6.2.5</b> 折れ線グラフ</a></li>
<li class="chapter" data-level="6.2.6" data-path="05-graph.html"><a href="05-graph.html#chap05_geomerrorbar"><i class="fa fa-check"></i><b>6.2.6</b> エラーバーつきのグラフ</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="05-graph.html"><a href="05-graph.html#chap05_ggplot2option"><i class="fa fa-check"></i><b>6.3</b> オプション</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="05-graph.html"><a href="05-graph.html#chap05_facet"><i class="fa fa-check"></i><b>6.3.1</b> ファセット（Facet）</a></li>
<li class="chapter" data-level="6.3.2" data-path="05-graph.html"><a href="05-graph.html#chap05_labs"><i class="fa fa-check"></i><b>6.3.2</b> ラベル（labs）</a></li>
<li class="chapter" data-level="6.3.3" data-path="05-graph.html"><a href="05-graph.html#chap05_theme"><i class="fa fa-check"></i><b>6.3.3</b> テーマ（Theme）</a></li>
<li class="chapter" data-level="6.3.4" data-path="05-graph.html"><a href="05-graph.html#chap05_ggsave"><i class="fa fa-check"></i><b>6.3.4</b> 図の保存</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="05-graph.html"><a href="05-graph.html#chap05_ggothers"><i class="fa fa-check"></i><b>6.4</b> 応用的なグラフ</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="05-graph.html"><a href="05-graph.html#chap05_raincloud"><i class="fa fa-check"></i><b>6.4.1</b> Rain-cloud plot</a></li>
<li class="chapter" data-level="6.4.2" data-path="05-graph.html"><a href="05-graph.html#chap05_ridge"><i class="fa fa-check"></i><b>6.4.2</b> Ridge plot</a></li>
<li class="chapter" data-level="6.4.3" data-path="05-graph.html"><a href="05-graph.html#chap05_alluvial"><i class="fa fa-check"></i><b>6.4.3</b> Alluvial plot</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="05-graph.html"><a href="05-graph.html#chap05_otherfunctions"><i class="fa fa-check"></i><b>6.5</b> その他の機能</a></li>
<li class="chapter" data-level="6.6" data-path="05-graph.html"><a href="05-graph.html#chap05_Practice"><i class="fa fa-check"></i><b>6.6</b> 確認問題</a>
<ul>
<li class="chapter" data-level="" data-path=""><a href="#%E5%95%8F%EF%BC%91-2"><i class="fa fa-check"></i>問１</a></li>
<li class="chapter" data-level="" data-path=""><a href="#%E5%95%8F%EF%BC%92-2"><i class="fa fa-check"></i>問２</a></li>
<li class="chapter" data-level="" data-path=""><a href="#%E5%95%8F%EF%BC%93-2"><i class="fa fa-check"></i>問３</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="06-probability_distribution.html"><a href="06-probability_distribution.html"><i class="fa fa-check"></i><b>7</b> 確率分布</a>
<ul>
<li class="chapter" data-level="7.1" data-path="06-probability_distribution.html"><a href="06-probability_distribution.html#chap06_ProbDistribution"><i class="fa fa-check"></i><b>7.1</b> 確率変数と確率分布</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="06-probability_distribution.html"><a href="06-probability_distribution.html#chap06_Discrete"><i class="fa fa-check"></i><b>7.1.1</b> 離散型分布</a></li>
<li class="chapter" data-level="7.1.2" data-path="06-probability_distribution.html"><a href="06-probability_distribution.html#chap06_Continuous"><i class="fa fa-check"></i><b>7.1.2</b> 連続型分布</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="06-probability_distribution.html"><a href="06-probability_distribution.html#chap06_Binomial"><i class="fa fa-check"></i><b>7.2</b> 二項分布</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="06-probability_distribution.html"><a href="06-probability_distribution.html#chap06_BinomStat"><i class="fa fa-check"></i><b>7.2.1</b> 二項分布の期待値と分散</a></li>
<li class="chapter" data-level="7.2.2" data-path="06-probability_distribution.html"><a href="06-probability_distribution.html#chap06_Bernoulli"><i class="fa fa-check"></i><b>7.2.2</b> ベルヌーイ分布</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="06-probability_distribution.html"><a href="06-probability_distribution.html#chap06_Gaussian"><i class="fa fa-check"></i><b>7.3</b> 正規分布</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="06-probability_distribution.html"><a href="06-probability_distribution.html#chap06_Gaussian1"><i class="fa fa-check"></i><b>7.3.1</b> 正規分布の基礎</a></li>
<li class="chapter" data-level="7.3.2" data-path="06-probability_distribution.html"><a href="06-probability_distribution.html#chap06_ProbDensity"><i class="fa fa-check"></i><b>7.3.2</b> 確率密度関数</a></li>
<li class="chapter" data-level="7.3.3" data-path="06-probability_distribution.html"><a href="06-probability_distribution.html#chap06_GaussStat"><i class="fa fa-check"></i><b>7.3.3</b> 正規分布の平均値と標準偏差</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="06-probability_distribution.html"><a href="06-probability_distribution.html#chap06_Poisson"><i class="fa fa-check"></i><b>7.4</b> ポアソン分布</a></li>
<li class="chapter" data-level="7.5" data-path="06-probability_distribution.html"><a href="06-probability_distribution.html#chap06_RProbfunction"><i class="fa fa-check"></i><b>7.5</b> Rで使える確率分布関数</a></li>
<li class="chapter" data-level="7.6" data-path="06-probability_distribution.html"><a href="06-probability_distribution.html#chap06_Theorem"><i class="fa fa-check"></i><b>7.6</b> 正規分布と他の確率変数との関係</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="06-probability_distribution.html"><a href="06-probability_distribution.html#chap06_Theorem1"><i class="fa fa-check"></i><b>7.6.1</b> 中心極限定理</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="06-probability_distribution.html"><a href="06-probability_distribution.html#chap06_ProbDistEquation"><i class="fa fa-check"></i><b>7.7</b> 確率分布の表現の仕方</a></li>
<li class="chapter" data-level="7.8" data-path="06-probability_distribution.html"><a href="06-probability_distribution.html#chap06_OtherDist"><i class="fa fa-check"></i><b>7.8</b> その他の確率分布</a>
<ul>
<li class="chapter" data-level="" data-path=""><a href="#%E4%B8%80%E6%A7%98%E5%88%86%E5%B8%83"><i class="fa fa-check"></i>一様分布</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="06-probability_distribution.html"><a href="06-probability_distribution.html#chap06_Practice"><i class="fa fa-check"></i><b>7.9</b> 確認問題</a>
<ul>
<li class="chapter" data-level="" data-path=""><a href="#%E5%95%8F%EF%BC%91-3"><i class="fa fa-check"></i>問１</a></li>
<li class="chapter" data-level="" data-path=""><a href="#%E5%95%8F%EF%BC%92-3"><i class="fa fa-check"></i>問２</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="07-NHT.html"><a href="07-NHT.html"><i class="fa fa-check"></i><b>8</b> 統計的仮説検定</a>
<ul>
<li class="chapter" data-level="8.1" data-path="07-NHT.html"><a href="07-NHT.html#chap07_Preparation"><i class="fa fa-check"></i><b>8.1</b> 準備</a></li>
<li class="chapter" data-level="8.2" data-path="07-NHT.html"><a href="07-NHT.html#chap07_BasisSNHT"><i class="fa fa-check"></i><b>8.2</b> 統計的仮説検定の考え方</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="07-NHT.html"><a href="07-NHT.html#chap07_binomtest"><i class="fa fa-check"></i><b>8.2.1</b> 二項検定</a></li>
<li class="chapter" data-level="8.2.2" data-path="07-NHT.html"><a href="07-NHT.html#chap07_ttest"><i class="fa fa-check"></i><b>8.2.2</b> 二標本の検定</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="07-NHT.html"><a href="07-NHT.html#chap07_summarySNHT"><i class="fa fa-check"></i><b>8.3</b> 統計的仮説検定のまとめ</a></li>
<li class="chapter" data-level="8.4" data-path="07-NHT.html"><a href="07-NHT.html#chap07_Practice"><i class="fa fa-check"></i><b>8.4</b> 確認問題</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="08-NHT_problem.html"><a href="08-NHT_problem.html"><i class="fa fa-check"></i><b>9</b> 統計的仮説検定が抱える問題</a>
<ul>
<li class="chapter" data-level="9.1" data-path="08-NHT_problem.html"><a href="08-NHT_problem.html#chap08_preparation"><i class="fa fa-check"></i><b>9.1</b> 準備</a></li>
<li class="chapter" data-level="9.2" data-path="08-NHT_problem.html"><a href="08-NHT_problem.html#chap08_SNHTsims"><i class="fa fa-check"></i><b>9.2</b> シミュレーション</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="08-NHT_problem.html"><a href="08-NHT_problem.html#chap08_function"><i class="fa fa-check"></i><b>9.2.1</b> 関数の作成</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="08-NHT_problem.html"><a href="08-NHT_problem.html#chap08_pvalue"><i class="fa fa-check"></i><b>9.3</b> p値とサンプルサイズの関係</a></li>
<li class="chapter" data-level="9.4" data-path="08-NHT_problem.html"><a href="08-NHT_problem.html#chap08_EffectSize"><i class="fa fa-check"></i><b>9.4</b> 効果量（差の大きさとp値の関係）</a></li>
<li class="chapter" data-level="9.5" data-path="08-NHT_problem.html"><a href="08-NHT_problem.html#chap08_Type12Erros"><i class="fa fa-check"></i><b>9.5</b> 第1種の過誤と第2種の過誤</a></li>
<li class="chapter" data-level="9.6" data-path="08-NHT_problem.html"><a href="08-NHT_problem.html#chap08_Power"><i class="fa fa-check"></i><b>9.6</b> 検出力</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="08-NHT_problem.html"><a href="08-NHT_problem.html#chap08_Power1"><i class="fa fa-check"></i><b>9.6.1</b> 検出力に影響する要因</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="08-NHT_problem.html"><a href="08-NHT_problem.html#chap08_PowerTest"><i class="fa fa-check"></i><b>9.7</b> 検出力分析</a></li>
<li class="chapter" data-level="9.8" data-path="08-NHT_problem.html"><a href="08-NHT_problem.html#chap08_Type1P"><i class="fa fa-check"></i><b>9.8</b> p値と第1種の過誤</a></li>
<li class="chapter" data-level="9.9" data-path="08-NHT_problem.html"><a href="08-NHT_problem.html#chap08_MultipeComparison"><i class="fa fa-check"></i><b>9.9</b> 多重比較の問題</a></li>
<li class="chapter" data-level="9.10" data-path="08-NHT_problem.html"><a href="08-NHT_problem.html#chap08_Summary"><i class="fa fa-check"></i><b>9.10</b> まとめ</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="09-analysis.html"><a href="09-analysis.html"><i class="fa fa-check"></i><b>10</b> 様々な解析法</a>
<ul>
<li class="chapter" data-level="10.1" data-path="09-analysis.html"><a href="09-analysis.html#chap09_ttest"><i class="fa fa-check"></i><b>10.1</b> t検定</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="09-analysis.html"><a href="09-analysis.html#chap09_indttest"><i class="fa fa-check"></i><b>10.1.1</b> 対応のないt検定</a></li>
<li class="chapter" data-level="10.1.2" data-path="09-analysis.html"><a href="09-analysis.html#chap09_pairedttest"><i class="fa fa-check"></i><b>10.1.2</b> 対応のあるt検定</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="09-analysis.html"><a href="09-analysis.html#chap09_ANOVA"><i class="fa fa-check"></i><b>10.2</b> 分散分析</a></li>
<li class="chapter" data-level="10.3" data-path="09-analysis.html"><a href="09-analysis.html#chap09_nonpara"><i class="fa fa-check"></i><b>10.3</b> ノンパラメトリック検定</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="09-analysis.html"><a href="09-analysis.html#chap09_wilcox"><i class="fa fa-check"></i><b>10.3.1</b> ウィルコクソンの順位和検定</a></li>
<li class="chapter" data-level="10.3.2" data-path="09-analysis.html"><a href="09-analysis.html#chap09_kruskal"><i class="fa fa-check"></i><b>10.3.2</b> クラスカル・ウォリスの検定</a></li>
<li class="chapter" data-level="10.3.3" data-path="09-analysis.html"><a href="09-analysis.html#chap09_chisq"><i class="fa fa-check"></i><b>10.3.3</b> カイ二乗検定</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="09-analysis.html"><a href="09-analysis.html#chap09_summary"><i class="fa fa-check"></i><b>10.4</b> 「統計モデル」との関係</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="10-linear_model.html"><a href="10-linear_model.html"><i class="fa fa-check"></i><b>11</b> 線形モデル（回帰分析）</a>
<ul>
<li class="chapter" data-level="11.1" data-path="10-linear_model.html"><a href="10-linear_model.html#chap10_preparation"><i class="fa fa-check"></i><b>11.1</b> 準備</a></li>
<li class="chapter" data-level="11.2" data-path="10-linear_model.html"><a href="10-linear_model.html#chap10_Intro"><i class="fa fa-check"></i><b>11.2</b> 線形モデルの概要</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="10-linear_model.html"><a href="10-linear_model.html#chap10_Summary"><i class="fa fa-check"></i><b>11.2.1</b> まとめ</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="10-linear_model.html"><a href="10-linear_model.html#chap10_lm"><i class="fa fa-check"></i><b>11.3</b> 線形モデルによる解析</a></li>
<li class="chapter" data-level="11.4" data-path="10-linear_model.html"><a href="10-linear_model.html#chap10_MLE"><i class="fa fa-check"></i><b>11.4</b> 最尤法</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="10-linear_model.html"><a href="10-linear_model.html#chap10_MLEsim"><i class="fa fa-check"></i><b>11.4.1</b> 最尤法によるパラメータ推定</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="10-linear_model.html"><a href="10-linear_model.html#chap10_Practice"><i class="fa fa-check"></i><b>11.5</b> 確認問題</a>
<ul>
<li class="chapter" data-level="" data-path=""><a href="#%E5%95%8F%EF%BC%91-4"><i class="fa fa-check"></i>問１</a></li>
<li class="chapter" data-level="" data-path=""><a href="#%E5%95%8F%EF%BC%92-4"><i class="fa fa-check"></i>問２</a></li>
<li class="chapter" data-level="" data-path=""><a href="#%E5%95%8F%EF%BC%93-3"><i class="fa fa-check"></i>問３</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="11-linear_model2.html"><a href="11-linear_model2.html"><i class="fa fa-check"></i><b>12</b> 線形モデル（t検定, 分散分析, 共分散分析）</a>
<ul>
<li class="chapter" data-level="12.1" data-path="11-linear_model2.html"><a href="11-linear_model2.html#chap11_preparation"><i class="fa fa-check"></i><b>12.1</b> 準備</a></li>
<li class="chapter" data-level="12.2" data-path="11-linear_model2.html"><a href="11-linear_model2.html#chap11_lmgroup"><i class="fa fa-check"></i><b>12.2</b> 線形モデルに含まれる統計解析</a></li>
<li class="chapter" data-level="12.3" data-path="11-linear_model2.html"><a href="11-linear_model2.html#chap11_scaling"><i class="fa fa-check"></i><b>12.3</b> 変数の標準化</a></li>
<li class="chapter" data-level="12.4" data-path="11-linear_model2.html"><a href="11-linear_model2.html#chap11_dummy"><i class="fa fa-check"></i><b>12.4</b> 予測変数がカテゴリカル変数の場合（ダミー変数）</a></li>
<li class="chapter" data-level="12.5" data-path="11-linear_model2.html"><a href="11-linear_model2.html#chap11_onewayANOVA"><i class="fa fa-check"></i><b>12.5</b> グループが複数ある場合（一要因の分散分析）</a></li>
<li class="chapter" data-level="12.6" data-path="11-linear_model2.html"><a href="11-linear_model2.html#chap11_interaction"><i class="fa fa-check"></i><b>12.6</b> 交互作用（2要因の分散分析）</a>
<ul>
<li class="chapter" data-level="12.6.1" data-path="11-linear_model2.html"><a href="11-linear_model2.html#chap11_NotingInteraction"><i class="fa fa-check"></i><b>12.6.1</b> 交互作用を扱うモデルの解釈</a></li>
</ul></li>
<li class="chapter" data-level="12.7" data-path="11-linear_model2.html"><a href="11-linear_model2.html#chap11_ANCOVA"><i class="fa fa-check"></i><b>12.7</b> 予測変数が複数ある場合（共分散分析または重回帰分析）</a>
<ul>
<li class="chapter" data-level="12.7.1" data-path="11-linear_model2.html"><a href="11-linear_model2.html#chap11_Controlling"><i class="fa fa-check"></i><b>12.7.1</b> 変数の効果の統制</a></li>
</ul></li>
<li class="chapter" data-level="12.8" data-path="11-linear_model2.html"><a href="11-linear_model2.html#chap11_Summary"><i class="fa fa-check"></i><b>12.8</b> まとめ</a></li>
<li class="chapter" data-level="12.9" data-path="11-linear_model2.html"><a href="11-linear_model2.html#chap11_Practice"><i class="fa fa-check"></i><b>12.9</b> 確認問題</a>
<ul>
<li class="chapter" data-level="" data-path=""><a href="#%E5%95%8F1"><i class="fa fa-check"></i>問1</a></li>
<li class="chapter" data-level="" data-path=""><a href="#%E5%95%8F2"><i class="fa fa-check"></i>問2</a></li>
</ul></li>
<li class="chapter" data-level="12.10" data-path="11-linear_model2.html"><a href="11-linear_model2.html#chap11_emmeans"><i class="fa fa-check"></i><b>12.10</b> 補足(emmeans)</a>
<ul>
<li class="chapter" data-level="12.10.1" data-path="11-linear_model2.html"><a href="11-linear_model2.html#chap11_emmeans1"><i class="fa fa-check"></i><b>12.10.1</b> 一要因の分散分析における多重比較</a></li>
<li class="chapter" data-level="12.10.2" data-path="11-linear_model2.html"><a href="11-linear_model2.html#chap11_emmeans2"><i class="fa fa-check"></i><b>12.10.2</b> 二要因の分散分析における単純主効果検定</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="12-glm_logistic.html"><a href="12-glm_logistic.html"><i class="fa fa-check"></i><b>13</b> 一般化線形モデル（ロジスティック回帰）</a>
<ul>
<li class="chapter" data-level="13.1" data-path="12-glm_logistic.html"><a href="12-glm_logistic.html#chap12_Preparation"><i class="fa fa-check"></i><b>13.1</b> 準備</a></li>
<li class="chapter" data-level="13.2" data-path="12-glm_logistic.html"><a href="12-glm_logistic.html#chap12_GLM"><i class="fa fa-check"></i><b>13.2</b> 一般化線形モデル</a></li>
<li class="chapter" data-level="13.3" data-path="12-glm_logistic.html"><a href="12-glm_logistic.html#chap12_BasisLogistic"><i class="fa fa-check"></i><b>13.3</b> ロジスティック回帰</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="12-glm_logistic.html"><a href="12-glm_logistic.html#chap12_LogisticProb"><i class="fa fa-check"></i><b>13.3.1</b> 応答変数が従う確率分布</a></li>
<li class="chapter" data-level="13.3.2" data-path="12-glm_logistic.html"><a href="12-glm_logistic.html#chap12_LogisticLink"><i class="fa fa-check"></i><b>13.3.2</b> リンク関数</a></li>
<li class="chapter" data-level="13.3.3" data-path="12-glm_logistic.html"><a href="12-glm_logistic.html#chap12_SummaryLogistic"><i class="fa fa-check"></i><b>13.3.3</b> ここまでのまとめ</a></li>
<li class="chapter" data-level="13.3.4" data-path="12-glm_logistic.html"><a href="12-glm_logistic.html#chap12_glmbinom"><i class="fa fa-check"></i><b>13.3.4</b> Rでのロジスティック回帰</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="12-glm_logistic.html"><a href="12-glm_logistic.html#chap12_Summary"><i class="fa fa-check"></i><b>13.4</b> まとめ</a></li>
<li class="chapter" data-level="13.5" data-path="12-glm_logistic.html"><a href="12-glm_logistic.html#chap12_Practice"><i class="fa fa-check"></i><b>13.5</b> 確認問題</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="13-glm_poisson.html"><a href="13-glm_poisson.html"><i class="fa fa-check"></i><b>14</b> 一般化線形モデル（ポアソン回帰）</a>
<ul>
<li class="chapter" data-level="14.1" data-path="13-glm_poisson.html"><a href="13-glm_poisson.html#chap13_Preparation"><i class="fa fa-check"></i><b>14.1</b> 準備</a></li>
<li class="chapter" data-level="14.2" data-path="13-glm_poisson.html"><a href="13-glm_poisson.html#chap13_BasisPoisson"><i class="fa fa-check"></i><b>14.2</b> ポアソン回帰</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="13-glm_poisson.html"><a href="13-glm_poisson.html#chap13_PoissonProb"><i class="fa fa-check"></i><b>14.2.1</b> 応答変数が従う確率分布</a></li>
<li class="chapter" data-level="14.2.2" data-path="13-glm_poisson.html"><a href="13-glm_poisson.html#chap13_PoissonLink"><i class="fa fa-check"></i><b>14.2.2</b> リンク関数</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="13-glm_poisson.html"><a href="13-glm_poisson.html#chap13_glmpoisson"><i class="fa fa-check"></i><b>14.3</b> Rでのポアソン回帰</a></li>
<li class="chapter" data-level="14.4" data-path="13-glm_poisson.html"><a href="13-glm_poisson.html#chap13_Overdisperse"><i class="fa fa-check"></i><b>14.4</b> ポアソン回帰の注意点：過分散</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="13-glm_poisson.html"><a href="13-glm_poisson.html#chap13_Overdisperse1"><i class="fa fa-check"></i><b>14.4.1</b> 過分散とは？</a></li>
<li class="chapter" data-level="14.4.2" data-path="13-glm_poisson.html"><a href="13-glm_poisson.html#chap13_CheckOverdisperse"><i class="fa fa-check"></i><b>14.4.2</b> 過分散の確認方法</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="13-glm_poisson.html"><a href="13-glm_poisson.html#chap13_CopingOversdisperse"><i class="fa fa-check"></i><b>14.5</b> 過分散への対処法</a></li>
<li class="chapter" data-level="14.6" data-path="13-glm_poisson.html"><a href="13-glm_poisson.html#chap13_Summary"><i class="fa fa-check"></i><b>14.6</b> まとめ</a></li>
<li class="chapter" data-level="14.7" data-path="13-glm_poisson.html"><a href="13-glm_poisson.html#chap13_Practice"><i class="fa fa-check"></i><b>14.7</b> 確認問題</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="14-glm_disperse.html"><a href="14-glm_disperse.html"><i class="fa fa-check"></i><b>15</b> 一般化線形モデル（過分散への対処）</a>
<ul>
<li class="chapter" data-level="15.1" data-path="14-glm_disperse.html"><a href="14-glm_disperse.html#chap14_Preparation"><i class="fa fa-check"></i><b>15.1</b> 準備</a></li>
<li class="chapter" data-level="15.2" data-path="14-glm_disperse.html"><a href="14-glm_disperse.html#chap14_NegativeBinom"><i class="fa fa-check"></i><b>15.2</b> 負の二項回帰</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="14-glm_disperse.html"><a href="14-glm_disperse.html#chap14_NegativeBinom1"><i class="fa fa-check"></i><b>15.2.1</b> 負の二項分布</a></li>
<li class="chapter" data-level="15.2.2" data-path="14-glm_disperse.html"><a href="14-glm_disperse.html#chap14_glmnb"><i class="fa fa-check"></i><b>15.2.2</b> Rでの負の二項回帰</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="14-glm_disperse.html"><a href="14-glm_disperse.html#chap14_ZIP"><i class="fa fa-check"></i><b>15.3</b> ゼロ過剰ポアソンモデル</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="14-glm_disperse.html"><a href="14-glm_disperse.html#chap14_ZIPExpample"><i class="fa fa-check"></i><b>15.3.1</b> 例題</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="14-glm_disperse.html"><a href="14-glm_disperse.html#chap14_ZIP1"><i class="fa fa-check"></i><b>15.4</b> ゼロ過剰ポアソンモデルの詳細</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="14-glm_disperse.html"><a href="14-glm_disperse.html#chap14_zeroinfl"><i class="fa fa-check"></i><b>15.4.1</b> Rでのゼロ過剰ポアソンモデル</a></li>
<li class="chapter" data-level="15.4.2" data-path="14-glm_disperse.html"><a href="14-glm_disperse.html#chap14_Hurdle"><i class="fa fa-check"></i><b>15.4.2</b> ハードルモデル</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="14-glm_disperse.html"><a href="14-glm_disperse.html#chap14_Practice"><i class="fa fa-check"></i><b>15.5</b> 確認問題</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="15-glm_category.html"><a href="15-glm_category.html"><i class="fa fa-check"></i><b>16</b> 一般化線形モデル（複数カテゴリの分析）</a>
<ul>
<li class="chapter" data-level="16.1" data-path="15-glm_category.html"><a href="15-glm_category.html#chap15_Preparation"><i class="fa fa-check"></i><b>16.1</b> 準備</a></li>
<li class="chapter" data-level="16.2" data-path="15-glm_category.html"><a href="15-glm_category.html#chap15_Variables"><i class="fa fa-check"></i><b>16.2</b> カテゴリカル変数の種類</a></li>
<li class="chapter" data-level="16.3" data-path="15-glm_category.html"><a href="15-glm_category.html#chap15_OrderedLogistic"><i class="fa fa-check"></i><b>16.3</b> 順序ロジスティック回帰</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="15-glm_category.html"><a href="15-glm_category.html#chap15_CLMExample"><i class="fa fa-check"></i><b>16.3.1</b> 例題</a></li>
<li class="chapter" data-level="16.3.2" data-path="15-glm_category.html"><a href="15-glm_category.html#chap15_BasisCLM"><i class="fa fa-check"></i><b>16.3.2</b> 順序ロジスティック回帰モデルの詳細</a></li>
<li class="chapter" data-level="16.3.3" data-path="15-glm_category.html"><a href="15-glm_category.html#chap15_clm"><i class="fa fa-check"></i><b>16.3.3</b> Rでの順序ロジスティック回帰</a></li>
<li class="chapter" data-level="16.3.4" data-path="15-glm_category.html"><a href="15-glm_category.html#chap15_factor"><i class="fa fa-check"></i><b>16.3.4</b> 変数の因子型への変換</a></li>
<li class="chapter" data-level="16.3.5" data-path="15-glm_category.html"><a href="15-glm_category.html#chap15_clm1"><i class="fa fa-check"></i><b>16.3.5</b> 解析</a></li>
<li class="chapter" data-level="16.3.6" data-path="15-glm_category.html"><a href="15-glm_category.html#chap15_clmOutput"><i class="fa fa-check"></i><b>16.3.6</b> 解釈</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="15-glm_category.html"><a href="15-glm_category.html#chap15_Multionom"><i class="fa fa-check"></i><b>16.4</b> 多項ロジスティック回帰</a>
<ul>
<li class="chapter" data-level="16.4.1" data-path="15-glm_category.html"><a href="15-glm_category.html#chap15_MultionomExample"><i class="fa fa-check"></i><b>16.4.1</b> 例題</a></li>
<li class="chapter" data-level="16.4.2" data-path="15-glm_category.html"><a href="15-glm_category.html#chap15_BasisMultinom"><i class="fa fa-check"></i><b>16.4.2</b> 多項ロジスティック回帰モデルの詳細</a></li>
<li class="chapter" data-level="16.4.3" data-path="15-glm_category.html"><a href="15-glm_category.html#chap15_nlm"><i class="fa fa-check"></i><b>16.4.3</b> Rでの多項ロジスティック回帰</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="16-glmm.html"><a href="16-glmm.html"><i class="fa fa-check"></i><b>17</b> マルチレベルモデル</a>
<ul>
<li class="chapter" data-level="17.1" data-path="16-glmm.html"><a href="16-glmm.html#chap16_Preparation"><i class="fa fa-check"></i><b>17.1</b> 準備</a></li>
<li class="chapter" data-level="17.2" data-path="16-glmm.html"><a href="16-glmm.html#chap16_BasisMultilevel"><i class="fa fa-check"></i><b>17.2</b> 個人差や集団差の問題</a></li>
<li class="chapter" data-level="17.3" data-path="16-glmm.html"><a href="16-glmm.html#chap16_BasisMultilevel1"><i class="fa fa-check"></i><b>17.3</b> マルチレベルモデルの概要</a></li>
<li class="chapter" data-level="17.4" data-path="16-glmm.html"><a href="16-glmm.html#chap16_lmer"><i class="fa fa-check"></i><b>17.4</b> Rでのマルチレベルモデル</a></li>
<li class="chapter" data-level="17.5" data-path="16-glmm.html"><a href="16-glmm.html#chap16_GLMM"><i class="fa fa-check"></i><b>17.5</b> 正規分布以外を扱う例</a>
<ul>
<li class="chapter" data-level="17.5.1" data-path="16-glmm.html"><a href="16-glmm.html#chap16_GLMMLogit"><i class="fa fa-check"></i><b>17.5.1</b> ロジスティック回帰</a></li>
<li class="chapter" data-level="17.5.2" data-path="16-glmm.html"><a href="16-glmm.html#chap16_GLMMPoisson"><i class="fa fa-check"></i><b>17.5.2</b> ポアソン回帰</a></li>
<li class="chapter" data-level="17.5.3" data-path="16-glmm.html"><a href="16-glmm.html#chap16_GLMMOverdisperse"><i class="fa fa-check"></i><b>17.5.3</b> マルチレベルモデルによる過分散への対処</a></li>
<li class="chapter" data-level="17.5.4" data-path="16-glmm.html"><a href="16-glmm.html#chap16_GLMMOthers"><i class="fa fa-check"></i><b>17.5.4</b> その他の一般化線形モデルの場合</a></li>
</ul></li>
<li class="chapter" data-level="17.6" data-path="16-glmm.html"><a href="16-glmm.html#chap16_Summary"><i class="fa fa-check"></i><b>17.6</b> まとめ</a></li>
<li class="chapter" data-level="17.7" data-path="16-glmm.html"><a href="16-glmm.html#chap16_Practice"><i class="fa fa-check"></i><b>17.7</b> 確認問題</a>
<ul>
<li class="chapter" data-level="" data-path=""><a href="#%E5%95%8F%EF%BC%91-5"><i class="fa fa-check"></i>問１</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="17-evaluation.html"><a href="17-evaluation.html"><i class="fa fa-check"></i><b>18</b> モデルの評価</a>
<ul>
<li class="chapter" data-level="18.1" data-path="17-evaluation.html"><a href="17-evaluation.html#chap17_Preparation"><i class="fa fa-check"></i><b>18.1</b> 準備</a></li>
<li class="chapter" data-level="18.2" data-path="17-evaluation.html"><a href="17-evaluation.html#chap17_Intervals"><i class="fa fa-check"></i><b>18.2</b> 信頼区間と予測区間</a>
<ul>
<li class="chapter" data-level="18.2.1" data-path="17-evaluation.html"><a href="17-evaluation.html#chap17_CI"><i class="fa fa-check"></i><b>18.2.1</b> 信頼区間</a></li>
<li class="chapter" data-level="18.2.2" data-path="17-evaluation.html"><a href="17-evaluation.html#chap17_PI"><i class="fa fa-check"></i><b>18.2.2</b> 予測区間</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="17-evaluation.html"><a href="17-evaluation.html#chap17_Multico"><i class="fa fa-check"></i><b>18.3</b> 多重共線性</a>
<ul>
<li class="chapter" data-level="18.3.1" data-path="17-evaluation.html"><a href="17-evaluation.html#chap17_EvalMultico"><i class="fa fa-check"></i><b>18.3.1</b> 多重共線性の評価</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="17-evaluation.html"><a href="17-evaluation.html#chap17_Overfitting"><i class="fa fa-check"></i><b>18.4</b> 過学習</a></li>
<li class="chapter" data-level="18.5" data-path="17-evaluation.html"><a href="17-evaluation.html#chap17_Creteria"><i class="fa fa-check"></i><b>18.5</b> モデルの予測力の評価</a>
<ul>
<li class="chapter" data-level="18.5.1" data-path="17-evaluation.html"><a href="17-evaluation.html#chap17_Rsq"><i class="fa fa-check"></i><b>18.5.1</b> 決定係数</a></li>
<li class="chapter" data-level="18.5.2" data-path="17-evaluation.html"><a href="17-evaluation.html#chap17_AIC"><i class="fa fa-check"></i><b>18.5.2</b> 赤池情報量規準（AIC）</a></li>
</ul></li>
<li class="chapter" data-level="18.6" data-path="17-evaluation.html"><a href="17-evaluation.html#chap17_Practice"><i class="fa fa-check"></i><b>18.6</b> 確認問題</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="18-Bayese.html"><a href="18-Bayese.html"><i class="fa fa-check"></i><b>19</b> ベイズ統計</a>
<ul>
<li class="chapter" data-level="19.1" data-path="18-Bayese.html"><a href="18-Bayese.html#chap18_BasisBayese"><i class="fa fa-check"></i><b>19.1</b> 頻度主義統計学とベイズ統計学</a></li>
<li class="chapter" data-level="19.2" data-path="18-Bayese.html"><a href="18-Bayese.html#chap18_BayeseTheorem"><i class="fa fa-check"></i><b>19.2</b> ベイズの定理</a>
<ul>
<li class="chapter" data-level="19.2.1" data-path="18-Bayese.html"><a href="18-Bayese.html#chap18_BayeseExample"><i class="fa fa-check"></i><b>19.2.1</b> 例題</a></li>
<li class="chapter" data-level="19.2.2" data-path="18-Bayese.html"><a href="18-Bayese.html#chap18_PriorPosterior"><i class="fa fa-check"></i><b>19.2.2</b> 事前確率、事後確率</a></li>
<li class="chapter" data-level="19.2.3" data-path="18-Bayese.html"><a href="18-Bayese.html#chap18_BayesianStat"><i class="fa fa-check"></i><b>19.2.3</b> ベイズ統計</a></li>
</ul></li>
<li class="chapter" data-level="19.3" data-path="18-Bayese.html"><a href="18-Bayese.html#chap18_BayesianEst"><i class="fa fa-check"></i><b>19.3</b> ベイズ推定の例</a>
<ul>
<li class="chapter" data-level="19.3.1" data-path="18-Bayese.html"><a href="18-Bayese.html#chap18_Prior"><i class="fa fa-check"></i><b>19.3.1</b> 事前分布</a></li>
<li class="chapter" data-level="19.3.2" data-path="18-Bayese.html"><a href="18-Bayese.html#chap18_Likelihood"><i class="fa fa-check"></i><b>19.3.2</b> 尤度</a></li>
<li class="chapter" data-level="19.3.3" data-path="18-Bayese.html"><a href="18-Bayese.html#chap18_Posterior"><i class="fa fa-check"></i><b>19.3.3</b> 事後分布</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="18-Bayese.html"><a href="18-Bayese.html#chap18_MCMC"><i class="fa fa-check"></i><b>19.4</b> MCMC</a>
<ul>
<li class="chapter" data-level="19.4.1" data-path="18-Bayese.html"><a href="18-Bayese.html#chap18_MCMCExample"><i class="fa fa-check"></i><b>19.4.1</b> MCMCの例</a></li>
</ul></li>
<li class="chapter" data-level="19.5" data-path="18-Bayese.html"><a href="18-Bayese.html#chap18_Practice"><i class="fa fa-check"></i><b>19.5</b> 確認問題</a>
<ul>
<li class="chapter" data-level="" data-path=""><a href="#%E5%95%8F1-1"><i class="fa fa-check"></i>問1</a></li>
<li class="chapter" data-level="" data-path="18-Bayese.html"><a href="18-Bayese.html#section-6"><i class="fa fa-check"></i>1-1</a></li>
<li class="chapter" data-level="" data-path="18-Bayese.html"><a href="18-Bayese.html#section-7"><i class="fa fa-check"></i>1-2</a></li>
<li class="chapter" data-level="" data-path="18-Bayese.html"><a href="18-Bayese.html#section-8"><i class="fa fa-check"></i>1-3</a></li>
<li class="chapter" data-level="" data-path=""><a href="#%E5%95%8F2-1"><i class="fa fa-check"></i>問2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="20" data-path="19-Bayese_model.html"><a href="19-Bayese_model.html"><i class="fa fa-check"></i><b>20</b> ベイズ統計モデリング</a>
<ul>
<li class="chapter" data-level="20.1" data-path="19-Bayese_model.html"><a href="19-Bayese_model.html#chap19_Preparation"><i class="fa fa-check"></i><b>20.1</b> 準備</a>
<ul>
<li class="chapter" data-level="20.1.1" data-path="19-Bayese_model.html"><a href="19-Bayese_model.html#chap19_Rstan"><i class="fa fa-check"></i><b>20.1.1</b> Rstanのインストール</a></li>
<li class="chapter" data-level="20.1.2" data-path="19-Bayese_model.html"><a href="19-Bayese_model.html#chap19_brmspackage"><i class="fa fa-check"></i><b>20.1.2</b> brmsパッケージのインストール</a></li>
<li class="chapter" data-level="20.1.3" data-path="19-Bayese_model.html"><a href="19-Bayese_model.html#chap19_loadpackage"><i class="fa fa-check"></i><b>20.1.3</b> パッケージのロード</a></li>
</ul></li>
<li class="chapter" data-level="20.2" data-path="19-Bayese_model.html"><a href="19-Bayese_model.html#chap19_brms"><i class="fa fa-check"></i><b>20.2</b> Rによるベイズ統計モデリング</a></li>
<li class="chapter" data-level="20.3" data-path="19-Bayese_model.html"><a href="19-Bayese_model.html#chap19_Basisbrm"><i class="fa fa-check"></i><b>20.3</b> ベイズ統計モデリングのプロセス</a>
<ul>
<li class="chapter" data-level="20.3.1" data-path="19-Bayese_model.html"><a href="19-Bayese_model.html#chap19_brmprior"><i class="fa fa-check"></i><b>20.3.1</b> 事前分布の設定</a></li>
<li class="chapter" data-level="20.3.2" data-path="19-Bayese_model.html"><a href="19-Bayese_model.html#chap19_brmMCMC"><i class="fa fa-check"></i><b>20.3.2</b> MCMCの設定</a></li>
<li class="chapter" data-level="20.3.3" data-path="19-Bayese_model.html"><a href="19-Bayese_model.html#chap19_brmposterior"><i class="fa fa-check"></i><b>20.3.3</b> 事後分布の評価</a></li>
<li class="chapter" data-level="20.3.4" data-path="19-Bayese_model.html"><a href="19-Bayese_model.html#chap19_brmconvergence"><i class="fa fa-check"></i><b>20.3.4</b> 収束の評価</a></li>
<li class="chapter" data-level="20.3.5" data-path="19-Bayese_model.html"><a href="19-Bayese_model.html#chap19_brmprediction"><i class="fa fa-check"></i><b>20.3.5</b> モデルの予測評価</a></li>
</ul></li>
<li class="chapter" data-level="20.4" data-path="19-Bayese_model.html"><a href="19-Bayese_model.html#chap19_brmGLM"><i class="fa fa-check"></i><b>20.4</b> brmsパッケージでの一般化線形モデル</a>
<ul>
<li class="chapter" data-level="20.4.1" data-path="19-Bayese_model.html"><a href="19-Bayese_model.html#chap19_brmbernoulli"><i class="fa fa-check"></i><b>20.4.1</b> ロジスティック回帰</a></li>
<li class="chapter" data-level="20.4.2" data-path="19-Bayese_model.html"><a href="19-Bayese_model.html#chap19_brmPoisson"><i class="fa fa-check"></i><b>20.4.2</b> ポアソン回帰</a></li>
<li class="chapter" data-level="20.4.3" data-path="19-Bayese_model.html"><a href="19-Bayese_model.html#chap19_brmnegbinom"><i class="fa fa-check"></i><b>20.4.3</b> 負の二項回帰</a></li>
<li class="chapter" data-level="20.4.4" data-path="19-Bayese_model.html"><a href="19-Bayese_model.html#chap19_brmclm"><i class="fa fa-check"></i><b>20.4.4</b> 順序ロジスティック回帰</a></li>
<li class="chapter" data-level="20.4.5" data-path="19-Bayese_model.html"><a href="19-Bayese_model.html#chap19_brmcategorical"><i class="fa fa-check"></i><b>20.4.5</b> 多項ロジスティック回帰</a></li>
<li class="chapter" data-level="20.4.6" data-path="19-Bayese_model.html"><a href="19-Bayese_model.html#chap19_brmZIP"><i class="fa fa-check"></i><b>20.4.6</b> ゼロ過剰ポアソンモデル</a></li>
</ul></li>
<li class="chapter" data-level="20.5" data-path="19-Bayese_model.html"><a href="19-Bayese_model.html#chap19_brmGLMM"><i class="fa fa-check"></i><b>20.5</b> brmsパッケージでのマルチレベルモデル</a>
<ul>
<li class="chapter" data-level="20.5.1" data-path="19-Bayese_model.html"><a href="19-Bayese_model.html#chap19_brmRandIntercept"><i class="fa fa-check"></i><b>20.5.1</b> ランダム切片</a></li>
<li class="chapter" data-level="20.5.2" data-path="19-Bayese_model.html"><a href="19-Bayese_model.html#chap19_brmRandSlope"><i class="fa fa-check"></i><b>20.5.2</b> ランダム傾き</a></li>
</ul></li>
<li class="chapter" data-level="20.6" data-path="19-Bayese_model.html"><a href="19-Bayese_model.html#chap19_Others"><i class="fa fa-check"></i><b>20.6</b> その他</a>
<ul>
<li class="chapter" data-level="20.6.1" data-path="19-Bayese_model.html"><a href="19-Bayese_model.html#chap19_brmStanCode"><i class="fa fa-check"></i><b>20.6.1</b> Stanコードの出力</a></li>
<li class="chapter" data-level="20.6.2" data-path="19-Bayese_model.html"><a href="19-Bayese_model.html#chap19_furtherLearning"><i class="fa fa-check"></i><b>20.6.2</b> より深く学ぶには</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>付録</b></span></li>
<li class="chapter" data-level="A" data-path="20-Appendix_References.html"><a href="20-Appendix_References.html"><i class="fa fa-check"></i><b>A</b> 確率分布</a>
<ul>
<li class="chapter" data-level="A.1" data-path="20-Appendix_References.html"><a href="20-Appendix_References.html#A_Continuous"><i class="fa fa-check"></i><b>A.1</b> 連続型確率分布</a>
<ul>
<li class="chapter" data-level="" data-path=""><a href="#%E6%AD%A3%E8%A6%8F%E5%88%86%E5%B8%83"><i class="fa fa-check"></i>正規分布</a></li>
<li class="chapter" data-level="" data-path=""><a href="#%E6%8C%87%E6%95%B0%E5%88%86%E5%B8%83"><i class="fa fa-check"></i>指数分布</a></li>
<li class="chapter" data-level="" data-path=""><a href="#%E5%AF%BE%E6%95%B0%E6%AD%A3%E8%A6%8F%E5%88%86%E5%B8%83"><i class="fa fa-check"></i>対数正規分布</a></li>
<li class="chapter" data-level="" data-path=""><a href="#t%E5%88%86%E5%B8%83"><i class="fa fa-check"></i>t分布</a></li>
<li class="chapter" data-level="" data-path=""><a href="#%E3%82%AB%E3%82%A4%E4%BA%8C%E4%B9%97%E5%88%86%E5%B8%83"><i class="fa fa-check"></i>カイ二乗分布</a></li>
<li class="chapter" data-level="" data-path=""><a href="#f%E5%88%86%E5%B8%83"><i class="fa fa-check"></i>F分布</a></li>
<li class="chapter" data-level="" data-path=""><a href="#%E3%82%B3%E3%83%BC%E3%82%B7%E3%83%BC%E5%88%86%E5%B8%83"><i class="fa fa-check"></i>コーシー分布</a></li>
</ul></li>
<li class="chapter" data-level="A.2" data-path="20-Appendix_References.html"><a href="20-Appendix_References.html#A_Discrete"><i class="fa fa-check"></i><b>A.2</b> 離散型確率分布</a>
<ul>
<li class="chapter" data-level="" data-path=""><a href="#%E4%BA%8C%E9%A0%85%E5%88%86%E5%B8%83"><i class="fa fa-check"></i>二項分布</a></li>
<li class="chapter" data-level="" data-path=""><a href="#%E8%B2%A0%E3%81%AE%E4%BA%8C%E9%A0%85%E5%88%86%E5%B8%83"><i class="fa fa-check"></i>負の二項分布</a></li>
<li class="chapter" data-level="" data-path=""><a href="#%E5%B9%BE%E4%BD%95%E5%88%86%E5%B8%83"><i class="fa fa-check"></i>幾何分布</a></li>
<li class="chapter" data-level="" data-path=""><a href="#%E8%B6%85%E5%B9%BE%E4%BD%95%E5%88%86%E5%B8%83"><i class="fa fa-check"></i>超幾何分布</a></li>
<li class="chapter" data-level="" data-path=""><a href="#%E3%83%9D%E3%82%A2%E3%82%BD%E3%83%B3%E5%88%86%E5%B8%83"><i class="fa fa-check"></i>ポアソン分布</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="B" data-path="20-Appendix_References.html"><a href="20-Appendix_References.html#A_Markdown"><i class="fa fa-check"></i><b>B</b> R Markdownの使い方</a></li>
<li class="chapter" data-level="C" data-path="20-Appendix_References.html"><a href="20-Appendix_References.html#A_References"><i class="fa fa-check"></i><b>C</b> 参考資料</a>
<ul>
<li class="chapter" data-level="C.1" data-path="20-Appendix_References.html"><a href="20-Appendix_References.html#A_ReferenceBooks"><i class="fa fa-check"></i><b>C.1</b> 文献</a>
<ul>
<li class="chapter" data-level="C.1.1" data-path="20-Appendix_References.html"><a href="20-Appendix_References.html#A_ReferenceBooks1"><i class="fa fa-check"></i><b>C.1.1</b> 統計学の解説書</a></li>
<li class="chapter" data-level="C.1.2" data-path="20-Appendix_References.html"><a href="20-Appendix_References.html#A_ReferenceBooks2"><i class="fa fa-check"></i><b>C.1.2</b> Rを用いた統計解析の解説書</a></li>
<li class="chapter" data-level="C.1.3" data-path="20-Appendix_References.html"><a href="20-Appendix_References.html#A_ReferenceBooks3"><i class="fa fa-check"></i><b>C.1.3</b> データ・ビジュアライゼーション</a></li>
<li class="chapter" data-level="C.1.4" data-path="20-Appendix_References.html"><a href="20-Appendix_References.html#A_ReferenceBooks4"><i class="fa fa-check"></i><b>C.1.4</b> 一般化線形モデル、マルチレベルモデルなどの解説書</a></li>
<li class="chapter" data-level="C.1.5" data-path="20-Appendix_References.html"><a href="20-Appendix_References.html#A_ReferenceBooks5"><i class="fa fa-check"></i><b>C.1.5</b> ベイズ統計モデリングの解説書</a></li>
</ul></li>
<li class="chapter" data-level="C.2" data-path="20-Appendix_References.html"><a href="20-Appendix_References.html#A_ReferenceWeb"><i class="fa fa-check"></i><b>C.2</b> Webサイト</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">心理データ応用解析法</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chap11_lmmodels" class="section level1 hasAnchor" number="12">
<h1><span class="header-section-number">Chapter 12</span> 線形モデル（t検定, 分散分析, 共分散分析）<a href="11-linear_model2.html#chap11_lmmodels" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>前の章では、線形モデルの概要を見てきた。前の章で線形モデルを用いて行った分析は、要は「単回帰分析（一つの連続変量から、もう一方の連続変量の値を予測する分析）」であった。</p>
<p>この章では、線形モデルを用いて他の分析を行う。予測変数のパターンが異なるケースの演習を通して、線形モデルは正規分布を扱うあらゆるタイプの分析を内包したモデルであることを確認していく。</p>
<ul>
<li>変数の標準化<br />
</li>
<li>予測変数がカテゴリの場合（ダミー変数）<br />
</li>
<li>予測変数がカテゴリの場合（複数のダミー変数）<br />
</li>
<li>交互作用</li>
</ul>
<div id="chap11_preparation" class="section level2 hasAnchor" number="12.1">
<h2><span class="header-section-number">12.1</span> 準備<a href="11-linear_model2.html#chap11_preparation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>必要なパッケージをロードする。</p>
<div class="sourceCode" id="cb365"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb365-1"><a href="11-linear_model2.html#cb365-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb365-2"><a href="11-linear_model2.html#cb365-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code></pre></div>
</div>
<div id="chap11_lmgroup" class="section level2 hasAnchor" number="12.2">
<h2><span class="header-section-number">12.2</span> 線形モデルに含まれる統計解析<a href="11-linear_model2.html#chap11_lmgroup" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>線形モデルとは特定の解析を指すものではなく、正規分布を扱う様々な統計解析を包括的に扱う統計モデルである。例えば、変数の正規性を前提とするt検定や分散分析も線形モデルの中に含まれる。予測変数の種類や個数の違いによって、線形モデルは以下のそれぞれの統計解析と一致する。</p>
<table>
<colgroup>
<col width="15%" />
<col width="39%" />
<col width="44%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">分析</th>
<th align="left">予測変数</th>
<th align="left">予測変数の個数</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">t検定</td>
<td align="left">二値(0 or 1)</td>
<td align="left">1個</td>
</tr>
<tr class="even">
<td align="left">分散分析</td>
<td align="left">二値</td>
<td align="left">2個以上</td>
</tr>
<tr class="odd">
<td align="left">共分散分析</td>
<td align="left">二値及び連続量</td>
<td align="left">二値が2個以上、連続量が1個以上</td>
</tr>
<tr class="even">
<td align="left">単回帰分析</td>
<td align="left">連続量</td>
<td align="left">1個</td>
</tr>
<tr class="odd">
<td align="left">重回帰分析</td>
<td align="left">連続量（二値を含んでも可）</td>
<td align="left">2個以上</td>
</tr>
</tbody>
</table>
<p>前章では単回帰分析（予測変数が連続量で1個）を例として演習を行った。以下では、t検定や分散分析と似たことを<code>lm()</code>関数で行う練習を通して、<strong>予測変数がカテゴリーの場合</strong>の扱い方を学んでいく。</p>
</div>
<div id="chap11_scaling" class="section level2 hasAnchor" number="12.3">
<h2><span class="header-section-number">12.3</span> 変数の標準化<a href="11-linear_model2.html#chap11_scaling" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>解析の演習に入る前に、<strong>標準化(standardizing)</strong>について確認しておこう。標準化とは、元の値を「ゼロが平均値、1が標準偏差」と等しくなるように値を変換する処理のことをいう。変数を標準化しておくと、線形モデルの係数の解釈が直感的に理解しやすくなる事が多い。</p>
<p>例えば、前の章では<code>iris</code>データを使って単回帰分析を行った。</p>
<div class="sourceCode" id="cb366"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb366-1"><a href="11-linear_model2.html#cb366-1" tabindex="-1"></a>dat <span class="ot">=</span> iris <span class="co">#ここではirisを別の名前（dat）に変えて練習に用いる</span></span>
<span id="cb366-2"><a href="11-linear_model2.html#cb366-2" tabindex="-1"></a>result <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">data =</span> dat, Petal.Length <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> Sepal.Length)</span>
<span id="cb366-3"><a href="11-linear_model2.html#cb366-3" tabindex="-1"></a><span class="fu">summary</span>(result)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Petal.Length ~ 1 + Sepal.Length, data = dat)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2.47747 -0.59072 -0.00668  0.60484  2.49512 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  -7.10144    0.50666  -14.02   &lt;2e-16 ***
## Sepal.Length  1.85843    0.08586   21.65   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.8678 on 148 degrees of freedom
## Multiple R-squared:   0.76,  Adjusted R-squared:  0.7583 
## F-statistic: 468.6 on 1 and 148 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>切片の値は<code>Sepal.Length</code>がゼロのときの<code>Petal.Length</code>の予測値である。しかし、アヤメの花弁の長さがマイナスやゼロの値を取るというのはありえない。また、切片は予測変数がゼロのときの応答変数の値であるが、このデータも予測変数（すなわちがくの長さ）がゼロの場合も論理的には有り得ない。このように、元の値をそのまま使っても係数の解釈にこまる場面がある。</p>
<p>応答変数及び予測変数を標準化したものを使って同じ解析をして、結果を比較してみよう。具体的には、元の得点から<strong>平均値を引いて</strong>差の得点を求め、その差の得点を<strong>標準偏差で割る</strong>。</p>
<div class="sourceCode" id="cb368"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb368-1"><a href="11-linear_model2.html#cb368-1" tabindex="-1"></a>dat <span class="ot">=</span> dat <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Petal.Length_std =</span> (Petal.Length <span class="sc">-</span> <span class="fu">mean</span>(Petal.Length))<span class="sc">/</span><span class="fu">sd</span>(Petal.Length),</span>
<span id="cb368-2"><a href="11-linear_model2.html#cb368-2" tabindex="-1"></a>                           <span class="at">Sepal.Length_std =</span> (Sepal.Length <span class="sc">-</span> <span class="fu">mean</span>(Sepal.Length))<span class="sc">/</span><span class="fu">sd</span>(Sepal.Length))</span>
<span id="cb368-3"><a href="11-linear_model2.html#cb368-3" tabindex="-1"></a></span>
<span id="cb368-4"><a href="11-linear_model2.html#cb368-4" tabindex="-1"></a><span class="fu">head</span>(dat)</span></code></pre></div>
<pre><code>##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species Petal.Length_std
## 1          5.1         3.5          1.4         0.2  setosa        -1.335752
## 2          4.9         3.0          1.4         0.2  setosa        -1.335752
## 3          4.7         3.2          1.3         0.2  setosa        -1.392399
## 4          4.6         3.1          1.5         0.2  setosa        -1.279104
## 5          5.0         3.6          1.4         0.2  setosa        -1.335752
## 6          5.4         3.9          1.7         0.4  setosa        -1.165809
##   Sepal.Length_std
## 1       -0.8976739
## 2       -1.1392005
## 3       -1.3807271
## 4       -1.5014904
## 5       -1.0184372
## 6       -0.5353840</code></pre>
<p>標準化した得点を用いて線形モデルで解析を行う。</p>
<div class="sourceCode" id="cb370"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb370-1"><a href="11-linear_model2.html#cb370-1" tabindex="-1"></a>result_std <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">data =</span> dat, Petal.Length_std <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> Sepal.Length_std)</span>
<span id="cb370-2"><a href="11-linear_model2.html#cb370-2" tabindex="-1"></a><span class="fu">summary</span>(result_std)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Petal.Length_std ~ 1 + Sepal.Length_std, data = dat)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.40343 -0.33463 -0.00379  0.34263  1.41343 
## 
## Coefficients:
##                   Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)      1.333e-16  4.014e-02    0.00        1    
## Sepal.Length_std 8.718e-01  4.027e-02   21.65   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.4916 on 148 degrees of freedom
## Multiple R-squared:   0.76,  Adjusted R-squared:  0.7583 
## F-statistic: 468.6 on 1 and 148 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>標準化しない得点を使ったときの解析結果と比べると、係数の値が変わっている。しかし、傾きのt値及びp値は変わっていない（標準化は単にデータを平行移動させただけなので、回帰直線の傾きは変わらない）。</p>
<p>切片は0、<code>Sepal.Length_std</code>の効果は0.87である。切片の値は、<code>Sepal.Length_std</code>がゼロのとき、つまり<code>Sepal.Length</code>が平均値と等しいとき、<code>Petal.Length_std</code>はほぼゼロの値を取る、つまり<code>Petal.Length</code>の平均値であることを意味している。また、<code>Sepal.Length_std</code>の傾きは、<code>Sepal.Length_std</code>が1のとき（つまり<code>Sepal.Length</code>が1標準偏差分増加したとき）、<code>Petal.Length_std</code>が0.87増えることを意味する。</p>
<p>このように、標準化することで算出された係数の解釈がしやすくなることが多い。以降の線形モデルを扱う分析の例でも、応答変数は標準化したものを用いる。</p>
<hr />
<p>Rには標準化を行うための関数も用意されている。<code>scale()</code>を用いる。</p>
<div class="sourceCode" id="cb372"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb372-1"><a href="11-linear_model2.html#cb372-1" tabindex="-1"></a>dat <span class="ot">=</span> iris <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Petal.Length_std =</span> <span class="fu">scale</span>(Petal.Length)) </span>
<span id="cb372-2"><a href="11-linear_model2.html#cb372-2" tabindex="-1"></a></span>
<span id="cb372-3"><a href="11-linear_model2.html#cb372-3" tabindex="-1"></a><span class="fu">head</span>(dat)</span></code></pre></div>
<pre><code>##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species Petal.Length_std
## 1          5.1         3.5          1.4         0.2  setosa        -1.335752
## 2          4.9         3.0          1.4         0.2  setosa        -1.335752
## 3          4.7         3.2          1.3         0.2  setosa        -1.392399
## 4          4.6         3.1          1.5         0.2  setosa        -1.279104
## 5          5.0         3.6          1.4         0.2  setosa        -1.335752
## 6          5.4         3.9          1.7         0.4  setosa        -1.165809</code></pre>
</div>
<div id="chap11_dummy" class="section level2 hasAnchor" number="12.4">
<h2><span class="header-section-number">12.4</span> 予測変数がカテゴリカル変数の場合（ダミー変数）<a href="11-linear_model2.html#chap11_dummy" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>予測変数はカテゴリカル変数（質的変数）でも構わない。ただし、予測変数を0か1のどちらかの値を取る<strong>ダミー変数</strong>(dummy variable)に変換する必要がある。</p>
<p>Rに入っている<code>sleep</code>データを少し変えたもの使って、カテゴリカル変数を予測変数に含む線形モデルの解析をしてみよう。</p>
<div class="sourceCode" id="cb374"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb374-1"><a href="11-linear_model2.html#cb374-1" tabindex="-1"></a>sleep_1 <span class="ot">=</span> sleep <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>ID) <span class="sc">|&gt;</span> </span>
<span id="cb374-2"><a href="11-linear_model2.html#cb374-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">ifelse</span>(group <span class="sc">==</span> <span class="dv">1</span>, <span class="st">&quot;control&quot;</span>, <span class="st">&quot;treatment&quot;</span>))</span>
<span id="cb374-3"><a href="11-linear_model2.html#cb374-3" tabindex="-1"></a>sleep_1</span></code></pre></div>
<pre><code>##    extra     group
## 1    0.7   control
## 2   -1.6   control
## 3   -0.2   control
## 4   -1.2   control
## 5   -0.1   control
## 6    3.4   control
## 7    3.7   control
## 8    0.8   control
## 9    0.0   control
## 10   2.0   control
## 11   1.9 treatment
## 12   0.8 treatment
## 13   1.1 treatment
## 14   0.1 treatment
## 15  -0.1 treatment
## 16   4.4 treatment
## 17   5.5 treatment
## 18   1.6 treatment
## 19   4.6 treatment
## 20   3.4 treatment</code></pre>
<p><code>group</code>はグループを意味する変数である（統制群<code>control</code>もしくは実験群<code>treatment</code>）。まずこれを、「<code>treatment</code>なら1、<code>control</code>なら0」とする新たな変数<code>dgroup</code>を作る。</p>
<div class="sourceCode" id="cb376"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb376-1"><a href="11-linear_model2.html#cb376-1" tabindex="-1"></a>sleep_1 <span class="ot">=</span> sleep_1 <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">dgroup =</span> <span class="fu">ifelse</span>(group <span class="sc">==</span> <span class="st">&quot;treatment&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb376-2"><a href="11-linear_model2.html#cb376-2" tabindex="-1"></a>sleep_1</span></code></pre></div>
<pre><code>##    extra     group dgroup
## 1    0.7   control      0
## 2   -1.6   control      0
## 3   -0.2   control      0
## 4   -1.2   control      0
## 5   -0.1   control      0
## 6    3.4   control      0
## 7    3.7   control      0
## 8    0.8   control      0
## 9    0.0   control      0
## 10   2.0   control      0
## 11   1.9 treatment      1
## 12   0.8 treatment      1
## 13   1.1 treatment      1
## 14   0.1 treatment      1
## 15  -0.1 treatment      1
## 16   4.4 treatment      1
## 17   5.5 treatment      1
## 18   1.6 treatment      1
## 19   4.6 treatment      1
## 20   3.4 treatment      1</code></pre>
<p><code>ifelse()</code>関数は、<code>ifelse(XXX, A, B)</code>と表記することで、「XXXの条件に当てはまればA、当てはまらなければB」という処理をしてくれる。ここでは、変数<code>group</code>について、<code>treatment</code>ならば1, それ以外なら0に変換し、0か1を取る変数<code>dgroup</code>を新たに作った。</p>
<p>この<code>dgroup</code>が<em>ダミー変数</em>である。</p>
<p>解析に用いるモデルを確認すると、以下のようになる。</p>
<p><span class="math display">\[
\begin{equation}
  \hat{y} = \alpha + \beta dgroup \\ \tag{1}\\
  y \sim \text{Normal}(\hat{y}, \sigma)
\end{equation}
\]</span></p>
<p><span class="math inline">\(dgroup\)</span>は0か1のどちらかを取る変数で、<span class="math inline">\(dgroup = 0\)</span>のとき、つまり統制群のとき、応答変数の予測値は<span class="math inline">\(\mu = \alpha\)</span>となる。<span class="math inline">\(dgroup = 1\)</span>のとき、つまり実験群のとき、応答変数の予測値は<span class="math inline">\(\mu = \alpha + \beta\)</span>となる。すなわち、切片<span class="math inline">\(\alpha\)</span>は統制群のときの効果、傾き<span class="math inline">\(\beta\)</span>は実験群の時に加わる実験群特有の効果を意味する。</p>
<p><code>lm()</code>を使って、上のモデル式のパラメータの推定をしよう。</p>
<div class="sourceCode" id="cb378"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb378-1"><a href="11-linear_model2.html#cb378-1" tabindex="-1"></a>sleep_1 <span class="ot">=</span> sleep_1 <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">extra_std =</span> <span class="fu">scale</span>(extra)) <span class="co">#応答変数を標準化したものを用いる</span></span>
<span id="cb378-2"><a href="11-linear_model2.html#cb378-2" tabindex="-1"></a></span>
<span id="cb378-3"><a href="11-linear_model2.html#cb378-3" tabindex="-1"></a>result <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">data =</span> sleep_1, extra_std <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> dgroup)</span>
<span id="cb378-4"><a href="11-linear_model2.html#cb378-4" tabindex="-1"></a><span class="fu">summary</span>(result)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = extra_std ~ 1 + dgroup, data = sleep_1)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.2042 -0.6467 -0.2874  0.7210  1.5709 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)  -0.3915     0.2975  -1.316   0.2048  
## dgroup        0.7830     0.4208   1.861   0.0792 .
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.9409 on 18 degrees of freedom
## Multiple R-squared:  0.1613, Adjusted R-squared:  0.1147 
## F-statistic: 3.463 on 1 and 18 DF,  p-value: 0.07919</code></pre>
<p>2つの群間で平均値を比較するときにはt検定がよく使われる。<code>t.test()</code>関数を使って<span class="math inline">\(dgroup=0\)</span>と<span class="math inline">\(dgroup=1\)</span>との間で<span class="math inline">\(y\)</span>の値の平均値を比較したときのt値及びp値の結果が、<code>lm()</code>の傾きのt値及びp値と一致することを確認しよう。</p>
<div class="sourceCode" id="cb380"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb380-1"><a href="11-linear_model2.html#cb380-1" tabindex="-1"></a><span class="fu">t.test</span>(<span class="at">data =</span> sleep_1, extra_std <span class="sc">~</span> dgroup)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  extra_std by dgroup
## t = -1.8608, df = 17.776, p-value = 0.07939
## alternative hypothesis: true difference in means between group 0 and group 1 is not equal to 0
## 95 percent confidence interval:
##  -1.6677984  0.1018292
## sample estimates:
## mean in group 0 mean in group 1 
##      -0.3914923       0.3914923</code></pre>
<p><code>lm()</code>の傾きの検定は、「傾きがゼロである」という帰無仮説を検定している。傾きの係数が意味することは、予測変数<span class="math inline">\(dgroup\)</span>が1単位増えたときの応答変数<span class="math inline">\(y\)</span>の変化量であった。傾きの検定は、「<span class="math inline">\(dgroup=0\)</span> から <span class="math inline">\(dgroup=1\)</span> に変化することによって、 応答変数（<code>extra</code>） が上昇（下降）するか（傾きがゼロではないか）」を検定している。要は、「<span class="math inline">\(dgroup=0\)</span>と<span class="math inline">\(dgroup=1\)</span>の間で<span class="math inline">\(y\)</span>の値に差があるか」を検定しているのと論理的に同じである。</p>
<p>このように、<em>予測変数が1つで、予測変数が二値（0もしくは1）であるときの線形モデルは、t検定に対応する</em>。</p>
</div>
<div id="chap11_onewayANOVA" class="section level2 hasAnchor" number="12.5">
<h2><span class="header-section-number">12.5</span> グループが複数ある場合（一要因の分散分析）<a href="11-linear_model2.html#chap11_onewayANOVA" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>先ほどの例は、統制群と実験群の二つのグループの場合であった。例えば実験で統制群、実験群1、実験群2といったように三つ以上のグループを設定した場合は、どうダミー変数を作成すればよいのか？</p>
<p>Rに入っている<code>PlantGrowth</code>を例として見ていこう。以下のプログラムを実行して、データを作ろう。</p>
<div class="sourceCode" id="cb382"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb382-1"><a href="11-linear_model2.html#cb382-1" tabindex="-1"></a>dat <span class="ot">=</span> PlantGrowth <span class="sc">|&gt;</span></span>
<span id="cb382-2"><a href="11-linear_model2.html#cb382-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">t1 =</span> <span class="fu">ifelse</span>(group <span class="sc">==</span> <span class="st">&quot;trt1&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb382-3"><a href="11-linear_model2.html#cb382-3" tabindex="-1"></a>                <span class="at">t2 =</span> <span class="fu">ifelse</span>(group <span class="sc">==</span> <span class="st">&quot;trt2&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb382-4"><a href="11-linear_model2.html#cb382-4" tabindex="-1"></a>                )</span>
<span id="cb382-5"><a href="11-linear_model2.html#cb382-5" tabindex="-1"></a>dat</span></code></pre></div>
<pre><code>##    weight group t1 t2
## 1    4.17  ctrl  0  0
## 2    5.58  ctrl  0  0
## 3    5.18  ctrl  0  0
## 4    6.11  ctrl  0  0
## 5    4.50  ctrl  0  0
## 6    4.61  ctrl  0  0
## 7    5.17  ctrl  0  0
## 8    4.53  ctrl  0  0
## 9    5.33  ctrl  0  0
## 10   5.14  ctrl  0  0
## 11   4.81  trt1  1  0
## 12   4.17  trt1  1  0
## 13   4.41  trt1  1  0
## 14   3.59  trt1  1  0
## 15   5.87  trt1  1  0
## 16   3.83  trt1  1  0
## 17   6.03  trt1  1  0
## 18   4.89  trt1  1  0
## 19   4.32  trt1  1  0
## 20   4.69  trt1  1  0
## 21   6.31  trt2  0  1
## 22   5.12  trt2  0  1
## 23   5.54  trt2  0  1
## 24   5.50  trt2  0  1
## 25   5.37  trt2  0  1
## 26   5.29  trt2  0  1
## 27   4.92  trt2  0  1
## 28   6.15  trt2  0  1
## 29   5.80  trt2  0  1
## 30   5.26  trt2  0  1</code></pre>
<p>ダミー変数を2つ作成した。<code>ctrl</code>のときは「<code>t1</code> = 0, <code>t2</code> = 0」,<code>trt1</code>のときは「<code>t1</code> = 1, <code>t2</code> = 0」,<code>trt2</code>のときは「<code>t1</code> = 0, <code>t2</code> = 1」となっている。これら２つのダミー変数を線形予測子に加えたモデルは、モデルは以下のようになる。</p>
<p><span class="math display">\[
\begin{equation}
  \hat{y} = \alpha + \beta_{t1} t_1 + \beta_{t2} t_2  \\ \tag{3}
  y \sim \text{Normal}(\hat{y}, \sigma)
\end{equation}
\]</span>
切片<span class="math inline">\(\alpha\)</span>は「<code>t1</code> = 0, <code>t2</code> = 0（すなわち、<code>ctrl</code>のとき）」の<span class="math inline">\(\hat{y}\)</span>の値と等しい。<br />
傾き<span class="math inline">\(\beta_{t1}\)</span>は「<code>t1</code> = 1, <code>t2</code> = 0（すなわち、<code>trt1</code>のとき）」の<span class="math inline">\(\hat{y}\)</span>の値と等しい。<br />
傾き<span class="math inline">\(\beta_{t2}\)</span>は「<code>t1</code> = 0, <code>t2</code> = 1（すなわち、<code>trt2</code>のとき）」の<span class="math inline">\(\hat{y}\)</span>の値と等しい。</p>
<p>このように、グループの数が<span class="math inline">\(K\)</span>個ある場合には、ダミー変数を<span class="math inline">\(K-1\)</span>個作れば全てのグループの予測値<span class="math inline">\(\hat{y}\)</span>を線形予測子で表すことができる。</p>
<p><code>lm()</code>で傾き及び切片のパラメータを推定しよう。</p>
<div class="sourceCode" id="cb384"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb384-1"><a href="11-linear_model2.html#cb384-1" tabindex="-1"></a>dat <span class="ot">=</span> dat <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">weight_std =</span> <span class="fu">scale</span>(weight)) <span class="co">#応答変数を標準化したものを用いる</span></span>
<span id="cb384-2"><a href="11-linear_model2.html#cb384-2" tabindex="-1"></a>result <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">data =</span> dat, weight_std <span class="sc">~</span> t1 <span class="sc">+</span> t2 <span class="sc">+</span> <span class="dv">1</span>) </span>
<span id="cb384-3"><a href="11-linear_model2.html#cb384-3" tabindex="-1"></a><span class="fu">summary</span>(result)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = weight_std ~ t1 + t2 + 1, data = dat)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.52740 -0.59613 -0.00856  0.37472  1.95239 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept) -0.05847    0.28113  -0.208   0.8368  
## t1          -0.52910    0.39758  -1.331   0.1944  
## t2           0.70451    0.39758   1.772   0.0877 .
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.889 on 27 degrees of freedom
## Multiple R-squared:  0.2641, Adjusted R-squared:  0.2096 
## F-statistic: 4.846 on 2 and 27 DF,  p-value: 0.01591</code></pre>
<p>式（3）より、切片の推定値は<span class="math inline">\(t_1=0\)</span>かつ<span class="math inline">\(t_2=0\)</span>のときの<span class="math inline">\(\mu\)</span>、つまり統制群(ctrl)のときの応答変数<code>weight_std</code>の推定値を意味している。各ダミー変数の係数（傾き）は、切片に加わる各条件の効果を意味している。例えば、<code>t2</code>の係数は0.7であるが、これは<span class="math inline">\(t_2\)</span>のとき（つまりtrt2のとき）の応答変数の予測値は、 0.65(= 切片 + <code>t2</code>の傾き)となることを示している。</p>
<p>係数の意味することは、基準となるグループ（どのダミー変数も0となるグループ）と比べての効果ということになる。</p>
<p>図でも条件別に<code>weight_std</code>の分布を確認してみよう。分布を見ても同様の傾向があるが、線形モデルの解析の結果その効果が有意であることが確認できた。</p>
<div class="sourceCode" id="cb386"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb386-1"><a href="11-linear_model2.html#cb386-1" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb386-2"><a href="11-linear_model2.html#cb386-2" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">data =</span> dat, <span class="fu">aes</span>(<span class="at">x =</span> group, <span class="at">y =</span> weight_std))</span></code></pre></div>
<p><img src="11-linear_model2_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<p>モデル（式）を確認しながら、係数が何を意味しているのかを常に意識するようにしよう。</p>
<hr />
<p>このテキストでは練習のためにダミー変数を自分でプログラムを書いて作っているが、<code>lm()</code>関数にカテゴリカル変数をそのまま入れても結果を出力してくれる。カテゴリのうちアルファベット順で最初に出てくるカテゴリ(以下の<code>PlantGrowth</code>の例では<code>ctrl</code>)を基準として、残りのダミー変数を自動で作ってくれている。</p>
<div class="sourceCode" id="cb387"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb387-1"><a href="11-linear_model2.html#cb387-1" tabindex="-1"></a>dat <span class="ot">=</span> PlantGrowth <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">weight_std =</span> <span class="fu">scale</span>(weight)) <span class="co">#応答変数を標準化したものを用いる</span></span>
<span id="cb387-2"><a href="11-linear_model2.html#cb387-2" tabindex="-1"></a>result <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">data =</span> dat, weight_std <span class="sc">~</span> group) </span>
<span id="cb387-3"><a href="11-linear_model2.html#cb387-3" tabindex="-1"></a><span class="fu">summary</span>(result)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = weight_std ~ group, data = dat)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.52740 -0.59613 -0.00856  0.37472  1.95239 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept) -0.05847    0.28113  -0.208   0.8368  
## grouptrt1   -0.52910    0.39758  -1.331   0.1944  
## grouptrt2    0.70451    0.39758   1.772   0.0877 .
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.889 on 27 degrees of freedom
## Multiple R-squared:  0.2641, Adjusted R-squared:  0.2096 
## F-statistic: 4.846 on 2 and 27 DF,  p-value: 0.01591</code></pre>
</div>
<div id="chap11_interaction" class="section level2 hasAnchor" number="12.6">
<h2><span class="header-section-number">12.6</span> 交互作用（2要因の分散分析）<a href="11-linear_model2.html#chap11_interaction" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>次は、線形モデルで<strong>交互作用</strong>を扱う方法について確認する。2要因以上の分散分析と同様のことを線形モデルで行う。</p>
<p>以下のプログラムを実行して、サンプルデータ<code>d</code>を作ろう。</p>
<div class="sourceCode" id="cb389"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb389-1"><a href="11-linear_model2.html#cb389-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb389-2"><a href="11-linear_model2.html#cb389-2" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">runif</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">min =</span> <span class="dv">1</span>, <span class="at">max =</span> <span class="dv">10</span>),<span class="dv">0</span>) </span>
<span id="cb389-3"><a href="11-linear_model2.html#cb389-3" tabindex="-1"></a>mu <span class="ot">=</span> <span class="fl">0.1</span> <span class="sc">+</span> <span class="fl">0.4</span> <span class="sc">*</span> x</span>
<span id="cb389-4"><a href="11-linear_model2.html#cb389-4" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">mean =</span> mu, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb389-5"><a href="11-linear_model2.html#cb389-5" tabindex="-1"></a>d_M <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">gender =</span> <span class="st">&quot;M&quot;</span>)</span>
<span id="cb389-6"><a href="11-linear_model2.html#cb389-6" tabindex="-1"></a></span>
<span id="cb389-7"><a href="11-linear_model2.html#cb389-7" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">runif</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">min =</span> <span class="dv">1</span>, <span class="at">max =</span> <span class="dv">10</span>),<span class="dv">0</span>) </span>
<span id="cb389-8"><a href="11-linear_model2.html#cb389-8" tabindex="-1"></a>mu <span class="ot">=</span> <span class="fl">0.3</span> <span class="sc">+</span> <span class="sc">-</span><span class="fl">0.6</span> <span class="sc">*</span> x</span>
<span id="cb389-9"><a href="11-linear_model2.html#cb389-9" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">mean =</span> mu, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb389-10"><a href="11-linear_model2.html#cb389-10" tabindex="-1"></a>d_F <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">gender =</span> <span class="st">&quot;F&quot;</span>)</span>
<span id="cb389-11"><a href="11-linear_model2.html#cb389-11" tabindex="-1"></a></span>
<span id="cb389-12"><a href="11-linear_model2.html#cb389-12" tabindex="-1"></a>d <span class="ot">=</span> <span class="fu">rbind</span>(d_M, d_F)</span>
<span id="cb389-13"><a href="11-linear_model2.html#cb389-13" tabindex="-1"></a></span>
<span id="cb389-14"><a href="11-linear_model2.html#cb389-14" tabindex="-1"></a><span class="fu">head</span>(d)</span></code></pre></div>
<pre><code>##   x        y gender
## 1 3 2.811781      M
## 2 4 2.089843      M
## 3 6 1.878759      M
## 4 9 1.485300      M
## 5 3 2.424931      M
## 6 9 3.655066      M</code></pre>
<p>このデータ<code>d</code>には、<code>x</code>, <code>y</code>, <code>gender</code>の3つの変数が含まれている。<code>gender</code>は性別を意味する変数とする。M（男性）かF（女性）のいずれかである。男女別に、実験で2つの変数を測定したとしよう。</p>
<p>応答変数を<code>y</code>、予測変数を<code>x</code>として線形モデルで切片及び<code>x</code>の傾きのパラメータを推定する。モデルは以下のようになる。</p>
<p><span class="math display">\[
\begin{equation}
  \hat{y} = \alpha + \beta x  \\ \tag{4}
  y \sim \text{Normal}(\hat{y}, \sigma)
\end{equation}
\]</span></p>
<p><code>lm()</code>関数を使って推定しよう（<span class="math inline">\(x\)</span>と<span class="math inline">\(y\)</span>の散布図及び係数の信頼区間も図示する）。</p>
<div class="sourceCode" id="cb391"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb391-1"><a href="11-linear_model2.html#cb391-1" tabindex="-1"></a>result <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">data =</span> d, y <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> x)</span>
<span id="cb391-2"><a href="11-linear_model2.html#cb391-2" tabindex="-1"></a><span class="fu">summary</span>(result)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ 1 + x, data = d)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.8209 -2.5577 -0.7021  2.4363  5.1560 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)   0.7389     1.3472   0.549    0.587
## x            -0.1811     0.2060  -0.879    0.385
## 
## Residual standard error: 3.231 on 38 degrees of freedom
## Multiple R-squared:  0.01993,    Adjusted R-squared:  -0.005863 
## F-statistic: 0.7727 on 1 and 38 DF,  p-value: 0.3849</code></pre>
<div class="sourceCode" id="cb393"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb393-1"><a href="11-linear_model2.html#cb393-1" tabindex="-1"></a>newdat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">10</span>,<span class="fl">0.1</span>))</span>
<span id="cb393-2"><a href="11-linear_model2.html#cb393-2" tabindex="-1"></a>result_conf <span class="ot">=</span> <span class="fu">predict</span>(result, <span class="at">new =</span> newdat, <span class="at">interval =</span> <span class="st">&quot;confidence&quot;</span>, <span class="at">level =</span> <span class="fl">0.95</span>)</span>
<span id="cb393-3"><a href="11-linear_model2.html#cb393-3" tabindex="-1"></a>plot_conf <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">10</span>,<span class="fl">0.1</span>), result_conf)</span>
<span id="cb393-4"><a href="11-linear_model2.html#cb393-4" tabindex="-1"></a></span>
<span id="cb393-5"><a href="11-linear_model2.html#cb393-5" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb393-6"><a href="11-linear_model2.html#cb393-6" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(<span class="at">data =</span> d, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb393-7"><a href="11-linear_model2.html#cb393-7" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_line</span>(<span class="at">data =</span> plot_conf, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> fit)) <span class="sc">+</span> </span>
<span id="cb393-8"><a href="11-linear_model2.html#cb393-8" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_ribbon</span>(<span class="at">data =</span> plot_conf, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">ymax =</span> upr, <span class="at">ymin =</span> lwr), <span class="at">alpha =</span> <span class="fl">0.4</span>) </span></code></pre></div>
<p><img src="11-linear_model2_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<p>予測変数<code>x</code>の傾きはほぼフラットで、<code>y</code>に対してあまり効果がないようにみえる。</p>
<p>しかし、このデータ<code>d</code>にはもう一つ性別を意味する<code>gender</code>という変数が含まれていた。<code>gender</code>を区別して、また<code>x</code>と<code>y</code>の散布図を見てみよう。</p>
<div class="sourceCode" id="cb394"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb394-1"><a href="11-linear_model2.html#cb394-1" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb394-2"><a href="11-linear_model2.html#cb394-2" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(<span class="at">data =</span> d, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">shape =</span> gender, <span class="at">color=</span>gender), <span class="at">size =</span> <span class="dv">3</span>) </span></code></pre></div>
<p><img src="11-linear_model2_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p>性別が女性（F）か男性（M）かで、<code>x</code>と<code>y</code>の関係が違うようである。<br />
このように、別の変数との組み合わせにより、変数間の関係が変化することを<strong>交互作用(interaction)</strong>という。このデータでも、応答変数<code>y</code>に対して性別<code>gender</code>と<code>x</code>の交互作用がありそうである。</p>
<p>交互作用のあるモデルは、以下のように表現する。</p>
<p><span class="math display">\[
\begin{equation}
  \hat{y} = \alpha + \beta_{1} x + \beta_{2} M + \beta_{3} xM  \\ \tag{5}
  y \sim \text{Normal}(\hat{y}, \sigma)
\end{equation}
\]</span></p>
<p><span class="math inline">\(M\)</span>は性別<code>gender</code>のダミー変数で、<code>M</code>（男性）ならば1、<code>F</code>（女性）ならば0の変数とする。<br />
線形モデルでは、<strong>交互作用は予測変数同士の積</strong>で扱う。男性（M=1）の場合の<span class="math inline">\(\mu\)</span>の推定値は、<span class="math inline">\(\mu = \alpha +(\beta_{1} + \beta_{3}) x +\beta_{2}\)</span>となる。一方、女性（M=0）の場合は、<span class="math inline">\(mu = \alpha +\beta_{1} x\)</span>となる。<span class="math inline">\(\beta_{3}\)</span>は、男性のときの<span class="math inline">\(x\)</span>に係る傾きの変化量を意味することになる。このように、交互作用を考慮する予測変数の積をモデルに加えることで、男性か女性かで切片及び傾きが変化することを表現できる。</p>
<div class="sourceCode" id="cb395"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb395-1"><a href="11-linear_model2.html#cb395-1" tabindex="-1"></a>d<span class="sc">$</span>M <span class="ot">=</span> <span class="fu">ifelse</span>(d<span class="sc">$</span>gender <span class="sc">==</span> <span class="st">&quot;M&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>) <span class="co">#genderがMならば1, Fならば1のダミー変数を作る</span></span>
<span id="cb395-2"><a href="11-linear_model2.html#cb395-2" tabindex="-1"></a>result <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">data =</span> d, y <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> x<span class="sc">*</span>M)</span>
<span id="cb395-3"><a href="11-linear_model2.html#cb395-3" tabindex="-1"></a><span class="fu">summary</span>(result)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ 1 + x * M, data = d)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -2.3555 -0.6534  0.2205  0.5636  1.6618 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  0.05079    0.53625   0.095    0.925    
## x           -0.53691    0.08107  -6.622 1.03e-07 ***
## M            1.04827    0.73745   1.421    0.164    
## x:M          0.77868    0.11274   6.907 4.35e-08 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.8827 on 36 degrees of freedom
## Multiple R-squared:  0.9307, Adjusted R-squared:  0.9249 
## F-statistic: 161.1 on 3 and 36 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>2つの予測変数の積の傾き（<span class="math inline">\(\beta_{3}\)</span>）は、<code>x:M</code>である。p値も小さく、有意な効果を持っているようである。</p>
<p>サンプルデータについて、推定されたパラメータを元に、男女別に線形モデルの直線の信頼区間を図示したのが以下の図である。</p>
<div class="sourceCode" id="cb397"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb397-1"><a href="11-linear_model2.html#cb397-1" tabindex="-1"></a>new_x <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">10</span>,<span class="fl">0.1</span>)</span>
<span id="cb397-2"><a href="11-linear_model2.html#cb397-2" tabindex="-1"></a>newdat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">rep</span>(new_x,<span class="dv">2</span>), <span class="at">M =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>,<span class="fu">length</span>(new_x)), <span class="fu">rep</span>(<span class="dv">1</span>,<span class="fu">length</span>(new_x))))</span>
<span id="cb397-3"><a href="11-linear_model2.html#cb397-3" tabindex="-1"></a>result_conf <span class="ot">=</span> <span class="fu">predict</span>(result, <span class="at">new =</span> newdat, <span class="at">interval =</span> <span class="st">&quot;confidence&quot;</span>, <span class="at">level =</span> <span class="fl">0.95</span>)</span>
<span id="cb397-4"><a href="11-linear_model2.html#cb397-4" tabindex="-1"></a>plot_conf <span class="ot">=</span> <span class="fu">data.frame</span>(newdat, result_conf)</span>
<span id="cb397-5"><a href="11-linear_model2.html#cb397-5" tabindex="-1"></a>plot_conf<span class="sc">$</span>gender <span class="ot">=</span> <span class="fu">ifelse</span>(plot_conf<span class="sc">$</span>M <span class="sc">==</span> <span class="dv">1</span>, <span class="st">&quot;M&quot;</span>, <span class="st">&quot;F&quot;</span>)</span>
<span id="cb397-6"><a href="11-linear_model2.html#cb397-6" tabindex="-1"></a></span>
<span id="cb397-7"><a href="11-linear_model2.html#cb397-7" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb397-8"><a href="11-linear_model2.html#cb397-8" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(<span class="at">data =</span> d, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">shape =</span> gender, <span class="at">color=</span>gender), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb397-9"><a href="11-linear_model2.html#cb397-9" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_line</span>(<span class="at">data =</span> plot_conf, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> fit, <span class="at">color=</span>gender)) <span class="sc">+</span> </span>
<span id="cb397-10"><a href="11-linear_model2.html#cb397-10" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_ribbon</span>(<span class="at">data =</span> plot_conf, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">ymax =</span> upr, <span class="at">ymin =</span> lwr, <span class="at">color =</span>gender), <span class="at">alpha =</span> <span class="fl">0.4</span>) </span></code></pre></div>
<p><img src="11-linear_model2_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<div id="chap11_NotingInteraction" class="section level3 hasAnchor" number="12.6.1">
<h3><span class="header-section-number">12.6.1</span> 交互作用を扱うモデルの解釈<a href="11-linear_model2.html#chap11_NotingInteraction" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>2要因以上の分散分析と同様に、線形モデルでも交互作用の有無を検討することができる。しかし、ここで注意が必要なのは、交互作用を含む線形モデルは解釈が複雑になることである。
　　
分散分析では、変数の組み合わせの効果である交互作用とは別に、その変数そのものの効果である主効果についての検定も行われる。では、上述の線形モデルの<span class="math inline">\(\beta_{1}\)</span>及び<span class="math inline">\(\beta_{2}\)</span>のパラメータはそれぞれ、性別<span class="math inline">\(M\)</span>及び予測変数<span class="math inline">\(x\)</span>の主効果として解釈できるのだろうか？</p>
<p>例えば<span class="math inline">\(\beta_{1}\)</span>について見てみよう。先述のように、男性（M=1）の場合の<span class="math inline">\(y\)</span>の推定値は<span class="math inline">\(\hat{y} = \alpha +(\beta_{1} + \beta_{3}) x +\beta_{2}\)</span>、女性（M=0）の場合は<span class="math inline">\(\hat{y} = \alpha +\beta_{1} x\)</span>となる。すなわち、<span class="math inline">\(\beta_{1}\)</span>は「女性のときのxの傾き」を意味し、性別が無関係なxの効果を必ずしも意味しない。</p>
<p>このように、交互作用を含むモデルの場合、<strong>予測変数の傾きは必ずしも主効果を意味するわけではない</strong>。次の節の補足で、この問題に対する対処法について説明する。</p>
</div>
</div>
<div id="chap11_ANCOVA" class="section level2 hasAnchor" number="12.7">
<h2><span class="header-section-number">12.7</span> 予測変数が複数ある場合（共分散分析または重回帰分析）<a href="11-linear_model2.html#chap11_ANCOVA" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>予測変数は連続量もカテゴリカル変数でも何でも含めても良い。</p>
<div id="chap11_Controlling" class="section level3 hasAnchor" number="12.7.1">
<h3><span class="header-section-number">12.7.1</span> 変数の効果の統制<a href="11-linear_model2.html#chap11_Controlling" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>予測変数を複数加えた線形モデルの解析のメリットは、ある予測変数について他の予測変数の効果を<strong>統制(control)</strong>したときの効果を検討できることにある。</p>
<p>Rで標準で入っている<code>attitude</code>データを使って、予測変数が複数ある場合の線形モデルの解析の結果を確認してみよう。</p>
<div class="sourceCode" id="cb398"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb398-1"><a href="11-linear_model2.html#cb398-1" tabindex="-1"></a><span class="fu">head</span>(attitude)</span></code></pre></div>
<pre><code>##   rating complaints privileges learning raises critical advance
## 1     43         51         30       39     61       92      45
## 2     63         64         51       54     63       73      47
## 3     71         70         68       69     76       86      48
## 4     61         63         45       47     54       84      35
## 5     81         78         56       66     71       83      47
## 6     43         55         49       44     54       49      34</code></pre>
<p>以下のように、<code>complaints</code>, <code>privileges</code>, <code>learning</code>, <code>raises</code>の4つを予測変数として、<code>rating</code>の値の推定を行ってみよう。</p>
<div class="sourceCode" id="cb400"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb400-1"><a href="11-linear_model2.html#cb400-1" tabindex="-1"></a>dat <span class="ot">=</span> attitude <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">rating_std =</span> <span class="fu">scale</span>(rating),</span>
<span id="cb400-2"><a href="11-linear_model2.html#cb400-2" tabindex="-1"></a>                                <span class="at">complaints_std =</span> <span class="fu">scale</span>(complaints),</span>
<span id="cb400-3"><a href="11-linear_model2.html#cb400-3" tabindex="-1"></a>                                <span class="at">privileges_std =</span> <span class="fu">scale</span>(privileges),</span>
<span id="cb400-4"><a href="11-linear_model2.html#cb400-4" tabindex="-1"></a>                                <span class="at">learning_std =</span> <span class="fu">scale</span>(learning),</span>
<span id="cb400-5"><a href="11-linear_model2.html#cb400-5" tabindex="-1"></a>                                <span class="at">raises_std =</span> <span class="fu">scale</span>(raises)</span>
<span id="cb400-6"><a href="11-linear_model2.html#cb400-6" tabindex="-1"></a>                                ) <span class="co">#変数を標準化したものを使う</span></span>
<span id="cb400-7"><a href="11-linear_model2.html#cb400-7" tabindex="-1"></a></span>
<span id="cb400-8"><a href="11-linear_model2.html#cb400-8" tabindex="-1"></a>result <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">data =</span> dat, rating_std <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> complaints_std <span class="sc">+</span> privileges_std <span class="sc">+</span> learning_std <span class="sc">+</span> raises_std)</span>
<span id="cb400-9"><a href="11-linear_model2.html#cb400-9" tabindex="-1"></a><span class="fu">summary</span>(result)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = rating_std ~ 1 + complaints_std + privileges_std + 
##     learning_std + raises_std, data = dat)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -0.9255 -0.4433  0.0492  0.4765  0.9231 
## 
## Coefficients:
##                  Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)    -1.056e-15  1.049e-01   0.000    1.000    
## complaints_std  7.560e-01  1.593e-01   4.745 7.21e-05 ***
## privileges_std -1.034e-01  1.326e-01  -0.780    0.443    
## learning_std    2.375e-01  1.488e-01   1.596    0.123    
## raises_std     -2.179e-02  1.571e-01  -0.139    0.891    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.5748 on 25 degrees of freedom
## Multiple R-squared:  0.7152, Adjusted R-squared:  0.6697 
## F-statistic:  15.7 on 4 and 25 DF,  p-value: 1.509e-06</code></pre>
<p>切片（Intercept）は全ての予測変数の値がゼロ（ここでは標準化しているので平均）のときの応答変数の予測値であり、各予測変数の係数は予測変数が1単位（1標準偏差）増えた場合の応答変数の変化量を意味している。例えば、<code>complaints_std</code>の係数は0.76であるが、これは「<code>complaints</code>が1増えると<code>rating</code>は0.76増える傾向にある」ことを意味している。</p>
<p>各係数の値は「他の変数の値がゼロであるときの効果」を意味している。先程の<code>complaints</code>の係数0.76は、その他の予測変数<code>privileges</code>, <code>learning</code>, <code>raises</code>がゼロのときの、<code>complaints</code>が<code>rating</code>に与えるそのものの効果を示している。</p>
<p>このように複数の予測変数を入れたモデルで推定される係数は、他の予測変数の効果を統制した上での予測変数が応答変数に及ぼす効果を意味する。</p>
<hr />
<p>交互作用を含むモデルの場合も、（ダミー変数も含めて）予測変数を標準化すると係数を解釈しやすくなる。</p>
<div class="sourceCode" id="cb402"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb402-1"><a href="11-linear_model2.html#cb402-1" tabindex="-1"></a><span class="co">#データを再度作成する。</span></span>
<span id="cb402-2"><a href="11-linear_model2.html#cb402-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb402-3"><a href="11-linear_model2.html#cb402-3" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">runif</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">min =</span> <span class="dv">1</span>, <span class="at">max =</span> <span class="dv">10</span>),<span class="dv">0</span>) </span>
<span id="cb402-4"><a href="11-linear_model2.html#cb402-4" tabindex="-1"></a>mu <span class="ot">=</span> <span class="fl">0.1</span> <span class="sc">+</span> <span class="fl">0.4</span> <span class="sc">*</span> x</span>
<span id="cb402-5"><a href="11-linear_model2.html#cb402-5" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">mean =</span> mu, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb402-6"><a href="11-linear_model2.html#cb402-6" tabindex="-1"></a>d_M <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">gender =</span> <span class="st">&quot;M&quot;</span>)</span>
<span id="cb402-7"><a href="11-linear_model2.html#cb402-7" tabindex="-1"></a></span>
<span id="cb402-8"><a href="11-linear_model2.html#cb402-8" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">runif</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">min =</span> <span class="dv">1</span>, <span class="at">max =</span> <span class="dv">10</span>),<span class="dv">0</span>) </span>
<span id="cb402-9"><a href="11-linear_model2.html#cb402-9" tabindex="-1"></a>mu <span class="ot">=</span> <span class="fl">0.3</span> <span class="sc">+</span> <span class="sc">-</span><span class="fl">0.6</span> <span class="sc">*</span> x</span>
<span id="cb402-10"><a href="11-linear_model2.html#cb402-10" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">mean =</span> mu, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb402-11"><a href="11-linear_model2.html#cb402-11" tabindex="-1"></a>d_F <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">gender =</span> <span class="st">&quot;F&quot;</span>)</span>
<span id="cb402-12"><a href="11-linear_model2.html#cb402-12" tabindex="-1"></a></span>
<span id="cb402-13"><a href="11-linear_model2.html#cb402-13" tabindex="-1"></a>d <span class="ot">=</span> <span class="fu">rbind</span>(d_M, d_F)</span>
<span id="cb402-14"><a href="11-linear_model2.html#cb402-14" tabindex="-1"></a>d<span class="sc">$</span>M <span class="ot">=</span> <span class="fu">ifelse</span>(d<span class="sc">$</span>gender <span class="sc">==</span> <span class="st">&quot;M&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>) <span class="co">#genderがMならば1, Fならば1のダミー変数を作る</span></span></code></pre></div>
<div class="sourceCode" id="cb403"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb403-1"><a href="11-linear_model2.html#cb403-1" tabindex="-1"></a><span class="co">#標準化する前の結果</span></span>
<span id="cb403-2"><a href="11-linear_model2.html#cb403-2" tabindex="-1"></a>result <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">data =</span> d, y <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> x<span class="sc">*</span>M)</span>
<span id="cb403-3"><a href="11-linear_model2.html#cb403-3" tabindex="-1"></a><span class="fu">summary</span>(result)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ 1 + x * M, data = d)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -2.3555 -0.6534  0.2205  0.5636  1.6618 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  0.05079    0.53625   0.095    0.925    
## x           -0.53691    0.08107  -6.622 1.03e-07 ***
## M            1.04827    0.73745   1.421    0.164    
## x:M          0.77868    0.11274   6.907 4.35e-08 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.8827 on 36 degrees of freedom
## Multiple R-squared:  0.9307, Adjusted R-squared:  0.9249 
## F-statistic: 161.1 on 3 and 36 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>応答変数と予測変数を標準化する。ダミー変数も標準化する。</p>
<div class="sourceCode" id="cb405"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb405-1"><a href="11-linear_model2.html#cb405-1" tabindex="-1"></a><span class="co">#変数を標準化</span></span>
<span id="cb405-2"><a href="11-linear_model2.html#cb405-2" tabindex="-1"></a>d <span class="ot">=</span> d <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">y_std =</span> <span class="fu">scale</span>(y),</span>
<span id="cb405-3"><a href="11-linear_model2.html#cb405-3" tabindex="-1"></a>                       <span class="at">x_std =</span> <span class="fu">scale</span>(x),</span>
<span id="cb405-4"><a href="11-linear_model2.html#cb405-4" tabindex="-1"></a>                       <span class="at">M_std =</span> <span class="fu">scale</span>(M)</span>
<span id="cb405-5"><a href="11-linear_model2.html#cb405-5" tabindex="-1"></a>                       )</span>
<span id="cb405-6"><a href="11-linear_model2.html#cb405-6" tabindex="-1"></a><span class="fu">head</span>(d)</span></code></pre></div>
<pre><code>##   x        y gender M     y_std       x_std     M_std
## 1 3 2.811781      M 1 0.9835716 -1.21465482 0.9874209
## 2 4 2.089843      M 1 0.7594727 -0.81640734 0.9874209
## 3 6 1.878759      M 1 0.6939495 -0.01991237 0.9874209
## 4 9 1.485300      M 1 0.5718146  1.17483007 0.9874209
## 5 3 2.424931      M 1 0.8634883 -1.21465482 0.9874209
## 6 9 3.655066      M 1 1.2453383  1.17483007 0.9874209</code></pre>
<div class="sourceCode" id="cb407"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb407-1"><a href="11-linear_model2.html#cb407-1" tabindex="-1"></a>result <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">data =</span> d, y_std <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> x_std<span class="sc">*</span>M_std)</span>
<span id="cb407-2"><a href="11-linear_model2.html#cb407-2" tabindex="-1"></a><span class="fu">summary</span>(result)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y_std ~ 1 + x_std * M_std, data = d)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.73117 -0.20282  0.06843  0.17496  0.51584 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  0.01209    0.04336   0.279   0.7821    
## x_std       -0.11502    0.04394  -2.618   0.0129 *  
## M_std        0.90526    0.04391  20.615  &lt; 2e-16 ***
## x_std:M_std  0.30734    0.04450   6.907 4.35e-08 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.274 on 36 degrees of freedom
## Multiple R-squared:  0.9307, Adjusted R-squared:  0.9249 
## F-statistic: 161.1 on 3 and 36 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>それぞれの係数とp値が変わった。それぞれの係数の値は、他の変数がゼロのときの応答変数の増減分を意味する、すなわち他の全ての変数が平均（=0）であるときの、その変数そのものの効果（平均的効果）を意味することになる。</p>
<p>変数を標準化する前のモデルでは、パラメータ<span class="math inline">\(\beta_{1}\)</span>は「女性のときの<code>x</code>の傾き」であり、予測変数<code>x</code>そのものの効果を意味するものではなかった。<br />
これに対し、標準化した後のモデルでは<code>x_std</code>の傾きを「変数<code>x</code>の平均的効果」として捉えることができる。<code>x_std</code>の傾きが意味することは、「他の変数がゼロのとき、つまり平均であるときに、<code>x_std</code>が1単位（1標準偏差）変化したときの応答変数の変化量」を意味することになり、係数の値をそのまま用いて直感的に解釈することができる。<br />
交互作用項の係数も、一方の変数の効果が一定の場合（0のとき）、<code>M</code>または<code>x</code>に追加分で係る効果として理解することができる。</p>
</div>
</div>
<div id="chap11_Summary" class="section level2 hasAnchor" number="12.8">
<h2><span class="header-section-number">12.8</span> まとめ<a href="11-linear_model2.html#chap11_Summary" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>この章では、予測変数がカテゴリカル変数の場合及び交互作用を含むモデルの場合を学んできた。</p>
<ul>
<li>予測変数がカテゴリカル変数の場合は、0か1の値を取るダミー変数にして線形予測子に投入する。<br />
</li>
<li>3つ以上のカテゴリの場合は、カテゴリの数-1個分のダミー変数を線形予測子に投入する。<br />
</li>
<li>2つの予測変数の組み合わせの効果（交互作用）を見たい場合は、2つの予測変数の積を線形予測子に投入する。<br />
</li>
<li>予測変数を複数加えたときの各予測変数の傾きは、他の予測変数がゼロのときのその予測変数が応答変数に及ぼす効果を意味する。</li>
</ul>
<p>線形予測子を拡張することで、正規分布を扱う様々な統計解析を線形モデルを扱う関数(<code>lm</code>)のみで行うことができることを学んできた。</p>
<p>この章では、応答変数は正規分布に従うという前提をおいてきたが、応答変数が従う確率分布を正規分布以外にすることも可能である。以降の章では、応答変数が従う確率分布を変更して一般化した「一般化線形モデル」を扱っていく。</p>
</div>
<div id="chap11_Practice" class="section level2 hasAnchor" number="12.9">
<h2><span class="header-section-number">12.9</span> 確認問題<a href="11-linear_model2.html#chap11_Practice" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="問1" class="section level3 unnumbered hasAnchor">
<h3>問1<a href="#%E5%95%8F1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Rで標準で入っているデータ<code>warpbreaks</code>を使って練習をする。</p>
<div class="sourceCode" id="cb409"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb409-1"><a href="11-linear_model2.html#cb409-1" tabindex="-1"></a>prac_dat_1 <span class="ot">=</span> warpbreaks <span class="co">#別の名前で保存する</span></span>
<span id="cb409-2"><a href="11-linear_model2.html#cb409-2" tabindex="-1"></a></span>
<span id="cb409-3"><a href="11-linear_model2.html#cb409-3" tabindex="-1"></a><span class="fu">head</span>(prac_dat_1)</span></code></pre></div>
<pre><code>##   breaks wool tension
## 1     26    A       L
## 2     30    A       L
## 3     54    A       L
## 4     25    A       L
## 5     70    A       L
## 6     52    A       L</code></pre>
<div class="sourceCode" id="cb411"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb411-1"><a href="11-linear_model2.html#cb411-1" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb411-2"><a href="11-linear_model2.html#cb411-2" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_boxplot</span>(<span class="at">data =</span> prac_dat_1, <span class="fu">aes</span>(<span class="at">x =</span> wool, <span class="at">y =</span> breaks))</span></code></pre></div>
<p><img src="11-linear_model2_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<div class="sourceCode" id="cb412"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb412-1"><a href="11-linear_model2.html#cb412-1" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb412-2"><a href="11-linear_model2.html#cb412-2" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_boxplot</span>(<span class="at">data =</span> prac_dat_1, <span class="fu">aes</span>(<span class="at">x =</span> tension, <span class="at">y =</span> breaks))</span></code></pre></div>
<p><img src="11-linear_model2_files/figure-html/unnamed-chunk-26-2.png" width="672" /></p>
<div id="section" class="section level4 unnumbered hasAnchor">
<h4>1-1<a href="11-linear_model2.html#section" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>変数<code>wool</code>について, 「<code>A</code>を1, それ以外を0」としたダミー変数を作成し、そのダミー変数を予測変数、<code>breaks</code>を応答変数として線形モデルを行い、切片及びダミー変数に係る傾きの推定値を報告せよ。</p>
<p>また、ダミー変数の傾きの推定値からどのような結論が導かれるかを述べよ。</p>
</div>
<div id="section-1" class="section level4 unnumbered hasAnchor">
<h4>1-2<a href="11-linear_model2.html#section-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>変数<code>tension</code>について, 「<code>L</code>を1, それ以外を0」、「<code>M</code>を1, それ以外を0」とした2種類のダミー変数を作成し、それら2つのダミー変数を予測変数、<code>breaks</code>を応答変数として線形モデルを行い、切片及び各ダミー変数に係る傾きの推定値を報告せよ。<br />
更に、そのときの切片及び各ダミー変数の係数が意味することを説明せよ。</p>
</div>
<div id="section-2" class="section level4 unnumbered hasAnchor">
<h4>1-3<a href="11-linear_model2.html#section-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>1-2で作ったダミー変数に加え、更に「<code>H</code>を1, それ以外を0」としたダミー変数を追加で作成する。<br />
更に、<code>breaks</code>から全体の<code>breaks</code>の平均を引いた変数<code>breaks_2</code>を作成する。</p>
<p>それら3つのダミー変数を予測変数、<code>breaks_2</code>を応答変数として線形モデルを行い、各ダミー変数に係る傾きの推定値を報告せよ。ただし、モデルには切片の項は加えないものとする。</p>
<p>更に、そのときの各ダミー変数の係数が意味することを説明せよ。</p>
</div>
</div>
<div id="問2" class="section level3 unnumbered hasAnchor">
<h3>問2<a href="#%E5%95%8F2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>問1に引き続き、Rで標準で入っているデータ<code>warpbreaks</code>を使って練習をする。ただし、<code>tension</code>が<code>H</code>の部分を除いたデータを用いる。</p>
<div class="sourceCode" id="cb413"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb413-1"><a href="11-linear_model2.html#cb413-1" tabindex="-1"></a>prac_dat_2 <span class="ot">=</span> <span class="fu">subset</span>(warpbreaks, tension <span class="sc">!=</span> <span class="st">&quot;H&quot;</span>) <span class="co">#tension == Hは除き、別の名前で保存する</span></span>
<span id="cb413-2"><a href="11-linear_model2.html#cb413-2" tabindex="-1"></a></span>
<span id="cb413-3"><a href="11-linear_model2.html#cb413-3" tabindex="-1"></a><span class="fu">head</span>(prac_dat_2)</span></code></pre></div>
<pre><code>##   breaks wool tension
## 1     26    A       L
## 2     30    A       L
## 3     54    A       L
## 4     25    A       L
## 5     70    A       L
## 6     52    A       L</code></pre>
<div class="sourceCode" id="cb415"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb415-1"><a href="11-linear_model2.html#cb415-1" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb415-2"><a href="11-linear_model2.html#cb415-2" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_boxplot</span>(<span class="at">data =</span> prac_dat_2, <span class="fu">aes</span>(<span class="at">x =</span> wool, <span class="at">y =</span> breaks, <span class="at">fill =</span> tension))</span></code></pre></div>
<p><img src="11-linear_model2_files/figure-html/unnamed-chunk-31-1.png" width="672" /></p>
<p>breaksを応答変数、wool, tension, wool及びtensionの交互作用項を予測変数とした線形モデルを行い、切片、woolの傾き、tensionの傾き、交互作用項の推定値を報告せよ。</p>
</div>
</div>
<div id="chap11_emmeans" class="section level2 hasAnchor" number="12.10">
<h2><span class="header-section-number">12.10</span> 補足(emmeans)<a href="11-linear_model2.html#chap11_emmeans" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>この章では、ダミー変数を複数加えたモデル及び交互作用を加えたモデルで一要因の分散分析や二要因の分散分析と同様のことができることを学んできた。ただし、分散分析では条件の効果が有意だった場合には、どの条件間で差があるかを多重比較補正をした上で比較するプロセスが必要となる。</p>
<p>ここでは、<code>emmeans</code>パッケージを用いて<code>lm()</code>関数で多重比較補正を行う手順を紹介する（詳細は<code>emmeans</code>パッケージのヘルプを参照のこと）。</p>
<div class="sourceCode" id="cb416"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb416-1"><a href="11-linear_model2.html#cb416-1" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span></code></pre></div>
<div id="chap11_emmeans1" class="section level3 hasAnchor" number="12.10.1">
<h3><span class="header-section-number">12.10.1</span> 一要因の分散分析における多重比較<a href="11-linear_model2.html#chap11_emmeans1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb417"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb417-1"><a href="11-linear_model2.html#cb417-1" tabindex="-1"></a>dat <span class="ot">=</span> PlantGrowth <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">weight_std =</span> <span class="fu">scale</span>(weight))</span>
<span id="cb417-2"><a href="11-linear_model2.html#cb417-2" tabindex="-1"></a>result <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">data =</span> dat, weight_std <span class="sc">~</span> group) </span>
<span id="cb417-3"><a href="11-linear_model2.html#cb417-3" tabindex="-1"></a></span>
<span id="cb417-4"><a href="11-linear_model2.html#cb417-4" tabindex="-1"></a>emm <span class="ot">=</span> emmeans<span class="sc">::</span><span class="fu">emmeans</span>(result, <span class="sc">~</span> group) <span class="co">#モデルから推定された各カテゴリのmarginal mean(emmeans)を算出する</span></span>
<span id="cb417-5"><a href="11-linear_model2.html#cb417-5" tabindex="-1"></a>emm</span></code></pre></div>
<pre><code>##  group  emmean    SE df lower.CL upper.CL
##  ctrl  -0.0585 0.281 27  -0.6353   0.5184
##  trt1  -0.5876 0.281 27  -1.1644  -0.0107
##  trt2   0.6460 0.281 27   0.0692   1.2229
## 
## Confidence level used: 0.95</code></pre>
<div class="sourceCode" id="cb419"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb419-1"><a href="11-linear_model2.html#cb419-1" tabindex="-1"></a>emmeans<span class="sc">::</span><span class="fu">contrast</span>(emm, <span class="at">method =</span> <span class="st">&quot;pairwise&quot;</span>, <span class="at">adjust =</span> <span class="st">&quot;tukey&quot;</span>)    <span class="co">#pairwiseで条件の組み合わせごとのemmeansの比較の結果が表示される。adjustで多重比較補正の方法を指定できる。</span></span></code></pre></div>
<pre><code>##  contrast    estimate    SE df t.ratio p.value
##  ctrl - trt1    0.529 0.398 27   1.331  0.3909
##  ctrl - trt2   -0.705 0.398 27  -1.772  0.1980
##  trt1 - trt2   -1.234 0.398 27  -3.103  0.0120
## 
## P value adjustment: tukey method for comparing a family of 3 estimates</code></pre>
</div>
<div id="chap11_emmeans2" class="section level3 hasAnchor" number="12.10.2">
<h3><span class="header-section-number">12.10.2</span> 二要因の分散分析における単純主効果検定<a href="11-linear_model2.html#chap11_emmeans2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb421"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb421-1"><a href="11-linear_model2.html#cb421-1" tabindex="-1"></a>dat <span class="ot">=</span> warpbreaks <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">breaks_std =</span> <span class="fu">scale</span>(breaks))</span>
<span id="cb421-2"><a href="11-linear_model2.html#cb421-2" tabindex="-1"></a>result <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">data =</span> dat, breaks_std <span class="sc">~</span> wool <span class="sc">*</span> tension)</span>
<span id="cb421-3"><a href="11-linear_model2.html#cb421-3" tabindex="-1"></a></span>
<span id="cb421-4"><a href="11-linear_model2.html#cb421-4" tabindex="-1"></a>emm <span class="ot">=</span> emmeans<span class="sc">::</span><span class="fu">emmeans</span>(result, <span class="sc">~</span> wool <span class="sc">*</span> tension)</span>
<span id="cb421-5"><a href="11-linear_model2.html#cb421-5" tabindex="-1"></a>emm</span></code></pre></div>
<pre><code>##  wool tension   emmean    SE df lower.CL upper.CL
##  A    L        1.24311 0.276 48    0.688    1.799
##  B    L        0.00561 0.276 48   -0.550    0.561
##  A    M       -0.31429 0.276 48   -0.870    0.241
##  B    M        0.04770 0.276 48   -0.508    0.603
##  A    H       -0.27219 0.276 48   -0.828    0.283
##  B    H       -0.70995 0.276 48   -1.265   -0.154
## 
## Confidence level used: 0.95</code></pre>
<div class="sourceCode" id="cb423"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb423-1"><a href="11-linear_model2.html#cb423-1" tabindex="-1"></a><span class="fu">pairs</span>(emm, <span class="at">simple =</span> <span class="st">&quot;wool&quot;</span>)    <span class="co">#wool内でtension間の比較を行う</span></span></code></pre></div>
<pre><code>## tension = L:
##  contrast estimate    SE df t.ratio p.value
##  A - B       1.238 0.391 48   3.167  0.0027
## 
## tension = M:
##  contrast estimate    SE df t.ratio p.value
##  A - B      -0.362 0.391 48  -0.926  0.3589
## 
## tension = H:
##  contrast estimate    SE df t.ratio p.value
##  A - B       0.438 0.391 48   1.120  0.2682</code></pre>
<div class="sourceCode" id="cb425"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb425-1"><a href="11-linear_model2.html#cb425-1" tabindex="-1"></a><span class="fu">pairs</span>(emm, <span class="at">simple =</span> <span class="st">&quot;tension&quot;</span>)     <span class="co">#tension内でwool間の比較を行う</span></span></code></pre></div>
<pre><code>## wool = A:
##  contrast estimate    SE df t.ratio p.value
##  L - M      1.5574 0.391 48   3.986  0.0007
##  L - H      1.5153 0.391 48   3.878  0.0009
##  M - H     -0.0421 0.391 48  -0.108  0.9936
## 
## wool = B:
##  contrast estimate    SE df t.ratio p.value
##  L - M     -0.0421 0.391 48  -0.108  0.9936
##  L - H      0.7156 0.391 48   1.831  0.1704
##  M - H      0.7577 0.391 48   1.939  0.1389
## 
## P value adjustment: tukey method for comparing a family of 3 estimates</code></pre>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="10-linear_model.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="12-glm_logistic.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": null,
    "text": null
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": null,
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
